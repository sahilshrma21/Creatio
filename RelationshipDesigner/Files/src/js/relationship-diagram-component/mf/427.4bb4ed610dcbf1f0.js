(self.webpackChunkapp_studio_enterprise_relationship_diagram=self.webpackChunkapp_studio_enterprise_relationship_diagram||[]).push([[427],{427:(Qt,R,f)=>{f.r(R),f.d(R,{AnnotationTools:()=>d.AQ,AssociationTools:()=>d.Gc,BaseCreateShape:()=>d.ir,BaseElementMove:()=>d.R1,BaseElementUpdateHandlers:()=>d.Zq,BaseProcessElementTools:()=>d.uw,BaseUpdateConnectionType:()=>d.fs,BoundaryEventElementMove:()=>d.S5,CanElementMoveFactory:()=>d.De,ChangeConnectionDirectionHandler:()=>d.HX,CommonProcessDiagramService:()=>d.JN,ConnectionUpdateHandler:()=>d.ZD,ContainerElementMove:()=>d.hz,CreateBoundaryShape:()=>d.Xg,CreateIntermediateThrowEventSignal:()=>d.EN,CreateShapeWithCaption:()=>d.PB,DeleteLane:()=>d.qK,DiagramAnnotationOutline:()=>d.Jy,DiagramDeleteShapeHandler:()=>d.ti,DiagramEventOutline:()=>d.Br,DiagramGatewayOutline:()=>d.cb,DiagramMoveShapeHandler:()=>d.pd,DiagramOrderingProvider:()=>d.Jv,DiagramReconnectConnectionHandler:()=>d.N9,DiagramResizeShapeHandler:()=>d.W_,DiagramSnapping:()=>d.bG,DiagramTaskOutline:()=>d.xO,DrawAssociation:()=>d.nL,DrawAssociationOneWay:()=>d.D9,DrawAssociationTwoWay:()=>d.Tj,DrawConditionalConnection:()=>d.j0,DrawDefaultConnection:()=>d.V4,ElementConvertedFromContainer:()=>d.hu,ElementSizeUtils:()=>d.j5,ElementUpdateHandler:()=>d.BQ,EventSubProcessExpandedElementMove:()=>d.uc,EventSubProcessTools:()=>d.Yx,IntermediateElementMove:()=>d.JR,LabelMove:()=>d.C$,LaneCreateHandler:()=>d.DS,LaneElementMove:()=>d.oj,LaneResizeHandler:()=>d.vd,LaneSetElementMove:()=>d.k$,LaneSetTools:()=>d.YB,LaneSplitHandler:()=>d.O6,LaneTools:()=>d.Nf,ProcessConnectionClasses:()=>d.LK,ProcessConnectionProperties:()=>d.GU,ProcessDiagramComponent:()=>d.ae,ProcessDiagramCopyPaste:()=>d.$O,ProcessDiagramCreateElementsHandler:()=>d.lG,ProcessDiagramCreateShapeHandler:()=>d.Sz,ProcessDiagramFeatures:()=>d.IT,ProcessDiagramLabelEdit:()=>d.Gj,ProcessDiagramLoader:()=>d.xF,ProcessDiagramMarkers:()=>d.$1,ProcessDiagramModeling:()=>d.aT,ProcessDiagramModule:()=>d.dx,ProcessDiagramMoveElementsHandler:()=>d.zV,ProcessDiagramRenderer:()=>d.mA,ProcessDiagramRules:()=>d.D$,ProcessDiagramTextUtils:()=>d.nk,ProcessDirectEditing:()=>d.Uy,ProcessDrawConnection:()=>d.Ow,ProcessElementTools:()=>d.e5,ProcessElementToolsConfig:()=>d.BL,ProcessElementToolsFactory:()=>d.Ty,ProcessLayouter:()=>d._l,ProcessOutlineFactory:()=>d._Q,ProcessPaletteProvider:()=>d.pS,ProcessRenderingAnnotation:()=>d.jK,ProcessRenderingLane:()=>d.qJ,ProcessRenderingLaneSet:()=>d.ic,ProcessRenderingShape:()=>d.kD,ProcessRenderingShapeFactory:()=>d.kT,ProcessRenderingSubProcessExpanded:()=>d.bD,ProcessReplaceMenuProvider:()=>d.kV,ProcessSplitConnectionHelper:()=>d.a4,ProcessUpdateLabelHandler:()=>d.hT,ProcessValidationElementOutline:()=>d.tG,ProcessValidationOutlineFactory:()=>d.mk,StartEventElementMove:()=>d.L4,StartEventTools:()=>d.t3,TaskMove:()=>d.Yv,UpdateAssociationToConnectionType:()=>d.bU,UpdateConditionalConnectionType:()=>d.Ln,UpdateConnectionToAssociationOneWayType:()=>d.BB,UpdateConnectionToAssociationType:()=>d.lQ,canTransformAssociationToConnectionType:()=>d.Z$,canTransformConnectionToAssociationOneWayType:()=>d.Xi,getRequiredConnectionType:()=>d.ev,hasOutgoingConditional:()=>d.Hz,isAssociation:()=>d.Yc,isBoundaryEventElement:()=>d.dS,isConditionalConnection:()=>d.fr,isConnectToAnnotation:()=>d.X3,isConnectToDataObject:()=>d.W1,isConnection:()=>d.Ho,isConnectionConditional:()=>d.rq,isConvertToIntermediateThrowEventSignal:()=>d.du,isDefaultConnection:()=>d.Gy,isElementConvertFromContainer:()=>d.Qt,isElementConvertToContainer:()=>d.h5,isOneWayAssociation:()=>d.pN,isOrGateway:()=>d.x$,isParticipantElement:()=>d.xT,isReadyToTransformToConnection:()=>d.wE,isRequiredConditionalByGateway:()=>d.dF,isRequiredConnectionByGateway:()=>d.ER,isSubProcess:()=>d.Lb,isTwoWayAssociation:()=>d.yw});var a=f(29450),i=f.n(a),P={};for(const _ in a)_!=="default"&&(P[_]=()=>a[_]);f.d(R,P);var D=f(47528),A=f.n(D),P={};for(const _ in D)_!=="default"&&(P[_]=()=>D[_]);f.d(R,P);var d=f(49730)},49730:(Qt,R,f)=>{f.d(R,{AQ:()=>He,Gc:()=>Fe,ir:()=>Ue,R1:()=>H,Zq:()=>ke,uw:()=>L,fs:()=>ae,S5:()=>Mt,De:()=>Wt,HX:()=>ct,JN:()=>Un,ZD:()=>lt,hz:()=>Ee,Xg:()=>nt,EN:()=>st,PB:()=>it,qK:()=>X,Jy:()=>gt,ti:()=>pt,Br:()=>mt,cb:()=>ht,pd:()=>oe,Jv:()=>Y,N9:()=>W,W_:()=>le,bG:()=>K,xO:()=>ut,nL:()=>Oe,D9:()=>Ae,Tj:()=>Tt,j0:()=>Ct,V4:()=>wt,hu:()=>dt,j5:()=>Q,BQ:()=>G,uc:()=>It,Yx:()=>We,JR:()=>Rt,C$:()=>zt,DS:()=>de,oj:()=>Bt,vd:()=>pe,k$:()=>Ht,YB:()=>Se,O6:()=>ge,Nf:()=>Ge,LK:()=>w,GU:()=>v,ae:()=>A,$O:()=>xt,lG:()=>me,Sz:()=>re,IT:()=>Zt,Gj:()=>ee,xF:()=>Et,$1:()=>he,aT:()=>B,dx:()=>I,zV:()=>ce,mA:()=>Me,D$:()=>T,nk:()=>Ze,Uy:()=>te,Ow:()=>Le,e5:()=>q,BL:()=>ue,Ty:()=>Ve,_l:()=>_e,_Q:()=>N,pS:()=>jt,jK:()=>Ut,qJ:()=>Ie,ic:()=>kt,kD:()=>xe,kT:()=>fe,bD:()=>Lt,kV:()=>ye,a4:()=>z,hT:()=>ne,tG:()=>yt,mk:()=>ft,L4:()=>Ft,t3:()=>Ne,Yv:()=>fn,bU:()=>qe,Ln:()=>et,BB:()=>tt,lQ:()=>we,Z$:()=>$e,Xi:()=>Xe,ev:()=>Ce,Hz:()=>Ye,Yc:()=>_t,dS:()=>at,fr:()=>vt,X3:()=>Te,W1:()=>De,Ho:()=>Pt,rq:()=>Qe,du:()=>ot,Gy:()=>bt,Qt:()=>Pe,h5:()=>_,pN:()=>St,x$:()=>Ke,xT:()=>rt,wE:()=>Je,dF:()=>se,ER:()=>ie,Lb:()=>d,yw:()=>Dt});var a=f(29450),i=f(47528),D=f(94450);class A extends a.DiagramComponent{get modeling(){return this.get("modeling")}update(e){switch(e.property){case"caption":this.modeling.updateLabel(e.id,e.value);break;case"documentation":new i.ProcessDiagramUtils().isConnection(e)?this.modeling.updateConnection(e.id,{documentation:e.value}):this.modeling.updateElement(e.id,{documentation:e.value});break}}}A.\u0275fac=function(){let c;return function(t){return(c||(c=D.\u0275\u0275getInheritedFactory(A)))(t||A)}}(),A.\u0275cmp=D.\u0275\u0275defineComponent({type:A,selectors:[["ts-app-process-diagram"]],features:[D.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[[1,"diagram-container"],["diagramContainer",""]],template:function(e,t){e&1&&D.\u0275\u0275element(0,"div",0,1)},styles:[`.djs-outline{fill:none;visibility:hidden}.djs-element.hover .djs-outline,.djs-element.selected .djs-outline{visibility:visible;shape-rendering:crispEdges;stroke-dasharray:3,3}.djs-element.selected .djs-outline{stroke:#88f;stroke-width:1px}.djs-element.hover .djs-outline{stroke:#f88;stroke-width:1px}svg.drop-not-ok{background:#f9dee5!important}.djs-connection.connect-ok .djs-visual>:nth-child(1),.djs-connection.drop-ok .djs-visual>:nth-child(1){stroke:#90dd5f!important}.djs-connection.connect-not-ok .djs-visual>:nth-child(1),.djs-connection.drop-not-ok .djs-visual>:nth-child(1){stroke:#e56283!important}.drop-not-ok,.connect-not-ok{cursor:not-allowed}.djs-element.attach-ok .djs-visual>:nth-child(1){stroke-width:5px!important;stroke:#ff7400b3!important}.djs-frame.connect-not-ok .djs-visual>:nth-child(1),.djs-frame.drop-not-ok .djs-visual>:nth-child(1){stroke-width:3px!important;stroke:#e56283!important;fill:none!important}.djs-lasso-overlay{fill:#ff7400;fill-opacity:.1;stroke-dasharray:5 1 3 1;stroke:#ff7400;shape-rendering:crispEdges;pointer-events:none}.djs-resize-overlay{fill:none;stroke-dasharray:5 1 3 1;stroke:#ff7400;pointer-events:none}.djs-resizer-hit{fill:none;pointer-events:all}.djs-resizer-visual{fill:#fff;stroke-width:1px;stroke:#000;shape-rendering:crispEdges;stroke-opacity:.2}.djs-cursor-resize-ns,.djs-resizer-n,.djs-resizer-s{cursor:ns-resize}.djs-cursor-resize-ew,.djs-resizer-e,.djs-resizer-w{cursor:ew-resize}.djs-cursor-resize-nwse,.djs-resizer-nw,.djs-resizer-se{cursor:nwse-resize}.djs-cursor-resize-nesw,.djs-resizer-ne,.djs-resizer-sw{cursor:nesw-resize}.djs-shape.djs-resizing>.djs-outline{visibility:hidden!important}.djs-shape.djs-resizing>.djs-resizer{visibility:hidden}.djs-dragger>.djs-resizer{visibility:hidden}marker.djs-dragger circle,marker.djs-dragger path,marker.djs-dragger polygon,marker.djs-dragger polyline,marker.djs-dragger rect{fill:#ff7400!important;stroke:none!important}marker.djs-dragger text,marker.djs-dragger tspan{fill:none!important;stroke:#ff7400!important}.djs-dragging{opacity:.3}.djs-dragging,.djs-dragging>*{pointer-events:none!important}.djs-dragging .djs-context-pad,.djs-dragging .djs-outline{display:none!important}.djs-visual,.djs-outline{pointer-events:none}.djs-element.attach-ok .djs-hit{stroke-width:60px!important}.djs-element>.djs-hit-all{pointer-events:all}.djs-element>.djs-hit-stroke,.djs-element>.djs-hit-click-stroke{pointer-events:stroke}.djs-drag-active .djs-element>.djs-hit-click-stroke{pointer-events:all}.djs-connection .djs-visual{stroke-width:2px;fill:none}.djs-cursor-grab{cursor:grab}.djs-cursor-grabbing{cursor:grabbing}.djs-cursor-crosshair{cursor:crosshair}.djs-cursor-move{cursor:move}.djs-cursor-resize-ns{cursor:ns-resize}.djs-cursor-resize-ew{cursor:ew-resize}.djs-snap-line{stroke:#ffc342;stroke:#ffc34280;stroke-linecap:round;stroke-width:2px;pointer-events:none}.djs-crosshair{stroke:#555;stroke-linecap:round;stroke-width:1px;pointer-events:none;shape-rendering:crispEdges;stroke-dasharray:5,5}.djs-palette{position:absolute;left:20px;top:20px;box-sizing:border-box;width:48px}.djs-palette .separator{margin:0 5px;padding-top:5px;border:none;border-bottom:solid 1px #DDD;clear:both}.djs-palette .entry:before{vertical-align:text-bottom}.djs-palette .djs-palette-toggle{cursor:pointer}.djs-palette .entry,.djs-palette .djs-palette-toggle{color:#333;font-size:30px;text-align:center}.djs-palette .entry{float:left}.djs-palette .entry img{max-width:100%}.djs-palette .djs-palette-entries:after{content:"";display:table;clear:both}.djs-palette .djs-palette-toggle:hover{background:#666}.djs-palette .entry:hover{color:#ff7400}.djs-palette .highlighted-entry{color:#ff7400!important}.djs-palette .entry,.djs-palette .djs-palette-toggle{width:46px;height:46px;line-height:46px;cursor:default}.djs-palette.two-column.open{width:94px}.djs-palette:not(.open) .djs-palette-entries{display:none}.djs-palette:not(.open){overflow:hidden}.djs-palette.open .djs-palette-toggle{display:none}.djs-overlay-context-pad{width:72px}.djs-context-pad{position:absolute;display:none;pointer-events:none}.djs-context-pad .entry{width:22px;height:22px;text-align:center;display:inline-block;font-size:22px;margin:0 2px 2px 0;border-radius:3px;cursor:default;background-color:#fefefe;box-shadow:0 0 2px 1px #fefefe;pointer-events:all}.djs-context-pad .entry:before{vertical-align:top}.djs-context-pad .entry:hover{background:rgb(255,252,176)}.djs-context-pad.open{display:block}.djs-popup .entry{line-height:20px;white-space:nowrap;cursor:default}.djs-popup .entry:before{vertical-align:middle;font-size:20px}.djs-popup .entry>span{vertical-align:middle;font-size:14px}.djs-popup .entry:hover,.djs-popup .entry.active:hover{background:rgb(255,252,176)}.djs-popup .entry.disabled{background:inherit}.djs-popup .djs-popup-header .entry{display:inline-block;padding:2px 3px;border:solid 1px transparent;border-radius:3px}.djs-popup .djs-popup-header .entry.active{color:#ff7400;border:solid 1px rgb(255,116,0);background-color:#f6f6f6}.djs-popup-body .entry{padding:4px 10px 4px 5px}.djs-popup-body .entry>span{margin-left:5px}.djs-popup-body{background-color:#fefefe}.djs-popup-header{border-bottom:1px solid #DDD}.djs-popup-header .entry{margin:1px 1px 1px 3px}.djs-popup-header .entry:last-child{margin-right:3px}.djs-popup,.djs-palette{background:#FAFAFA;border:solid 1px #CCC;border-radius:2px}.djs-shape,.djs-connection{touch-action:none}.djs-segment-dragger,.djs-bendpoint{display:none}.djs-segment-dragger .djs-visual{fill:#ffff7933;stroke-width:1px;stroke-opacity:1;stroke:#ffff794d}.djs-bendpoint .djs-visual{fill:#ffff79cc;stroke-width:1px;stroke-opacity:.5;stroke:#000}.djs-segment-dragger:hover,.djs-bendpoints.hover .djs-segment-dragger,.djs-bendpoints.selected .djs-segment-dragger,.djs-bendpoint:hover,.djs-bendpoints.hover .djs-bendpoint,.djs-bendpoints.selected .djs-bendpoint{display:block}.djs-drag-active .djs-bendpoints *{display:none}.djs-bendpoints:not(.hover) .floating{display:none}.djs-segment-dragger:hover .djs-visual,.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint:hover .djs-visual,.djs-bendpoint.floating .djs-visual{fill:#ff0;stroke-opacity:.5;stroke:#000}.djs-bendpoint.floating .djs-hit{pointer-events:none}.djs-segment-dragger .djs-hit,.djs-bendpoint .djs-hit{pointer-events:all;fill:none}.djs-segment-dragger.horizontal .djs-hit{cursor:ns-resize}.djs-segment-dragger.vertical .djs-hit{cursor:ew-resize}.djs-segment-dragger.djs-dragging .djs-hit{pointer-events:none}.djs-updating,.djs-updating>*{pointer-events:none!important}.djs-updating .djs-context-pad,.djs-updating .djs-outline,.djs-updating .djs-bendpoint,.connect-ok .djs-bendpoint,.connect-not-ok .djs-bendpoint,.drop-ok .djs-bendpoint,.drop-not-ok .djs-bendpoint{display:none!important}.djs-segment-dragger.djs-dragging,.djs-bendpoint.djs-dragging{display:block;opacity:1}.djs-segment-dragger.djs-dragging .djs-visual,.djs-bendpoint.djs-dragging .djs-visual{fill:#ff0;stroke-opacity:.5}.djs-tooltip-error{font-size:11px;line-height:18px;text-align:left;padding:5px;opacity:.7}.djs-tooltip-error>*{width:160px;background:rgb(252,236,240);color:#9e4c4c;padding:3px 7px;border-radius:5px;border-left:solid 5px rgb(174,73,73)}.djs-tooltip-error:hover{opacity:1}.djs-search-container{position:absolute;top:20px;left:0;right:0;margin-left:auto;margin-right:auto;width:25%;min-width:300px;max-width:400px;z-index:10;font-size:1.05em;opacity:.9;background:#FAFAFA;border:solid 1px #CCC;border-radius:2px}.djs-search-container:not(.open){display:none}.djs-search-input input{font-size:1.05em;width:100%;padding:6px 10px;border:1px solid #ccc}.djs-search-input input:focus{outline:none;border-color:#52b415}.djs-search-results{position:relative;overflow-y:auto;max-height:200px}.djs-search-results:hover{cursor:pointer}.djs-search-result{width:100%;padding:6px 10px;background:white;border-bottom:solid 1px #AAA;border-radius:1px}.djs-search-highlight{color:#000}.djs-search-result-primary{margin:0 0 10px}.djs-search-result-secondary{font-family:monospace;margin:0}.djs-search-result:hover{background:#fdffd6}.djs-search-result-selected{background:#fffcb0}.djs-search-result-selected:hover{background:#f7f388}.djs-search-overlay{background:yellow;opacity:.3}.djs-element-hidden,.djs-element-hidden .djs-hit,.djs-element-hidden .djs-outline,.djs-label-hidden .djs-label{display:none!important}
`,`.diagram-container{position:relative;height:100%;width:100%;margin:0}.diagram-container svg{display:block}.djs-container{direction:ltr}.djs-tooltip{border-radius:4px;padding:8px;width:150px;opacity:.9;backdrop-filter:blur(5px);z-index:1010}.djs-palette{left:10px;top:10px;border-radius:4px;overflow:hidden;padding-top:6px;padding-bottom:6px}.djs-palette.open,.djs-palette.two-column.open{width:46px}.djs-palette .group{padding:0!important;width:100%}.djs-palette .entry{width:32px;height:32px;line-height:32px;margin-left:6px;cursor:pointer}.djs-palette .entry.active{border-radius:7px}.djs-palette .entry.create-menu:after{content:"";position:absolute;width:0;height:0;border-top:3px solid transparent;border-bottom:3px solid transparent;border-left:3px solid #006ce0;margin-top:13px;margin-left:-4px}.djs-context-pad.open{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;border-radius:4px;pointer-events:auto}.djs-context-pad.open .group{display:grid;grid-template-columns:auto auto;padding:3px}.djs-context-pad.open .group:not(:first-child){padding-left:0}.djs-context-pad.open.one-column-grid .group{grid-template-columns:auto}.djs-context-pad.open .entry{height:32px;width:32px;background:transparent;margin:0;box-shadow:none;border-radius:3px}.djs-context-pad.open .entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}.djs-context-pad.open .entry.noop-entry:hover{background:inherit!important}.djs-context-pad.open .entry img{padding:4px}.entry.entry-separator{height:0;margin-top:4px;margin-bottom:4px}@supports (backdrop-filter: none){.djs-context-pad.open{backdrop-filter:blur(5px);background:rgba(255,255,255,.7803921569)}.djs-context-pad.open .entry{background:transparent}}.djs-context-pad{max-width:72px}.djs-element.djs-connection.djs-updating path,.djs-element.djs-connection.selected path,.djs-element.djs-connection.animated path{stroke:#1186d8!important}.djs-element.djs-connection.djs-updating path.connection-end-marker,.djs-element.djs-connection.selected path.connection-end-marker,.djs-element.djs-connection.animated path.connection-end-marker{fill:#1186d8!important}.djs-element.djs-connection.animated path.connection{stroke-width:3!important;stroke-dasharray:20,3;animation:dash 5s linear infinite}@keyframes dash{0%{stroke-dashoffset:115}}.djs-bendpoint .djs-visual{fill:#fff;stroke-width:1px;stroke:#1186d8}.djs-bendpoint.floating .djs-visual{display:none}.djs-bendpoints.hover .djs-visual{stroke:#8095b3}.djs-element.hover .djs-outline{stroke:#a7c6ff}.laneSet.hover .djs-visual,.lane.hover .djs-visual{opacity:initial}.djs-element.selected .djs-outline{stroke:#3168cc}.djs-segment-dragger .djs-visual{fill:transparent;stroke:transparent}.djs-snap-line{stroke-width:1px}.djs-popup{overflow-y:auto;overflow-x:hidden;max-height:calc(100% - 20px);opacity:0;transition:opacity .2s ease-out}.djs-popup .entry{display:flex;flex-direction:row-reverse;justify-content:flex-end;align-items:stretch;padding:5px 7px}.djs-popup .entry img{height:24px;width:24px}.djs-popup .djs-popup-header{display:flex;margin:0 9px}.djs-popup .djs-popup-header .entry.active{border:none}.djs-popup .djs-popup-header .entry:first-child{margin-left:0}.djs-popup .djs-popup-header .entry{height:34px;width:34px;padding:4px;margin:2px 1px 2px 4px}.djs-dragger .djs-visual rect{fill:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border){display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;pointer-events:none}.djs-direct-editing-parent:not(.djs-direct-editing-parent-no-border) .djs-direct-editing-content{margin:0 auto;pointer-events:auto;text-align:center}.djs-direct-editing-content{user-select:text!important;overflow:hidden;outline:none;resize:none}.djs-direct-editing-parent-no-border .djs-direct-editing-content{border:0}.djs-direct-editing-rotate-90{transform:rotate(-90deg);transition:transform .1s ease}.djs-direct-editing-rotate-90 .djs-direct-editing-content{border:none;transition:border .1s ease}.djs-direct-editing-rotate-0{transform:rotate(0)}.djs-text-hidden text{display:none}.djs-text-hidden foreignObject{display:none}.djs-direct-editing-resize-handle{display:none}.djs-shape.connect-ok.textAnnotation .djs-visual>:nth-child(1):not(path),.djs-shape.connect-not-ok.textAnnotation .djs-visual>:nth-child(1):not(path){fill:inherit!important}.djs-element.lane.hover:not(.selected) .djs-outline{stroke:none}.djs-element.laneSet.hover:not(.selected) .djs-outline{stroke:none}foreignObject.djs-label{overflow:visible}.foreign-text-container{display:flex;justify-content:center;height:100%}.laneSet .foreign-text-container,.lane .foreign-text-container{align-items:center}.eventSubProcessExpanded .foreign-text-container{height:initial;padding:5px}.foreign-text{text-align:center;box-sizing:border-box;outline:none;font-family:Open Sans,sans-serif;font-size:12px;font-weight:400;line-height:1.2;overflow-wrap:break-word;white-space:pre-line}.label .foreign-text{max-width:130px;user-select:text}.textAnnotation .foreign-text{padding:12px;max-width:none;text-align:left;line-height:1.41667;word-wrap:break-word}.textAnnotation foreignObject{height:100%}.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}@supports (-webkit-line-clamp: 2){.eventSubProcessExpanded .foreign-text,.laneSet .foreign-text,.lane .foreign-text{vertical-align:center;overflow:hidden;text-overflow:ellipsis;white-space:initial;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}}.foreign-text-helper{max-width:128px;min-height:14.39px;width:fit-content;margin:0 auto;overflow-wrap:break-word}.diagram-create-popup-menu{border-top:none!important}.diagram-create-popup-menu .entry{cursor:move}.djs-minimap{position:absolute;right:8px;bottom:11px;width:248px;height:33px;border-radius:4px;opacity:1;overflow:hidden;box-sizing:border-box;user-select:none;transition:height .2s cubic-bezier(0,0,.2,1)}.djs-minimap .map-buttons{position:absolute;bottom:0;left:0;right:0;height:32px;display:flex;padding:0 5px;z-index:1}.djs-minimap .map-buttons .map-button{min-width:32px;height:32px;cursor:pointer;line-height:32px;font-size:16px;padding:0 8px;background-position:center;transition:background .8s}.djs-minimap .map-buttons .map-button:active{background-size:100%;transition:background 0s}.djs-minimap .map-buttons .map-button.preview-button{padding:0 12px 0 10px;margin:0 4px 0 0;min-width:40px}.djs-minimap .map-buttons .map-button.zoom-button{width:100%;height:100%;padding:0 16px 0 0;text-align:right}.djs-minimap .map-buttons .map-button.zoom-button:after{content:"";position:absolute;width:0;height:0;right:9px;top:16px}.djs-minimap .map{width:248px;height:148px;margin-bottom:32px;cursor:crosshair}.djs-minimap.open{transition:height .2s cubic-bezier(.18,.89,.32,1.28);height:180px}.djs-minimap.open .overlay{position:absolute;inset:0;pointer-events:none}.djs-minimap .viewport{fill:none;stroke:none}.djs-minimap .viewport-dom{position:absolute;border-radius:2px;box-sizing:border-box;cursor:move}.djs-minimap .cursor-crosshair{cursor:crosshair}.djs-minimap .cursor-move{cursor:move}.djs-popup.zoom{right:8px;bottom:47px;top:inherit!important;left:inherit!important}.djs-popup.zoom .entry{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch}.djs-popup.zoom .entry.entry-separator{padding:0!important;margin:4px 10px!important}#canvas_svg_export{position:absolute;left:50px;top:50px;box-shadow:0 0 9px 2px #0000007a}#canvas_svg_export .close-button{position:absolute;right:8px;width:16px;height:16px;cursor:pointer}
`],encapsulation:2});var P=f(33177);function d(c){switch((0,P.toObject)(c).type){case i.ProcessElementType.eventSubProcessExpanded:case i.ProcessElementType.subProcessExpanded:case i.ProcessElementType.subProcessCollapsed:return!0;default:return!1}}function _(c){return c.type!==c.oldType&&(i.ProcessDiagramUtils.isEventSubProcessExpanded(c)||i.ProcessDiagramUtils.isSubProcessExpanded(c))}function Pe(c){const e=c.oldType;return c.type!==e&&(e===i.ProcessElementType.eventSubProcessExpanded||e===i.ProcessElementType.subProcessExpanded)}var o=f(74742),J=f(91658),ve=f(64960);let X=class extends J.Z{constructor(e,t,n){super(e,n),this.spaceTool=t,this.diagramUtils=n,super.postExecuted("shape.delete",a.EventPriority.LOW,s=>{const r=s.context,l=r.hints,p=l&&l.nested;r.shape.type===i.ProcessElementType.lane&&!p&&l.layout!==!1&&this.compensate(r.shape,r.oldParent)})}compensate(e,t){const n=this.diagramUtils.getPool(t),s=(0,ve.PB)(n,!1),r=e.height,l=this.spaceTool.calculateAdjustments(s,"y",r,e.y+10);(!t.children||!t.children.length)&&(l.movingShapes=[],l.resizingShapes=[]),this.spaceTool.makeSpace(l.movingShapes,l.resizingShapes,{x:0,y:-r},"s")}};X=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("spaceTool")),(0,o.__param)(2,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,i.ProcessDiagramUtils])],X);var x=f(97600),qt=f(59879),en=f.n(qt);function be(c){J.Z.call(this,c);var e=this;this.preExecute(["shape.create","connection.create"],function(t){var n=t.context,s=n.shape||n.connection,r=n.parent,l=e.getOrdering(s,r);l&&(l.parent!==void 0&&(n.parent=l.parent),n.parentIndex=l.index)}),this.preExecute(["shape.move","connection.move"],function(t){var n=t.context,s=n.shape||n.connection,r=n.newParent||s.parent,l=e.getOrdering(s,r);l&&(l.parent!==void 0&&(n.newParent=l.parent),n.newParentIndex=l.index)})}be.prototype.getOrdering=function(c,e){return null},en()(be,J.Z);let Y=class extends be{constructor(e,t){super(e),this.elements=t,this.defaultOrderLevel=5,this.preExecute.call(this,[a.Handlers.element.update],s=>this.onElementUpdateHandler(s))}onElementUpdateHandler(e){const t=e.context,n=t.element||t.connection,s=t.type;if(s===n.type)return;const r=x.assign({},n,{type:s,userTaskType:t.userTaskType}),l=this.getOrdering(r,n.parent);l&&(l.parent!==void 0&&(t.parent=l.parent),t.parentIndex=l.index)}getLevel(e){const n=this.elements.getConfig(e).order;return!n&&i.ProcessDiagramUtils.isFlowNode(e)?this.defaultOrderLevel:n?n.level:1}getOrdering(e,t){let n=0;if(t.children){const s=this.getLevel(e),r=t.children.indexOf(e);n=x.findIndex(t.children,l=>s<this.getLevel(l)),r>-1&&r<n&&(n-=1)}return{index:n,parent:t}}};Y=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("elements")),(0,o.__metadata)("design:paramtypes",[Object,i.ProcessElements])],Y);var j=f(44610);class _e extends a.Layouter{isStraightConnection(e,t,n){if(this.config.isStraightConnection)return!0;const s=i.ProcessDiagramUtils.isAnnotationElement(t)||i.ProcessDiagramUtils.isAnnotationElement(e);return i.ProcessDiagramUtils.isDataObject(e)||i.ProcessDiagramUtils.isDataObject(t)||i.ProcessDiagramUtils.isAssociation(n)||s}}let K=class extends a.BaseDiagramSnapping{constructor(e,t,n,s,r,l){super(e,t,l),this.eventBus=e,this.canvas=t,this.elementRegistry=n,this.rules=s,this.layouter=r,this.diagramUtils=l,this.subscribeEvents()}_snapBoundaryEvent(e){const t=this._nearestBoundaryPoint(e);this.snapEvent(e,t)}subscribeEvents(){const e=this.rules;this.eventBus.on([a.Handlers.create.move,a.Handlers.create.end,a.Handlers.shape.move,a.Handlers.shape.end],a.EventPriority.HIGH,t=>{e.allowed("canElementDock",t.context)&&this._snapBoundaryEvent(t)})}_getSnappingSidePoint(e,t,n,s){return e-t<t+n-e?t+s:t+n-s}_nearestBoundaryPoint(e){const s=e.context.target,r={x:s.x,y:s.y},l=e.x>=s.x&&e.x,p=e.y>=s.y&&e.y;if(l&&(r.x=e.x+-5,e.y<s.y&&(r.y=s.y+-5)),p&&(r.y=e.y+-5,e.x<s.x&&(r.x=s.x+-5)),l&&p){const g=e.x-s.x,m=s.x+s.width-e.x,u=e.y-s.y,y=s.y+s.height-e.y,h=Math.min(g,m),E=Math.min(u,y);h<E?r.x=this._getSnappingSidePoint(e.x,s.x,s.width,-5):r.y=this._getSnappingSidePoint(e.y,s.y,s.height,-5)}return r}snapBendpoint(e,t,n){const s=(0,j.Pi)(e),r=10,l=Math.abs(t-s.x)<=r,p=Math.abs(n-s.y)<=r;return{x:l?s.x:t,y:p?s.y:n}}canSetSnapping(e){const{target:t}=e;return super.canSetSnapping(e)&&!i.ProcessDiagramUtils.isParticipants(t)&&!i.ProcessDiagramUtils.isEventSubProcessExpanded(t)&&!i.ProcessDiagramUtils.isStartEvent(t)}setSnapping(e){const{x:t,y:n,context:s}=e,{source:r,target:l,hover:p}=s;s.sourcePosition=(0,j.Pi)(r);const g=i.ProcessDiagramUtils.isAssociativeElement(r)||i.ProcessDiagramUtils.isAssociativeElement(l)?(0,j.Pi)(p):this.snapBendpoint(l,t,n);this.snapEvent(e,g)}};K=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("canvas")),(0,o.__param)(2,(0,a.Inject)("elementRegistry")),(0,o.__param)(3,(0,a.Inject)("rules")),(0,o.__param)(4,(0,a.Inject)("layouter")),(0,o.__param)(5,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,_e,a.DiagramUtils])],K);let Q=class{constructor(e){this.elements=e}getRectangleSize(e,t){const n=this.elements.getConfig(e),s=n.height/n.width,r=this.getElementSize(e,t),l=Math.round(r.width*s),p=l<r.height?new a.Size(r.width,l):new a.Size(Math.round(r.height/s),r.height);return p.width>e.width&&p.height>0?p:null}getMargin(e){return this.elements.getConfig(e).margin}getElementSize(e,t){const n=this.getMargin(e),s=t.x-e.x-n,r=t.y-e.y-n;return new a.Size(s,r)}getMaxRightBottomPoint(e){const t=this.getDefaultSize(e.type),n=this.getMargin(e);let s=e.x+t.width+n,r=e.y+t.height+n;const l=e.parent;return i.ProcessDiagramUtils.isRoot(l)||(s=Math.min(s,l.x+l.width),r=Math.min(r,l.y+l.height)),new a.Point(s,r)}isIntersects(e,t){return t.x+t.width>e.leftTopPoint.x&&t.x<e.rightBottomPoint.x&&t.y+t.height>e.leftTopPoint.y&&t.y<e.rightBottomPoint.y}needCheckIntersection(e,t){return e.id!==t.id&&(e.parent===t.parent||i.ProcessDiagramUtils.isLabel(t)&&e!==t.parent)}getBoundingPoints(e,t){const n=[],s=this.getMaxRightBottomPoint(e),l={leftTopPoint:new a.Point(e.x,e.y),rightBottomPoint:s};t.forEach(g=>{this.needCheckIntersection(e,g)&&this.isIntersects(l,g)&&n.push(new a.Point(g.x,g.y))}),n.push(s);const p=new a.Point(e.x,s.y);return n.push(p),n.sort((g,m)=>m.x-g.x)}getElementMaxSize(e,t){const n=this.getBoundingPoints(e,t);let s=0,r;for(;n.length>1;){const l=n.shift(),p=x.minBy(n,m=>m.y).y,g=this.getRectangleSize(e,new a.Point(l.x,p));if(g){const m=g.width*g.height;m>s&&(r=g,s=m)}}return r||(r=new a.Size(e.width,e.height)),r}getDefaultSize(e){const t=this.elements.items[e];return new a.Size(t.width,t.height)}};Q=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("elements")),(0,o.__metadata)("design:paramtypes",[i.ProcessElements])],Q),(0,P.ngxTranslateExtract)("diagram.elementTools.annotate");const tn="assets/images/icon_tools_annotate.svg";class L extends a.BaseElementTools{constructor(e){super(e),this.context=e,this.diagramGroups=e.groups}getDragStartShapeConfig(e){const t=super.getDragStartShapeConfig(e);return t.userTaskType=e.userTaskType,t}getAnnotateConfig(){return{annotate:{title:this.localizableStrings.get("elementTools.annotate"),imageUrl:tn,action:{dragstart:this.addElementDragStart.bind(this,{type:i.ProcessElementType.textAnnotation})}}}}hasConnectConfig(e){return e.type&&!this.diagramGroups.groups.withoutConnect.elements.includes(e.type)}hasAddItemsMenu(e){return i.ProcessDiagramUtils.isTaskElement(e)||i.ProcessDiagramUtils.isGateway(e)||i.ProcessDiagramUtils.isStartEvent(e)||i.ProcessDiagramUtils.isIntermediateThrowEvent(e)||i.ProcessDiagramUtils.isIntermediateCatchEvent(e)||i.ProcessDiagramUtils.isBoundaryEvent(e)}hasAnnotateConfig(e){return e.type&&!this.diagramGroups.groups.withoutAnnotation.elements.includes(e.type)}supportAnnotate(){return!x.isUndefined(this.elements.items[i.ProcessElementType.textAnnotation])}getContextPadEntries(e){const t=super.getContextPadEntries(e);return this.hasAnnotateConfig(e)&&this.supportAnnotate()&&Object.assign(t,this.getAnnotateConfig()),t}}class He extends L{hasSetupMenu(e){return!1}}class Fe extends L{hasSetupMenu(e){const t=e.target||{},n=e.source||{};return!(i.ProcessDiagramUtils.isAnnotationElement(t)||i.ProcessDiagramUtils.isAnnotationElement(n))}}class We extends L{hasAddItemsMenu(e){return!1}}const nn="assets/images/icon_tools_add_above.svg",sn="assets/images/icon_tools_add_below.svg";(0,P.ngxTranslateExtract)("diagram.elementTools.lanes.addLaneAbove"),(0,P.ngxTranslateExtract)("diagram.elementTools.lanes.addLaneBelow");class Se extends L{hasSetupMenu(e){return!1}hasConnectConfig(){return!1}hasAnnotateConfig(){return!1}hasAddItemsMenu(e){return!0}getAddItemsConfig(e){return{addLaneAbove:{action:{click:()=>{this.modeling.addLane(e,-this.elements.items.lane.height)}},imageUrl:nn,title:this.localizableStrings.get("elementTools.lanes.addLaneAbove")},addLaneBelow:{action:{click:()=>{this.modeling.addLane(e,this.elements.items.lane.height)}},imageUrl:sn,title:this.localizableStrings.get("elementTools.lanes.addLaneBelow")}}}}(0,P.ngxTranslateExtract)("diagram.elementTools.lanes.divide");const an="assets/images/icon_tools_split_lane.svg";class Ge extends Se{getAddItemsConfig(e){const t=super.getAddItemsConfig(e);if(e.children&&e.children.some(s=>i.ProcessDiagramUtils.isLane(s)))return t;const n={splitLane:{action:{click:()=>{this.modeling.splitLane(e)}},imageUrl:an,title:this.localizableStrings.get("elementTools.lanes.divide")}};return Object.assign(t,n),t}}class Ne extends L{hasDeleteAction(e){return!i.ProcessDiagramUtils.isEventSubProcessExpanded(e.parent)}}class Ve extends a.ElementToolsFactory{constructor(e){super(e),this.context=e}getElementToolsFeature(e){switch(!0){case i.ProcessDiagramUtils.isLabel(e):return new a.LabelTools(this.context);case i.ProcessDiagramUtils.isLaneSet(e):return new Se(this.context);case i.ProcessDiagramUtils.isLane(e):return new Ge(this.context);case i.ProcessDiagramUtils.isEventSubProcessExpanded(e):return new We(this.context);case i.ProcessDiagramUtils.isStartEvent(e):return new Ne(this.context);case i.ProcessDiagramUtils.isAssociationElement(e):return new Fe(this.context);case i.ProcessDiagramUtils.isAnnotationElement(e):return new He(this.context);default:return new L(this.context)}}}let q=class extends a.ElementTools{constructor(e,t,n,s,r,l,p,g,m,u,y){super(e,t,n,s,r,l,p,g,u,y),this.elements=u,this.elementToolsConfig=y;const h=g.localizableStrings;t.registerProvider(this);const E={modeling:n,localizableStrings:h,contextPad:t,canvas:p,popupMenu:l,elementFactory:s,create:r,connect:e,groups:m,elements:u,elementToolsConfig:y};this.toolsFactory=new Ve(E)}};q=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("connect")),(0,o.__param)(1,(0,a.Inject)("contextPad")),(0,o.__param)(2,(0,a.Inject)("modeling")),(0,o.__param)(3,(0,a.Inject)("elementFactory")),(0,o.__param)(4,(0,a.Inject)("create")),(0,o.__param)(5,(0,a.Inject)("popupMenu")),(0,o.__param)(6,(0,a.Inject)("canvas")),(0,o.__param)(7,(0,a.Inject)("config")),(0,o.__param)(8,(0,a.Inject)("groups")),(0,o.__param)(9,(0,a.Inject)("elements")),(0,o.__param)(10,(0,a.Inject)("elementToolsConfig")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object,i.ProcessDiagramGroups,i.ProcessElements,Object])],q);class z extends a.DiagramSplitConnectionHelper{isForbiddenType(e){return super.isForbiddenType(e)||i.ProcessDiagramUtils.isStartEvent(e)||i.ProcessDiagramUtils.isEndEvent(e)||i.ProcessDiagramUtils.isAnnotationElement(e)||i.ProcessDiagramUtils.isDataStore(e)||i.ProcessDiagramUtils.isDataObject(e)}}let ee=class extends a.DiagramLabelEdit{constructor(e,t,n,s,r,l,p,g){super(e,t,n,s,r,l,p),this.eventBus=e,this.directEditing=t,this.canvas=n,this.modeling=s,this.diagramText=r,this.selection=l,this.rules=p,this.elements=g}updateLabelParent(e){const t=e.context.shape;i.ProcessDiagramUtils.isLabel(t)&&(t.parent=t.labelTarget)}getAnnotationBounds(e){let t;const n=this.canvas,s=n.zoom(),r=e.width*s,l=10*s,p=5*s,g=e.label;if(g){const m=n.getAbsoluteBBox(g);t={height:m.height+l+p,width:r,x:Math.round(m.x+m.width/2-r/2),y:Math.round(m.y-l)}}else{const m=e.height*s,u={height:m,width:r},y=this.diagramText.getLabelPosition(e,u),h=n.getAbsoluteBBox(y),E=r-a.TextAreaOffset*s;t={height:m,width:r,x:Math.round(h.x-r/2+2*s),y:Math.round(h.y-m*s/2+5*s),minWidth:E,maxWidth:E}}return t}getLaneSetBounds(e){const t=this.canvas,n=t.zoom(),s=t.getAbsoluteBBox(e),r=i.Lanes.lane.headerWidth*n;return{height:r,width:s.height,x:Math.round(s.x-s.height/2+r/2),y:Math.round(s.y+s.height/2-r/2),minWidth:a.Labels.label.minWidth*n}}_getSubProcessExpandedBounds(e){const t=this.canvas,n=t.zoom(),s=t.getAbsoluteBBox(e),r=a.Labels.label.height*n,l=this.getPadding(a.Labels.label.padding,n);return{height:r,width:s.width-l.paddingLeft-l.paddingRight,x:s.x+l.paddingLeft,y:s.y+l.paddingTop,minWidth:s.width-l.paddingLeft-l.paddingRight}}showElementLabel(e){super.showElementLabel(e);const t=e.active&&e.active.element;t&&i.ProcessDiagramUtils.isEmbeddedLabelElement(t)&&this.canvas.removeMarker(t,"djs-text-hidden")}subscribeEvents(){super.subscribeEvents(),this.eventBus.on(["commandStack.shape.move.executed"],e=>this.updateLabelParent(e)),this.eventBus.on(["directEditing.activate"],e=>{const t=e.active.element.label;t&&this.canvas.addMarker(t,"djs-element-hidden");const n=e.active&&e.active.element;n&&i.ProcessDiagramUtils.isEmbeddedLabelElement(n)&&this.canvas.addMarker(n,"djs-text-hidden")})}editElementLabel(e){i.ProcessDiagramUtils.isAssociation(e)||super.editElementLabel(e)}onCreateEnd(e){const t=e.shape;(e.context.canExecute||i.ProcessDiagramUtils.isAnnotationElement(t))&&this.editElementLabel(t)}getBoxBounds(e){switch(!0){case i.ProcessDiagramUtils.isParticipants(e):return this.getLaneSetBounds(e);case i.ProcessDiagramUtils.isSubProcessExpanded(e):case i.ProcessDiagramUtils.isEventSubProcessExpanded(e):return this._getSubProcessExpandedBounds(e);case i.ProcessDiagramUtils.isAnnotationElement(e):return this.getAnnotationBounds(e);default:return super.getBoxBounds(e)}}getElementStyle(e){const t=this.canvas.zoom(),n=this.elements.getConfig(e);let s=x.cloneDeep(this.diagramText.style),r;switch(!0){case i.ProcessDiagramUtils.isAnnotationElement(e):s={...s,...n.label.editStyle},r=n.label.padding;break;case i.ProcessDiagramUtils.isParticipants(e):r=n.label.padding;break;default:r=a.Labels.label.padding;break}return this.getTextStyle(t,s,this.getPadding(r,t))}activate(e){const t=super.activate(e),n=this.elements.getConfig(e);return i.ProcessDiagramUtils.isEmbeddedLabelElement(e)&&(t.options.classList=n.label.editClassList),t}update(e,t,n){!(this.diagramText.isEmptyText(t)&&this.diagramText.isEmptyText(e.caption))&&e.caption!==t.trim()&&(i.ProcessDiagramUtils.isAnnotationElement(e)?this.modeling.updateLabel(e,t,n):super.update(e,t,n))}};ee=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("directEditing")),(0,o.__param)(2,(0,a.Inject)("canvas")),(0,o.__param)(3,(0,a.Inject)("modeling")),(0,o.__param)(4,(0,a.Inject)("diagramText")),(0,o.__param)(5,(0,a.Inject)("selection")),(0,o.__param)(6,(0,a.Inject)("rules")),(0,o.__param)(7,(0,a.Inject)("elements")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,i.ProcessElements])],ee);class Ze extends a.DiagramTextUtils{getAnnotationLabelPosition(e,t){return{x:Math.round(e.x+e.width/2+8),y:Math.round(e.y+t.height/2+5)}}getLabelPaddingTop(e,t){return this.diagramUtils.isConnection(e)||t?0:super.getLabelPaddingTop(e,t)}getLabelPosition(e,t){switch(t=t||this.elements.items.label,!0){case this.diagramUtils.isConnection(e):return this.getConnectionLabelPosition(e.waypoints,t);case i.ProcessDiagramUtils.isAnnotationElement(e):case e.type===i.ProcessElementType.subProcessExpanded:case e.type===i.ProcessElementType.eventSubProcessExpanded:return this.getAnnotationLabelPosition(e,t);default:return super.getLabelPosition(e,t)}}}let te=class extends a.DirectEditing{constructor(e,t,n,s,r,l,p){super(e,t,n,s,r,l,p),this.eventBus=e,this.canvas=t,this.elementRegistry=n,this.graphicsFactory=s,this.diagramText=r}_resizeAnnotation(e){const t=this.elementRegistry.getGraphics(this.active.element.id),n=this.active.element,s=this.canvas.zoom();n.previewHeight=n.previewHeight||n.height,n.previewHeight+=e.dy/s,n.height=n.previewHeight,this.eventBus.fire("shape.changed",{element:n,gfx:t}),this.graphicsFactory.update("shape",n,t)}handleResize(e){i.ProcessDiagramUtils.isAnnotationElement(this.active.element)&&this._resizeAnnotation(e),super.handleResize(e)}complete(){const e=this.active;if(!e)return;const t=e.element,n=this.getValue();let s=this.getNewBounds();if(i.ProcessDiagramUtils.isAnnotationElement(t)){const r=this.canvas.zoom(),l=this.activeTextbox.getBoundingClientRect();s={width:l.width/r,height:l.height/r+a.TextAreaOffset+a.TextAreaBorder,x:t.x,y:t.y},delete t.previewHeight,e.element.height=this.initialHeight,e.element.width=this.initialWidth}e.provider.update(e.element,n,s),this.close("complete")}};te=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("canvas")),(0,o.__param)(2,(0,a.Inject)("elementRegistry")),(0,o.__param)(3,(0,a.Inject)("graphicsFactory")),(0,o.__param)(4,(0,a.Inject)("diagramText")),(0,o.__param)(5,(0,a.Inject)("config")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],te);let ne=class extends a.UpdateLabelHandler{constructor(e,t,n){super(e,t),this.modeling=e,this.diagramText=t,this.elements=n}preExecute(e){const t=e.element;if(t&&!t.label)switch(!0){case i.ProcessDiagramUtils.isEmbeddedLabelElement(t):t.caption=e.text;break;case i.ProcessDiagramUtils.isLabel(t):break;default:this.diagramText.addLabel(this.modeling,t,this.elements.items.label,e.text);break}}execute(e){e.oldText=e.element.caption||"";const t=(e.text||"").trim();return this.setText(e.element,t)}revert(e){return this.setText(e.element,e.oldText)}postExecute(e){e.element&&i.ProcessDiagramUtils.isAnnotationElement(e.element)?e.newBounds&&this.resizeShape(e.element,e.newBounds):super.postExecute(e)}};ne=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__param)(1,(0,a.Inject)("diagramText")),(0,o.__param)(2,(0,a.Inject)("elements")),(0,o.__metadata)("design:paramtypes",[Object,a.DiagramTextUtils,i.ProcessElements])],ne);function $e(c,e,t,n){return i.ProcessDiagramUtils.isAssociation(n)&&Je(c,e,t)}function Je(c,e,t){const{diagramGroups:n}=c,s=[...n.groups.dataObjects.elements,...n.groups.textAnnotation.elements,...n.groups.dataStores.elements];return!(s.includes(e.type)||s.includes(t.type))}function Xe(c,e,t,n){return!i.ProcessDiagramUtils.isAssociation(n)&&De(c,e,t)}function De(c,e,t){const{diagramGroups:n}=c,s=[...n.groups.dataObjects.elements,...n.groups.dataStores.elements];return s.includes(e.type)||s.includes(t.type)}function Te(c,e={},t={}){const{diagramGroups:n}=c,s=n.groups.textAnnotation.elements;return s.includes(t.type)||s.includes(e.type)}function Ye(c,e){return c&&c.outgoing&&c.outgoing.length&&c.outgoing.some(t=>t.id!==e.id&&(t.type===i.ProcessElementType.conditionalConnection||t.type===i.ProcessElementType.defaultConnection))}function se(c,e=null){return c&&Ke(c.type)&&e!==i.ProcessElementType.defaultConnection}function ie(c){return c&&[i.ProcessElementType.eventBasedGateway,i.ProcessElementType.parallelGateway].includes(c.type)}function Ce(c,e=null){switch(!0){case ie(c):return i.ProcessElementType.connection;case se(c,e):return i.ProcessElementType.conditionalConnection;default:return null}}function Ke(c){return[i.ProcessElementType.inclusiveGateway,i.ProcessElementType.exclusiveGateway].includes(c)}function Qe(c,e={},t={},n){return Te(c,e,t)||De(c,e,t)?!1:n.type!==i.ProcessElementType.defaultConnection&&(Ye(e,n)||se(e,n.type))}class qe{updateConnectionType(e,t,n,s){s.type=i.ProcessElementType.connection}}class et{updateConnectionType(e,t,n,s){s.type=i.ProcessElementType.conditionalConnection}}class we{changeLineToStraight(e){if(!i.ProcessDiagramUtils.isAssociation(e)&&e.waypoints){const t=(0,x.clone)(e.waypoints);e.waypoints=[].concat([t.shift()],[t.pop()])}}updateConnectionType(e,t,n,s){this.changeLineToStraight(s),s.type=i.ProcessElementType.association}}class tt extends we{updateConnectionType(e,t,n,s){this.changeLineToStraight(s),s.type=i.ProcessElementType.associationOneWay}}class ae{updateConnectionType(e,t,n,s){ie(t)&&(s.type=i.ProcessElementType.connection)}}(0,o.__decorate)([(0,a.featureImplementationExtension)(Qe,et),(0,a.featureImplementationExtension)($e,qe),(0,a.featureImplementationExtension)(Xe,tt),(0,a.featureImplementationExtension)(Te,we),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object]),(0,o.__metadata)("design:returntype",void 0)],ae.prototype,"updateConnectionType",null);class nt{createShape(e,t,n,s,r,l){t.type=i.ProcessElementType.boundaryInterruptingEventSignal}}class st{createShape(e,t,n,s,r,l){t.type=i.ProcessElementType.intermediateThrowEventSignal}}class it{createShape(e,t,n,s,r,l={generateUniqueCaption:!0}){if(typeof r=="object"&&(l=r||l),l.generateUniqueCaption===!1)return;const p=e.elementRegistry,g=p.injector.get("config").localizableStrings,m=e.elements.getConfig(t),u=g.get(m.caption);if(u!==m.caption){const y=p.getAllElements();t.caption=a.UniqueNameService.prototype.generate(y,"caption",u)}}}function at(c,e,t,n){return e.type===i.ProcessElementType.intermediateThrowEvent&&n&&i.ProcessDiagramUtils.isTaskElement(n)&&!i.ProcessDiagramUtils.isEventSubProcessExpanded(n)}function rt(c,e){return i.ProcessDiagramUtils.isParticipants(e)}function ot(c,e,t,n){return e.type===i.ProcessElementType.intermediateThrowEvent&&n&&i.ProcessDiagramUtils.isEventSubProcessExpanded(n)}class Ue{createShape(e,t,n,s,r,l){}}(0,o.__decorate)([(0,a.featureImplementationExtension)(at,nt),(0,a.featureImplementationExtension)(rt,it),(0,a.featureImplementationExtension)(ot,st),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Number,Object]),(0,o.__metadata)("design:returntype",void 0)],Ue.prototype,"createShape",null);class ct{execute(e){const t=e.connection,n=t.target,s=t.source;return t.source=n,t.target=s,t.waypoints=t.waypoints.reverse(),t}}class lt{execute(e){const t=e.connection;return e.oldType=t.type,t.type=e.type,e.oldDocumentation=t.documentation,t.documentation=e.documentation,t}}let re=class extends a.DiagramCreateShapeHandler{constructor(e,t,n,s,r){super(e,r),this.modeling=t,this.elementRegistry=n,this.splitConnectionHelper=s,this.diagramUtils=r}getRealParent(e){const t=this.diagramUtils.getAllContainers(this.elementRegistry.getAllElements()),n=this.canvas.getRootElement();return this.diagramUtils.findRealElementParent({x:e.x,y:e.y},t,n)}execute(e){const t=super.execute(e),n=t.parent;return n&&this.diagramUtils.isFlow(n)&&(e.targetConnection=n,t.parent=this.getRealParent(t)),t}postExecute(e){e.targetConnection&&this.splitConnectionHelper.splitConnection({connection:e.targetConnection,shapes:[e.shape],modeling:this.modeling})}};re=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("canvas")),(0,o.__param)(1,(0,a.Inject)("modeling")),(0,o.__param)(2,(0,a.Inject)("elementRegistry")),(0,o.__param)(3,(0,a.Inject)("splitConnectionHelper")),(0,o.__param)(4,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,z,a.DiagramUtils])],re);var rn=f(78542);let oe=class extends rn.Z{constructor(e,t){super(e),this.modeling=e,this.diagramUtils=t,this._helper=new a.DiagramMoveHelper(e),this.convertUtils=new a.ProcessConvertUtils(t)}postExecute(e){if(e.hints.recalcShapePosition){const n=e.delta,s=e.shape;this._helper.moveRecursiveShape(s,n)}else super.postExecute(e)}execute(e){const t=super.execute(e),n=e.oldBounds;return n.rx=t.rx,n.ry=t.ry,i.ProcessDiagramUtils.isLabel(t)&&(e.oldParent=t.labelTarget),this.convertUtils.setRelativePosition(t),t}};oe=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__param)(1,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object])],oe);let ce=class extends a.DiagramMoveElementsHandler{constructor(e,t,n,s,r,l){super(e,t,n,l),this.modeling=e,this.elementRegistry=t,this.canvas=n,this.splitConnectionHelper=s,this.diagramGroups=r,this.diagramUtils=l}changeType(e){const t=e.newParent,n=e.shapes;!t||!n||!n.length||n.forEach(s=>{s.type===i.ProcessElementType.intermediateThrowEvent&&i.ProcessDiagramUtils.isEventSubProcessExpanded(t)&&this.modeling.updateElement(s,{type:i.ProcessElementType.intermediateThrowEventSignal})})}_getShapesWithChangedParent(e,t){let n=e.filter(s=>s.parent.id!==t.id);if(!i.ProcessDiagramUtils.isEventSubProcessExpanded(t)){let s=!1;if(this.diagramUtils.isFlow(t)){const r=t.source,l=t.target;s=i.ProcessDiagramUtils.isEventSubProcessExpanded(r.parent)&&i.ProcessDiagramUtils.isEventSubProcessExpanded(l.parent)}n=n.filter(r=>i.ProcessDiagramUtils.isEventSubProcessExpanded(r.parent)&&!s||!i.ProcessDiagramUtils.isEventSubProcessExpanded(r.parent)&&s)}return n}getConnectionsToRemove(e){const t=e.newParent,n=e.shapes;if(!t||!n||!n.length)return[];const r=this.elementRegistry.getAllElements().filter(m=>this.diagramUtils.isFlow(m)),l=this._getShapesWithChangedParent(n,t),p=(m,u=l)=>u.some(y=>y.id===m.id||y.children&&p(m,y.children));return r.filter(m=>{const u=m.source,y=m.target;if(p(u)&&p(y)||!p(u)&&!p(y))return!1;const h=p(u)?y:u;return!(i.ProcessDiagramUtils.isDataElement(h)||i.ProcessDiagramUtils.isAnnotationElement(h)||h.parent.id===t.id)})}postExecute(e){const t=this.getConnectionsToRemove(e);super.postExecute(e),this.changeType(e),this.modeling.removeElements(t),this.splitConnectionHelper.splitConnection({connection:e.targetConnection,shapes:e.shapes,modeling:this.modeling})}};ce=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__param)(1,(0,a.Inject)("elementRegistry")),(0,o.__param)(2,(0,a.Inject)("canvas")),(0,o.__param)(3,(0,a.Inject)("splitConnectionHelper")),(0,o.__param)(4,(0,a.Inject)("groups")),(0,o.__param)(5,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,z,i.ProcessDiagramGroups,a.DiagramUtils])],ce);var on=f(39229);let W=class extends on.Z{constructor(e){super(e),this.modeling=e}fixDockingPointPadding(e){const{newTarget:t,newSource:n,dockingOrPoints:s,hints:r}=e;if(!r)return;let l;switch(r.docking){case"target":l=t;break;case"source":l=n;break;default:return}const p=x.isArray(s)?s[s.length-1]:s,g=1;l.x>=p.x?p.x=l.x+g:p.x>=l.x+l.width&&(p.x=l.x+l.width-g),l.y>=p.y?p.y=l.y+g:p.y>=l.y+l.height&&(p.y=l.y+l.height-g)}execute(e){const t=e.connection;e.oldType=t.type;const n=e.hints;n&&n.docking==="target"?n.isUpdateConnectionType&&this.updateConnectionType(t.source,e.newTarget,t):this.updateConnectionType(e.newSource,t.target,t),this.fixDockingPointPadding(e),super.execute(e)}createFeatureContext(){return this.modeling.createFeatureContext()}updateConnectionType(e,t,n){}};(0,o.__decorate)([(0,a.featureImplementation)(ae),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object,Object]),(0,o.__metadata)("design:returntype",void 0)],W.prototype,"updateConnectionType",null),W=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__metadata)("design:paramtypes",[Object])],W);var cn=f(77010);let le=class extends cn.Z{constructor(e,t){super(e),this.modeling=e,this.diagramUtils=t,this._helper=new a.DiagramMoveHelper(e),this.convertUtils=new a.ProcessConvertUtils(t)}execute(e){const t=super.execute(e),n=e.oldBounds;return n.rx=t.rx,n.ry=t.ry,this.convertUtils.setRelativePosition(t),t}postExecute(e){const t=e.shape,n=e.hints;n&&n.externalUpdate||(super.postExecute(e),i.ProcessDiagramUtils.isEventSubProcessExpanded(t)&&(this.modeling.recalculateChildrenPosition(t),this.modeling.recalculateConnection(t)))}};le=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__param)(1,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object])],le);class dt{preExecute(e,t){const n=t.element,s=e.modeling;s.removeElementChildren(n),s.updateLabel(n,n.caption)}}class ke{preExecute(e,t){}}(0,o.__decorate)([(0,a.featureImplementationExtension)(ln,dt),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object]),(0,o.__metadata)("design:returntype",void 0)],ke.prototype,"preExecute",null);function ln(c,e){return Pe(e)}var dn=f(91499);let G=class{constructor(e,t,n,s,r,l){this.modeling=e,this.rules=t,this.eventBus=n,this.elementRegistry=s,this.elementSizeUtils=r,this.elements=l}_removeUnsupportedMarkers(e,t){const n=i.ProcessDiagramUtils.getMarkerGroupsForElement({type:t},this.elements);Object.keys(e).forEach(s=>{n.find(r=>r.type===s)||delete e[s]})}isChangingType(e){return(e.oldType||e.element.type)!==e.type||e.oldUserTaskType!==e.userTaskType}isChangingExpandedState(e){const t=Pe(e),n=_(e);return t!==n&&(t||n)}removeNotAllowedConnections(e){const t=e.incoming.filter(r=>!this.rules.allowed("connection.reconnect",{source:r.source,target:e,connection:r})),n=e.outgoing.filter(r=>!this.rules.allowed("connection.reconnect",{source:e,target:r.target,connection:r})),s=t.concat(n);x.each(s,r=>this.modeling.removeConnection(r))}updateElementSize(e){const t=e.element;let n;_(e)?n=this.elementSizeUtils.getElementMaxSize(t,this.elementRegistry.getAll()):n=this.elementSizeUtils.getDefaultSize(t.type),t.width=n.width,t.height=n.height}updateConnectionType(e){e.outgoing.forEach(n=>{const s=Ce(e,n.type);s&&n.type!==s&&this.modeling.updateConnection(n.id,{type:s})})}createFeatureContext(){return{modeling:this.modeling}}preExecute(e){const{element:t,type:n,markers:s,documentation:r,userTaskType:l}=e;e.oldMarkers=x.cloneDeep(t.markers),e.oldDocumentation=x.cloneDeep(t.documentation),e.oldType=t.type,e.oldUserTaskType=t.userTaskType,e.oldBounds=x.pick(t,["width","height"]),s&&this.isChangingType(e)&&this._removeUnsupportedMarkers(t.markers,n),t.type=n,t.userTaskType=l,t.markers=s,t.documentation=r,this.isChangingType(e)&&this.isChangingExpandedState(e)&&this.updateElementSize(e),this.removeNotAllowedConnections(t)}postExecute(e){const t=this.modeling,n=e.element;this.modeling.recalculateConnection(n),this.eventBus.fire(a.Handlers.element.updated,n),_(e)&&!e.externalUpdate&&(t.removeElementChildren(n),t.createStartEventSignal(n)),this.isChangingType(e)&&(this.updateConnectionType(n),this.eventBus.fire(a.Handlers.element.typeUpdated,n))}execute(e){if(this.isChangingType(e)){const t=e.element,n=e.parentIndex,s=e.newParent||t.parent;(0,dn.IH)(s.children,t,n)}return e.element}revert(e){return e.element}};(0,o.__decorate)([(0,a.featureImplementation)(ke,a.FeatureExecutionOrder.after),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype",void 0)],G.prototype,"preExecute",null),G=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__param)(1,(0,a.Inject)("rules")),(0,o.__param)(2,(0,a.Inject)("eventBus")),(0,o.__param)(3,(0,a.Inject)("elementRegistry")),(0,o.__param)(4,(0,a.Inject)("elementSizeUtils")),(0,o.__param)(5,(0,a.Inject)("elements")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,i.ProcessElements])],G);let de=class{constructor(e,t,n,s){this.modeling=e,this.spaceTool=t,this.elementRegistry=n,this.elements=s}_tryAddFirstLane(e,t,n){if(!e.length){const s=this.elements.items.lane.headerWidth,r=this.modeling.createShape({type:i.ProcessElementType.lane},{height:t.height,width:t.width-s,x:t.x+s,y:t.y},n);return(0,P.toArray)(n.children).map(p=>p).forEach(p=>{p!==r&&this.modeling.moveShape(p,{x:0,y:0},r)}),r}}_createLane(e,t,n,s){const r=this.elements.items.lane.headerWidth;return this.modeling.createShape({type:i.ProcessElementType.lane},{height:Math.abs(n),width:e.type===i.ProcessElementType.laneSet?e.width-r:e.width,x:e.type===i.ProcessElementType.laneSet?e.x+r:e.x,y:t},s)}_getAdjustments(e){let t=e.lane;const s=new i.ProcessDiagramUtils().getPool(t),r=i.ProcessDiagramUtils.getChildLanes(s);t=this._tryAddFirstLane(r,t,s)||t;const l=e.yOffset,g=t===s?s:t.parent,m=i.ProcessDiagramUtils.getMovableElements(this.elementRegistry.getAllElements()),u=t.y,y=u+t.height,h=l<0?u-Math.abs(l):y,E=l>=0,S=E?y-10:u+10,k=E?Math.abs(l):-Math.abs(l),$=(0,ve.PB)(t,!1),F=x.difference(m,$);this._createLane(t,h,l,g);const O=this.spaceTool.calculateAdjustments(F,"y",k,S);return O.resizingShapes.includes(s)||O.resizingShapes.push(s),O.pool=s,O}_recalcRelativePosition(e){const t=e.children.slice();x.forEach(t,n=>{this.modeling.moveShape(n,{x:0,y:0})})}preExecute(e){const t=this._getAdjustments(e),n=e.yOffset,s=n<0?"n":"s",r={x:0,y:n};return this.spaceTool.makeSpace([],t.resizingShapes,r,s),s==="n"&&this._recalcRelativePosition(t.pool),this.spaceTool.makeSpace(t.movingShapes,[],r,s),!1}};de=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__param)(1,(0,a.Inject)("spaceTool")),(0,o.__param)(2,(0,a.Inject)("elementRegistry")),(0,o.__param)(3,(0,a.Inject)("elements")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,i.ProcessElements])],de);let pe=class extends J.Z{constructor(e,t,n,s,r){super(e),this.modeling=t,this.spaceTool=n,this.elementRegistry=s,this.elements=r,e.on("resize.start",a.EventPriority.MAX,this._resizeStart.bind(this)),e.on("resize.end",a.EventPriority.MAX,this._resizeEnd.bind(this))}_resizeStart(e){if(i.ProcessDiagramUtils.isParticipants(e.shape)){const t=e.context,n=t.shape,{h:s,v:r}=this.getParseDirection(t.direction),p=new i.ProcessDiagramUtils().getPool(n),g=this._setMinResizeBox(e,p),m=this._findFirstInsideLane(n,r),u=this._getHeaderOffset(p,m,n);m&&this._setMinResizeBox(e,m),t.minBounds.x=s==="e"?n.x:g.x-u.x,t.minBounds.y=r==="s"?n.y:t.minBounds.y,t.minBounds.width=Math.max(g.width-u.width,this.elements.items.lane.minWidth+u.x)}}_getHeaderOffset(e,t,n){const s=this.elements.items.lane.headerWidth;let r;if(t){const l=this._getMaxNestingLevel(e),p=this._getNestingLevel(t,e);r={x:s*(l-p+1)-(n.x-t.x),width:s*p-(n.width-t.width)}}else r={x:s,width:0};return r}_getMaxNestingLevel(e){let t=0;return this._getAllLanes(e).forEach(s=>{const r=this._getNestingLevel(s,e);r>t&&(t=r)},this),t}_getNestingLevel(e,t){let n=1,s=e;for(;s.parent!==t;)s=s.parent,n++;return n}_getAllLanes(e){let t=[];return e.children.forEach(n=>{i.ProcessDiagramUtils.isLane(n)&&(t.push(n),t=t.concat(this._getAllLanes(n)))}),t}_setMinResizeBox(e,t){const n=e.context,s=i.ProcessDiagramUtils.getParticipantMinResizeBox(t,n.direction,[],this.elements);return s.height=t.y-n.shape.y+s.height,e.context.minBounds=s,s}_findFirstInsideLane(e,t){const n=e.children.filter(s=>i.ProcessDiagramUtils.isLane(s));if(n.length>0){const s=t==="n"?n.find(r=>r.y-10<e.y):n.find(r=>r.y+r.height+10>e.y+e.height);return this._findFirstInsideLane(s,t)}else return i.ProcessDiagramUtils.isLane(e)?e:null}_resizeEnd(e){i.ProcessDiagramUtils.isParticipants(e.shape)&&this.modeling.resizeLane(e.context)}_resizeDelta(e,t,n){return{x:n.h==="w"?(t.width-e.width)*-1:t.width-e.width,y:n.v==="n"?(t.height-e.height)*-1:t.height-e.height}}getParseDirection(e){let t="e",n="n";return e==="e"||e==="w"?t=e:e==="n"||e==="s"?n=e:(n=e[0],t=e[1]),{v:n,h:t}}preExecute(){}execute(){}postExecute(e){const t=e.newBounds,n=e.shape,{h:s,v:r}=this.getParseDirection(e.direction);if(i.ProcessDiagramUtils.isParticipants(n)){const p=new i.ProcessDiagramUtils().getPool(n),g=i.ProcessDiagramUtils.getMovableElements(this.elementRegistry.getAllElements()),m=i.ProcessDiagramUtils.getSelfAndAllChildren(p),u=this._resizeDelta(n,t,{v:r,h:s}),y=u.x,h=u.y,E=t.width-n.width,S=t.height-n.height,k=n.x+n.width,$=n.y+n.height,F=(r==="s"?1:-1)*Math.abs(h),O=(s==="e"?1:-1)*Math.abs(y),Xt=i.ProcessDiagramUtils.selfAndAllLanes(p),Yt=r==="s"?$-10:n.y+10,kn=s==="e"?k-10:n.x+10,On=g.filter(C=>i.ProcessDiagramUtils.isLaneSet(C));if(S>0){const C=this.spaceTool.calculateAdjustments(g,"y",F,Yt);this.spaceTool.makeSpace(C.movingShapes,C.resizingShapes,{x:0,y:h},r)}else{const C=this.spaceTool.calculateAdjustments(m,"y",F,Yt);this.spaceTool.makeSpace(C.movingShapes,C.resizingShapes,{x:0,y:h},r)}if(this.spaceTool.makeSpace([],Xt,{x:y,y:0},s),E>0){const C=g.filter(An=>!Xt.some(Ln=>Ln===An)),Kt=this.spaceTool.calculateAdjustments(C,"x",O,kn);this.spaceTool.makeSpace(Kt.movingShapes,Kt.resizingShapes,{x:y,y:0},s)}return On.forEach(C=>this.modeling.recalculateChildrenPosition(C)),!1}}};pe=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("modeling")),(0,o.__param)(2,(0,a.Inject)("spaceTool")),(0,o.__param)(3,(0,a.Inject)("elementRegistry")),(0,o.__param)(4,(0,a.Inject)("elements")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,i.ProcessElements])],pe);let ge=class{constructor(e,t,n,s){this.modeling=e,this.spaceTool=t,this.elementRegistry=n,this.elements=s}createLane(e,t){return this.modeling.createShape({type:i.ProcessElementType.lane},e,t)}makeMinWidthSpace(e){const t=e.width-this.elements.items.lane.minWidth;if(t>0)return;const n=e.x+this.elements.items.lane.headerWidth+10,s=Math.abs(t)+this.elements.items.lane.headerWidth,r=i.ProcessDiagramUtils.getMovableElements(this.elementRegistry.getAllElements()),l=this.spaceTool.calculateAdjustments(r,"x",s,n);this.spaceTool.makeSpace(l.movingShapes,l.resizingShapes,{x:s,y:0},"e")}preExecute(e){const t=e.lane,n=this.elements.items.lane.headerWidth,s=i.ProcessDiagramUtils.getAllChildren(t),r=x.difference(i.ProcessDiagramUtils.getMovableElements(this.elementRegistry.getAllElements()),s),l=this.elements.items.lane.height,p=this.spaceTool.calculateAdjustments(r,"y",l,t.y+10);this.spaceTool.makeSpace(p.movingShapes,p.resizingShapes,{x:0,y:l},"s");const g=e.newLane=this.createLane({height:t.height-l,width:t.width-n,x:t.x+n,y:t.y},t);this.createLane({height:l,width:t.width-n,x:t.x+n,y:t.y+t.height-l},t),this.makeMinWidthSpace(g),s.forEach(m=>{this.modeling.moveShape(m,{x:0,y:0},g)})}};ge=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__param)(1,(0,a.Inject)("spaceTool")),(0,o.__param)(2,(0,a.Inject)("elementRegistry")),(0,o.__param)(3,(0,a.Inject)("elements")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,i.ProcessElements])],ge);let me=class extends a.DiagramCreateElementsHandler{constructor(e,t,n,s,r,l){super(e,t),this.modeling=e,this.canvas=t,this.elementRegistry=n,this.splitConnectionHelper=s,this.elements=r,this.diagramUtils=l}postExecuteEventSubProcess(e){e.forEach(t=>{t.type===i.ProcessElementType.eventSubProcessExpanded&&(e.find(s=>i.ProcessDiagramUtils.isStartEvent(s)&&s.parent===t)||this.modeling.createStartEventSignal(t))})}getParent(e,t){const n=this.canvas.getRootElement();if(i.ProcessDiagramUtils.isLaneSet(e))return n;let s=super.getParent(e,t);const r=t.elements;if(this.diagramUtils.isOrphanElement(e)&&r.length>1||this.diagramUtils.isFlow(s)){const l=this.diagramUtils.getAllContainers(this.elementRegistry.getAllElements());s=this.diagramUtils.findRealElementParent({x:e.x,y:e.y},l,n)}return s}preExecute(e){const t=e.parent;t&&this.diagramUtils.isFlow(t)&&(e.targetConnection=t),super.preExecute(e)}postExecute(e){this.postExecuteEventSubProcess(e.elements),this.splitConnectionHelper.splitConnection({connection:e.targetConnection,shapes:e.elements,modeling:this.modeling})}};me=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("modeling")),(0,o.__param)(1,(0,a.Inject)("canvas")),(0,o.__param)(2,(0,a.Inject)("elementRegistry")),(0,o.__param)(3,(0,a.Inject)("splitConnectionHelper")),(0,o.__param)(4,(0,a.Inject)("elements")),(0,o.__param)(5,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,z,i.ProcessElements,i.ProcessDiagramUtils])],me);class pt extends a.CommonDiagramDeleteShapeHandler{isDiagramFlow(e){return new i.ProcessDiagramUtils().isFlow(e)}}var b=f(66270);class gt extends a.DiagramShapeOutline{updateOutline(e,t){const n=t.previewHeight||t.height,s=this.config.offset;(0,b.Lj)(e,{x:-s,y:-s,width:t.width+s*2,height:n+s*2})}}class mt extends a.DiagramCircleOutline{}class ht extends a.DiagramRhombOutline{getDefaultHeight(){return this.config.elements.items.exclusiveGateway.height}}class ut extends a.DiagramElementOutline{}let N=class extends a.OutlineFactory{constructor(e,t,n,s){super(e,t,n,s),this.styles=e,this.rules=t,this.elements=n,this.diagramUtils=s}getOutline(e){switch(!0){case i.ProcessDiagramUtils.isEventElement(e):return new mt(this.config);case i.ProcessDiagramUtils.isParticipants(e):case i.ProcessDiagramUtils.isDataElement(e):case i.ProcessDiagramUtils.isTaskElement(e):return new ut(this.config);case i.ProcessDiagramUtils.isGateway(e):return new ht(this.config);case i.ProcessDiagramUtils.isAnnotationElement(e):return new gt(this.config);case this.diagramUtils.isConnection(e):return new a.DiagramConnectionOutline(this.config);default:return super.getOutline(e)}}};N=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("styles")),(0,o.__param)(1,(0,a.Inject)("rules")),(0,o.__param)(2,(0,a.Inject)("elements")),(0,o.__param)(3,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,a.DiagramElements,a.DiagramUtils])],N);class yt extends a.DiagramElementOutline{constructor(){super(...arguments),this.outlineRX=6.5}getCreateOutlineConfig(){const e=super.getCreateOutlineConfig();return x.assign(e,{rx:this.outlineRX})}}class ft extends N{getConfig(){const e="djs-validate-outline",t={...this.styles.cls(e,["no-fill"],null),stroke:"#EB3800",strokeWidth:"2px"};return{outlineClassName:e,outlineStyle:t,offset:5,elements:this.elements.items,rules:this.rules}}getOutline(e){return i.ProcessDiagramUtils.isTaskElement(e)?new yt(this.config):super.getOutline(e)}}class xt extends a.DiagramCopyPaste{init(){super.init(),this.copyProperties=[...this.copyProperties,"documentation","markers","userTaskType"]}}class Et extends a.DiagramLoader{getConnectionAttributes(e,t){return{...super.getConnectionAttributes(e,t),order:this.elements.items.connection.order}}}let he=class{constructor(e){this.config=e}getMarkers(){const e=this.config&&this.config.customMarkers||{};return x.merge(i.Markers,e)}};he=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("config")),(0,o.__metadata)("design:paramtypes",[Object])],he);let B=class extends a.DiagramModeling{constructor(e,t,n,s,r,l,p,g,m,u){super(e,t,n,s,r,l,p,g,u),this.elements=p,this.rules=g,this.diagramGroups=m,this.diagramUtils=u}fixPosition(e,t){for(const n in e)if(e.hasOwnProperty(n)){const r=e[n].filter(l=>i.ProcessDiagramUtils.isLabel(l));if(r.length===1){const l=r[0];t.x>=l.x&&t.x<=l.x+l.width&&t.y>=l.y&&t.y<=l.y+l.height&&(t.x=Math.round(l.x-l.delta.x+l.width/2),t.y=Math.round(l.y-l.delta.y+l.height/2))}}}elementMoveShape(e,t,n=null){const s=n||e.parent;this.moveShape(e,t,s,{layout:!1,recalcShapePosition:!0},null)}addLaneHandlers(e){e[a.Handlers.lane.split]=ge,e[a.Handlers.lane.create]=de,e[a.Handlers.lane.resize]=pe}addProcessShapeHandlers(e){e[a.Handlers.shape.shapeCreate]=re,e[a.Handlers.shape.shapeMove]=oe,e[a.Handlers.shape.shapeResize]=le,e[a.Handlers.shape.shapeDelete]=pt}addElementsHandlers(e){super.addElementsHandlers(e),e[a.Handlers.elements.create]=me,e[a.Handlers.elements.move]=ce}addProcessElementHandlers(e){e[a.Handlers.element.update]=G,e[a.Handlers.element.updateLabel]=ne}addConnectionHandlers(e){e[a.Handlers.connection.update]=lt,e[a.Handlers.connection.reconnect]=W,e[a.Handlers.connection.changeDirection]=ct}needResetLabelPosition(e,t){return x.isUndefined(e.x)||x.isUndefined(e.y)||i.ProcessDiagramUtils.isTaskElement(t)&&i.ProcessDiagramUtils.isIntersect(t,e)}getFixedLabelPosition(e,t,n){return this.diagramUtils.isConnection(n)?e:super.getFixedLabelPosition(e,t,n)}getHandlers(){const e=super.getHandlers();return this.addLaneHandlers(e),this.addProcessShapeHandlers(e),this.addProcessElementHandlers(e),this.addConnectionHandlers(e),e}connect(e,t,n,s){if(!(e&&t)||t.type===i.ProcessElementType.boundaryInterruptingEventSignal&&t.parent===e)return;const r=this.canvas.getRootElement();return n=n||{},n.type||this.updateConnectionType(e,t,n),this.createConnection(e,t,n,r,s)}createShape(e,t,n,s=null,r=null){return super.createShape(e,t,n,s,r)}updateConnectionType(e,t,n){}pasteElements(e,t,n){this.fixPosition(e,n),super.pasteElements(e,t,n)}updateConnection(e,t){const n=this.getElement(e);if(n){const s={type:n.type,documentation:n.documentation,connection:n},r=Object.assign(s,t);this.commandStack.execute(a.Handlers.connection.update,r)}}updateElement(e,t){const n=this.getElement(e),s={type:n.type,markers:n.markers,documentation:n.documentation,element:n};if(n){const r=Object.assign(s,t);this.commandStack.execute(a.Handlers.element.update,r)}}externalUpdateElement(e,t){const n=Object.assign({externalUpdate:!0},t);this.updateElement(e,n)}updateElementType({id:e,config:t,force:n=!1}){(n||this.rules.allowed(a.Handlers.element.canUpdateType,{id:e,config:t}))&&this.updateElement(e,t)}addLane(e,t){this.commandStack.execute(a.Handlers.lane.create,{lane:e,yOffset:t})}splitLane(e){this.commandStack.execute(a.Handlers.lane.split,{lane:e})}resizeLane(e){this.commandStack.execute(a.Handlers.lane.resize,e)}changeConnectionDirection(e){this.commandStack.execute(a.Handlers.connection.changeDirection,{connection:e})}createFeatureContext(){return{canvas:this.canvas,elementRegistry:this.registry,diagramGroups:this.diagramGroups,elements:this.elements}}externalResizeShape(e){const t=this.registry.get(e.id);if(t){this.convertUtils.setShapeAbsolutePosition(t);const{height:n,width:s,x:r,y:l}=t,p={height:n,width:s,x:r,y:l,[e.name]:e.value};super.resizeShape(t,p,{height:0,width:0},{externalUpdate:!0})}}externalMoveShape(e){const t=this.registry.get(e.id);if(t){const n=e.name;this.convertUtils.setShapeAbsolutePosition(t);const s={x:Math.round(n==="rx"?e.value-t[n]:0),y:Math.round(n==="ry"?e.value-t[n]:0)};this.elementMoveShape(t,s)}}externalUpdateWaypoints(e,t){super.updateWaypoints(e,t,{doUpdateLabelPosition:!1})}externalReconnectStart(e,t){this.reconnectStart(e,t,null,{doUpdateLabelPosition:!0,layoutConnection:!1})}externalReconnectEnd(e,t){this.reconnectEnd(e,t,null,{layoutConnection:!1})}reconnectStart(e,t,n,s={}){super.reconnectStart(e,t,n,s)}reconnectEnd(e,t,n,s={}){super.reconnectEnd(e,t,n,s)}updateParent(e){const t=this.registry,n=t.get(e.id),s=t.get(e.value);n&&s&&this.elementMoveShape(n,{x:0,y:0},s)}externalCreateConnection(e){const t=this.registry.get(e.value.source),n=this.registry.get(e.value.target);if(t&&n){const{source:s,target:r,...l}=e.value;this.connect(t,n,l,{})}}createDiagramElement(e,t){if(this.registry.get(e))return;const n=x.cloneDeep(t[e]),s=this.elements.items.root,{markers:r,parent:l=s.id,caption:p,documentation:g,userTaskType:m}=n,u=n.type!==i.Bpmn2Names.subProcess?n.type:i.ProcessDiagramUtils.getSubProcessType(n);let y=this.registry.get(l);y||(this.createDiagramElement(l,t),y=this.registry.get(l)),this.convertUtils.setShapeAbsolutePosition(n,y);const h=this.elements.getConfig(n);if(!h){console.warn(`Draw config for element type ${n.type} not found`);return}const E=n.width||h.width,S=n.height||h.height,k=n.itemName,$=h.order,F={id:e,type:u,userTaskType:m,width:E,itemName:k,height:S,order:$,markers:r,caption:p&&p.toString(),documentation:g&&g.toString(),tooltip:n.tooltip,tooltipConfig:n.tooltipConfig},O=this.getElementPosition(n,h);this.createShape(F,O,y,0,{generateUniqueCaption:!1})}externalRemoveShape(e){const t=this.registry.get(e.id);t&&(i.ProcessDiagramUtils.isLabel(t)&&!i.ProcessDiagramUtils.isEventSubProcessExpanded(t.labelTarget)&&(t.labelTarget.caption=""),super.removeShape(t,{layout:!1}))}recalculateChildrenPosition(e){e.children.slice().forEach(n=>{this.elementMoveShape(n,{x:0,y:0}),this.recalculateChildrenPosition(n)})}recalculateConnection(e){x.each(e.incoming,t=>{this.layoutConnection(t,{endChanged:!0})}),x.each(e.outgoing,t=>{this.layoutConnection(t,{startChanged:!0})})}createStartEventSignal(e){const t=this.elements.items.eventSubProcessExpanded.startEvent,{height:n,width:s}=this.elements.items[t],r={x:Math.round(e.x+20),y:Math.round(e.y+(e.height-n)/2),width:s,height:n};this.createShape({type:t},r,e)}};(0,o.__decorate)([(0,a.featureImplementation)(Ue),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object]),(0,o.__metadata)("design:returntype",void 0)],B.prototype,"createShape",null),(0,o.__decorate)([(0,a.featureImplementation)(ae),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object,Object]),(0,o.__metadata)("design:returntype",void 0)],B.prototype,"updateConnectionType",null),B=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("elementFactory")),(0,o.__param)(2,(0,a.Inject)("commandStack")),(0,o.__param)(3,(0,a.Inject)("canvas")),(0,o.__param)(4,(0,a.Inject)("elementRegistry")),(0,o.__param)(5,(0,a.Inject)("diagramText")),(0,o.__param)(6,(0,a.Inject)("elements")),(0,o.__param)(7,(0,a.Inject)("rules")),(0,o.__param)(8,(0,a.Inject)("groups")),(0,o.__param)(9,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,i.ProcessElements,Object,i.ProcessDiagramGroups,a.DiagramUtils])],B);let T=class extends a.BaseDiagramRules{constructor(e,t,n,s,r,l){super(e,r),this.eventBus=e,this.elementRegistry=t,this.diagramGroups=n,this.elements=s,this.canElementMoveFactory=l}canConnectTo(e){return![this.elements.items.root.type,this.elements.items.label.type,...this.diagramGroups.groups.participants.elements,...this.diagramGroups.groups.flow.elements,...this.diagramGroups.groups.association.elements].includes(e.type)}_getCopyRootElement(e,t){return e&&t.includes(e.parent)?this._getCopyRootElement(e.parent,t):e}_isConnectToParent(e,t){return e.parent===t||e===t.parent}_canConnectToStartEvent(e){return!e||!i.ProcessDiagramUtils.isStartEvent(e)}canConnectToEndEvent(e,t){return!i.ProcessDiagramUtils.isEndEvent(e)||i.ProcessDiagramUtils.isEndEvent(e)&&i.ProcessDiagramUtils.isAnnotationElement(t)}_canConnectToAnnotation(e,t){return!e||!t||!(i.ProcessDiagramUtils.isAnnotationElement(t)&&i.ProcessDiagramUtils.isAnnotationElement(e))}_canCreateAssociation(e){return i.ProcessDiagramUtils.isAnnotationElement(e)||i.ProcessDiagramUtils.isDataElement(e)}canConnectToParticipants(e,t){return!i.ProcessDiagramUtils.isParticipants(t)&&!i.ProcessDiagramUtils.isParticipants(e)}_canConnectToEventSubProcess(e,t,n={targetParent:null}){if(!e||!t||this._canCreateAssociation(e)||this._canCreateAssociation(t))return!0;if(i.ProcessDiagramUtils.isEventSubProcessExpanded(e)&&i.ProcessDiagramUtils.isEventSubProcessExpanded(t))return!1;const s=i.ProcessDiagramUtils.isBoundaryEvent(e)?e.parent.parent:e.parent,r=n.targetParent;return r&&(i.ProcessDiagramUtils.isEventSubProcessExpanded(s)&&!i.ProcessDiagramUtils.isEventSubProcessExpanded(r)||!i.ProcessDiagramUtils.isEventSubProcessExpanded(s)&&i.ProcessDiagramUtils.isEventSubProcessExpanded(r))?!1:!i.ProcessDiagramUtils.isEventSubProcessExpanded(e)&&!i.ProcessDiagramUtils.isEventSubProcessExpanded(t)?!s||!t.parent||!i.ProcessDiagramUtils.isEventSubProcessExpanded(s)&&!i.ProcessDiagramUtils.isEventSubProcessExpanded(t.parent)?!0:s.id===t.parent.id:!1}_canConnectToDataObject(e,t){return!((i.ProcessDiagramUtils.isDataElement(e)||i.ProcessDiagramUtils.isDataElement(t))&&(i.ProcessDiagramUtils.isGateway(e)||i.ProcessDiagramUtils.isGateway(t)||i.ProcessDiagramUtils.isEventElement(e)||i.ProcessDiagramUtils.isEventElement(t))||i.ProcessDiagramUtils.isDataElement(e)&&i.ProcessDiagramUtils.isDataElement(t))}canDeleteElement(e,t){return!(e.parent&&i.ProcessDiagramUtils.isEventSubProcessExpanded(e.parent)&&i.ProcessDiagramUtils.isStartEvent(e)&&!t.find(n=>n===e.parent))}init(){super.init(),super.addRule("canElementDock",this.canElementDock.bind(this))}canConnectionCreate(e){const t=e.source,n=e.target;return super.canConnectionCreate(e)&&t!==n&&!this._isConnectToParent(t,n)&&this.canConnectToParticipants(t,n)&&this.canConnectTo(n)&&this.canConnectTo(t)&&this._canConnectToAnnotation(t,n)&&this._canConnectToDataObject(t,n)&&this._canConnectToEventSubProcess(t,n,e.hints)&&this._canConnectToStartEvent(n)}canReconnectStart(e){const t=e.source,n=e.connection.target;return t!==n&&!this._isConnectToParent(t,n)&&this.canConnectTo(t)&&this.canConnectTo(n)&&this._canConnectToAnnotation(t,n)&&this._canConnectToDataObject(t,n)&&this._canConnectToEventSubProcess(t,n)&&this._canConnectToStartEvent(n)&&this.canConnectToEndEvent(t,n)}canReconnectEnd(e){const t=e.connection.source,n=e.target;return n!==t&&!this._isConnectToParent(t,n)&&this.canConnectTo(t)&&this.canConnectTo(n)&&this._canConnectToAnnotation(t,n)&&this._canConnectToDataObject(t,n)&&this._canConnectToEventSubProcess(t,n)&&this._canConnectToStartEvent(n)}canElementMove(e){const t=new z,n={delta:e.delta,position:e.position,shape:null,shapes:e.shapes||e.elements||[e.shape],target:e.target,splitConnectionHelper:t};return n.shapes.every(r=>(n.shape=r,this.canElementMoveFactory.getFeature(n,this.elementRegistry).canMove()))}canElementResize(e){return i.ProcessDiagramUtils.isContainer(e.shape)||i.ProcessDiagramUtils.isAnnotationElement(e.shape)}canElementCopy(e){const t=this._getCopyRootElement(e.element,e.elements);return!i.ProcessDiagramUtils.isLane(t)}canElementsDelete(e){const t=e.elements;return t.every(n=>this.canDeleteElement(n,t))}canElementDock(e){const t=e.target,n=e.shape;return Boolean(t&&i.ProcessDiagramUtils.isTaskElement(t)&&!i.ProcessDiagramUtils.isEventSubProcessExpanded(t)&&(n.type===i.ProcessElementType.intermediateThrowEvent&&n.parent===void 0||i.ProcessDiagramUtils.isBoundaryEvent(n)))}};(0,o.__decorate)([(0,a.ifNotReadonly)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype",void 0)],T.prototype,"canConnectionCreate",null),(0,o.__decorate)([(0,a.ifNotReadonly)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype",void 0)],T.prototype,"canReconnectStart",null),(0,o.__decorate)([(0,a.ifNotReadonly)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype",void 0)],T.prototype,"canReconnectEnd",null),(0,o.__decorate)([(0,a.ifNotReadonly)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype",void 0)],T.prototype,"canElementMove",null),(0,o.__decorate)([(0,a.ifNotReadonly)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype",void 0)],T.prototype,"canElementResize",null),(0,o.__decorate)([(0,a.ifNotReadonly)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype",void 0)],T.prototype,"canElementCopy",null),(0,o.__decorate)([(0,a.ifNotReadonly)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object]),(0,o.__metadata)("design:returntype",Boolean)],T.prototype,"canElementsDelete",null),T=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("elementRegistry")),(0,o.__param)(2,(0,a.Inject)("groups")),(0,o.__param)(3,(0,a.Inject)("elements")),(0,o.__param)(4,(0,a.Inject)("config")),(0,o.__param)(5,(0,a.Inject)("canElementMoveFactory")),(0,o.__metadata)("design:paramtypes",[Object,Object,i.ProcessDiagramGroups,i.ProcessElements,Object,Object])],T);const pn="assets/images/icon_tools_task.svg",gn="assets/images/icon_tools_gateway.svg",mn="assets/images/icon_tools_end_event.svg",hn="assets/images/icon_tools_intermediate_event.svg";let ue=class extends a.DiagramElementToolsConfig{constructor(e,t){super(e,t),this.elements=e,this.config=t}getAddItems(){const e=[{image:pn,type:i.ProcessElementType.task},{image:hn,type:i.ProcessElementType.intermediateThrowEvent},{image:gn,type:i.ProcessElementType.exclusiveGateway},{image:mn,type:i.ProcessElementType.endEvent}];return e.forEach(t=>{const n=this.elements.getConfig(t);n&&(t.title=this.config.localizableStrings.get(n.caption))}),[...super.getAddItems(),...e]}};ue=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("elements")),(0,o.__param)(1,(0,a.Inject)("config")),(0,o.__metadata)("design:paramtypes",[i.ProcessElements,Object])],ue),(0,P.ngxTranslateExtract)("diagram.paletteProvider.flow"),(0,P.ngxTranslateExtract)("diagram.paletteProvider.artefacts"),(0,P.ngxTranslateExtract)("diagram.paletteProvider.lassoTool"),(0,P.ngxTranslateExtract)("diagram.paletteProvider.spaceTool");class jt extends a.DiagramPaletteProvider{init(){super.init(),this.featureProvider.getFeatureServiceValues(e=>{this.featureSubProcessExpanded=e.featureSubProcessExpanded,this.featureSubProcessExpanded&&this.canvas.getContainer()&&this.palette._update()})}getCreateMenuEntries(e){const t=super.getCreateMenuEntries(e);if(!this.featureSubProcessExpanded){const n=t.findIndex(s=>s.id===i.ProcessElementType.subProcessExpanded);t.splice(n,1)}return t}getPaletteEntries(){const e=super.getPaletteEntries();return this.featureSubProcessExpanded||delete e["create-subProcessExpanded"],e}}(0,P.ngxTranslateExtract)("diagram.replaceMenuProvider.reverseDirection");let ye=class extends a.ReplaceMenuProvider{constructor(e,t,n,s,r,l,p){super(e),this.popupMenu=e,this.modeling=t,this.config=n,this.featureProvider=s,this.diagramGroups=r,this.elements=l,this.diagramUtils=p,this.featureSubProcessExpanded=!1,this.localizableStrings=n.localizableStrings,s.getFeatureServiceValues(g=>{this.featureSubProcessExpanded=g.featureSubProcessExpanded})}addEntry(e,t,n){n.forEach(s=>{if(s.type===i.ProcessElementType.subProcessExpanded&&!this.featureSubProcessExpanded||s.showInReplaceMenu===!1)return;const r=this.getEntryConfig(s,t);e[r.id]=r})}replaceAction(e,t){const{userTaskType:n,markers:s}=t;let{type:r}=t;e.waypoints?(r===i.ProcessElementType.defaultConnection&&this.removeDefaultConnection(e.source),this.modeling.updateConnection(e,{type:r})):(i.ProcessDiagramUtils.isEventSubProcessExpanded(e.parent)&&r===i.ProcessElementType.intermediateThrowEvent&&(r=i.ProcessElementType.intermediateThrowEventSignal),this.modeling.updateElementType({id:e.id,config:{type:r,markers:s,userTaskType:n}})),this.popupMenu.close()}getGroupTypesExceptElement(e,t){let n;switch(!0){case e==="intermediateThrowEvent":case e==="intermediateCatchEvent":n=[...this.diagramGroups.groups.intermediateThrowEvent.elements,...this.diagramGroups.groups.intermediateCatchEvent.elements];break;default:n=[...this.diagramGroups.groups[e].elements];break}return this.diagramGroups.groups[e].canBeTransformed&&(n=[...this.diagramGroups.groups[e].canBeTransformed].concat(n)),n=this.filterAllowTypes(t,n),n=n.filter(s=>this.elements.items[s]!==void 0),n.map(s=>this.elements.items[s])}getFlowExcludeTypes(e){const t=[];return se(e.source)&&t.push(i.ProcessElementType.connection),ie(e.source)&&(t.push(i.ProcessElementType.defaultConnection),t.push(i.ProcessElementType.conditionalConnection)),t}filterAllowTypes(e,t){const n=this.getExcludeTypes(e);return t.filter(s=>!n.includes(s))}removeDefaultConnection(e){e.outgoing.forEach(t=>{if(t.type===i.ProcessElementType.defaultConnection){const n=Ce(e)||i.ProcessElementType.connection;this.modeling.updateConnection(t,{type:n})}})}updateMarkersAction(e,t,n){this.popupMenu.close();const s=e.type,r=x.clone(e.markers);e.markers[n]===t?delete r[n]:r[n]=t,this.replaceAction(e,{type:s,markers:r})}_isMarkerActive(e,t,n){return e.markers[n]===t}getMarkers(e){const t=[],n=i.ProcessDiagramUtils.getMarkerGroupsForElement(e,this.elements);return e.markers=e.markers||{},n.forEach(s=>{const r=s.type;s.markers.forEach(l=>{const p=l.type,g=this._isMarkerActive(e,p,r);t.push({action:this.updateMarkersAction.bind(this,e,p,r),id:p,imageUrl:g?l.selectedImage:l.largeImage,title:this.localizableStrings.get(l.caption),active:g})})}),t}addSpecialEntries(e,t){if(t.type===i.ProcessElementType.associationOneWay){const n={action:()=>{this.modeling.changeConnectionDirection(t)},id:"changeAssociationDirection",label:this.localizableStrings.get("replaceMenuProvider.reverseDirection"),imageUrl:"assets/images/Association/ReverseDirection.svg"};e[n.id]=n}}getElementGroup(e){const t=this.diagramGroups;return Object.keys(t.groups).find(n=>t.groups[n].elements&&t.groups[n].elements.includes(e))}getExcludeTypes(e){const n=[e.userTaskType||e.type];return i.ProcessDiagramUtils.isEventSubProcessExpanded(e.parent)?(n.push(e.parent.type),i.ProcessDiagramUtils.isStartEvent(e)&&n.push(i.ProcessElementType.startEvent,i.ProcessElementType.endEvent,i.ProcessElementType.intermediateThrowEvent),(i.ProcessDiagramUtils.isIntermediateThrowEvent(e)||i.ProcessDiagramUtils.isIntermediateCatchEvent(e))&&n.push(i.ProcessElementType.startEvent,i.ProcessElementType.intermediateThrowEvent),i.ProcessDiagramUtils.isEndEvent(e)&&n.push(i.ProcessElementType.startEvent)):n.push(...this.diagramGroups.eventSubProcess.startEvent.elements),n.concat(this.getFlowExcludeTypes(e))}getEntryConfig(e,t){const n=this.localizableStrings.get(e.caption),{userTaskType:s,type:r}=e,l=t.markers;return{action:()=>this.replaceAction(t,{type:r,userTaskType:s,markers:l}),id:e.userTaskType||e.type,imageUrl:e.smallImage,label:n}}getPopupMenuEntries(e){if(this.diagramUtils.isFlow(e)&&e.source&&i.ProcessDiagramUtils.isEventElement(e.source))return{};const t={},n=this.getElementGroup(e.type);if(n){const s=this.getGroupTypesExceptElement(n,e);this.addEntry(t,e,s)}return this.addSpecialEntries(t,e),t}getHeaderEntries(e){return this.getMarkers(e)}};ye=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("popupMenu")),(0,o.__param)(1,(0,a.Inject)("modeling")),(0,o.__param)(2,(0,a.Inject)("config")),(0,o.__param)(3,(0,a.Inject)("featureProvider")),(0,o.__param)(4,(0,a.Inject)("groups")),(0,o.__param)(5,(0,a.Inject)("elements")),(0,o.__param)(6,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,a.FeatureProvider,i.ProcessDiagramGroups,i.ProcessElements,a.DiagramUtils])],ye);function Pt(c,e,t){return t.type===i.ProcessElementType.connection}function vt(c,e,t){return t.type===i.ProcessElementType.conditionalConnection}function bt(c,e,t){return t.type===i.ProcessElementType.defaultConnection}function _t(c,e,t){return t.type===i.ProcessElementType.association}function St(c,e,t){return t.type===i.ProcessElementType.associationOneWay}function Dt(c,e,t){return t.type===i.ProcessElementType.associationTwoWay}var w;(function(c){c.Association="association",c.AssociationEndMarker="association-end-marker",c.AssociationOneWay="association-one-way",c.AssociationStartMarker="association-start-marker",c.AssociationTwoWay="association-two-way",c.ConditionalConnection="conditional-connection",c.Connection="connection",c.ConnectionEndMarker="connection-end-marker",c.DefaultConnection="default-connection"})(w||(w={}));const v={SequenceFlow:{Fill:"none",MarkerShape:"M-10,3 L1,0 L-10,-3",MarkerfillOpacity:1,StrokeLinejoin:"round",StrokeWidth:.9},Association:{Fill:"none",StrokeDasharray:"1, 5",StrokeLinecap:"round",StrokeLinejoin:"round",StrokeWidth:2,MarkerShape:"M-10,3 L1,0 L-10,-3"},DefaultConnection:{StartMarkerShape:"M-11,-3 L-6,3 Z"},ConditionalConnection:{StartMarkerShape:"M-10,0 L-5.5,3 L-1,0 L-5.5,-3 Z"}};class Oe extends a.DrawConnection{getConnectionAttributes(e){return{class:w.Association,fill:v.Association.Fill,stroke:a.Styles.connectionStrokeColor,strokeDasharray:v.Association.StrokeDasharray,strokeLinecap:v.Association.StrokeLinecap,strokeLinejoin:v.Association.StrokeLinejoin,strokeWidth:v.Association.StrokeWidth}}get endMarker(){return null}}class Ae extends Oe{getConnectionAttributes(e){const t=super.getConnectionAttributes(e);return t.class=w.AssociationOneWay,t}get endMarker(){const e=(0,b.Ue)("path");return(0,b.Lj)(e,{d:v.Association.MarkerShape,fill:v.Association.Fill,stroke:a.Styles.arrowStrokeColor,strokeLinejoin:v.Association.StrokeLinejoin,strokeWidth:v.Association.StrokeWidth,class:w.AssociationEndMarker}),e}}class Tt extends Ae{getConnectionAttributes(e){const t=super.getConnectionAttributes(e);return t.class=w.AssociationTwoWay,t}startMarker(){const e=(0,b.Ue)("path");return(0,b.Lj)(e,{d:v.Association.MarkerShape,fill:v.Association.Fill,stroke:a.Styles.arrowStrokeColor,strokeLinejoin:v.Association.StrokeLinejoin,strokeWidth:v.Association.StrokeWidth,class:w.AssociationStartMarker}),e}}class Ct extends a.DrawConnection{startMarker(e){const t=e.source;if(t&&[i.ProcessElementType.inclusiveGateway,i.ProcessElementType.exclusiveGateway].includes(t.type))return null;const n=(0,b.Ue)("path");return(0,b.Lj)(n,{d:"M-10,0 L-5.5,3 L-1,0 L-5.5,-3 Z",fill:a.Styles.connectionMarkerFillColor,stroke:a.Styles.connectionMarkerStrokeColor,strokeLinejoin:"round",strokeWidth:.9,class:w.ConditionalConnection}),n}}class wt extends a.DrawConnection{startMarker(){const e=(0,b.Ue)("path");return(0,b.Lj)(e,{d:v.DefaultConnection.StartMarkerShape,stroke:a.Styles.connectionMarkerStrokeColor,strokeLinejoin:v.SequenceFlow.StrokeLinejoin,strokeWidth:v.SequenceFlow.StrokeWidth,class:w.DefaultConnection}),e}}class Le{drawConnection(e,t,n){}}(0,o.__decorate)([(0,a.featureImplementationExtension)(Pt,a.DrawConnection),(0,a.featureImplementationExtension)(vt,Ct),(0,a.featureImplementationExtension)(bt,wt),(0,a.featureImplementationExtension)(_t,Oe),(0,a.featureImplementationExtension)(St,Ae),(0,a.featureImplementationExtension)(Dt,Tt),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object,Object]),(0,o.__metadata)("design:returntype",Object)],Le.prototype,"drawConnection",null);class Me extends a.DiagramRenderer{drawConnection(e,t){return super.drawConnection(e,t)}}(0,o.__decorate)([(0,a.featureImplementation)(Le,a.FeatureExecutionOrder.instead),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object]),(0,o.__metadata)("design:returntype",void 0)],Me.prototype,"drawConnection",null);class Ut extends a.RenderingBaseShape{getAnnotationShape(e){const t=(0,b.Ue)("path");return(0,b.Lj)(t,{d:`M16,5 H5,5 V5,${(e.previewHeight||e.height)-a.AnnotationBracketOffset} H16,5`,fill:"none",stroke:"#54657D",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1}),t.setAttributeNS(null,"type",e.type),t}draw(e,t){super.draw(e,t);const n=this.elements.getConfig(t);if(t.caption){const r=n.label,l={...this.diagramText.style,...r.editStyle},p={box:{height:t.height,width:t.width+3,x:t.x,y:t.y},...r.style,style:{...l}};this.createText(e,t.caption,p)}const s=this.getAnnotationShape(t);return(0,b.R3)(e,s),s}}var un=f(7824),yn=f(18872);class Ie extends a.RenderingBaseShape{draw(e,t){if(super.draw(e,t),t.caption){const s=this.elements.getConfig(t),r={box:{height:s.headerWidth,width:t.height},...s.label.style},l=this.createText(e,t.caption,r);(0,yn.vs)(l,0,t.height,270)}return this.drawRect(e,t.width,t.height,0,0,{fill:t.color||"none",stroke:"#BEBEBE"})}}class kt extends Ie{drawLine(e,t,n){n=this.styles.computeStyle(n,["no-fill"],{fill:"none",stroke:"#8ECB60",strokeWidth:1});const s=(0,un.W5)(t,n);return(0,b.R3)(e,s),s}draw(e,t){const n=super.draw(e,t);return this.drawLine(e,[{x:30,y:0},{x:30,y:t.height}],{stroke:"#BEBEBE"}),this.drawLine(e,[{x:0,y:-.5},{x:0,y:t.height+.5}],{stroke:"#8ECB60",strokeWidth:4}),n}}let fe=class extends a.RenderingShapeFactory{constructor(e,t,n,s,r,l){super(e,t),this.renderingLabel=e,this.renderingShape=t,this.renderingLane=n,this.renderingLaneSet=s,this.renderingAnnotation=r,this.renderingSubProcessExpanded=l}create(e){switch(e){case i.ProcessElementType.lane:return this.renderingLane;case i.ProcessElementType.laneSet:return this.renderingLaneSet;case i.ProcessElementType.label:return this.renderingLabel;case i.ProcessElementType.textAnnotation:return this.renderingAnnotation;case i.ProcessElementType.subProcessExpanded:case i.ProcessElementType.eventSubProcessExpanded:return this.renderingSubProcessExpanded;default:return this.renderingShape}}};fe=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("renderingLabel")),(0,o.__param)(1,(0,a.Inject)("renderingShape")),(0,o.__param)(2,(0,a.Inject)("renderingLane")),(0,o.__param)(3,(0,a.Inject)("renderingLaneSet")),(0,o.__param)(4,(0,a.Inject)("renderingAnnotation")),(0,o.__param)(5,(0,a.Inject)("renderingSubProcessExpanded")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object])],fe);var Ot=f(33112),At;let xe=class extends a.RenderingShape{constructor(e,t,n,s,r){super(e,t,n,r),this.elements=e,this.styles=t,this.diagramText=n,this.diagramMarkers=s,this.eventBus=r,this.markersConfig=this.diagramMarkers.getMarkers()}appendMarkers(e,t,n){const p=t.height-16,g=Object.values(n).filter(u=>!(0,x.isEmpty)(u));g.sort((u,y)=>this.markersConfig[u].order-this.markersConfig[y].order);let m=0;t.width&&(m=(t.width-(12*g.length+(2*g.length-2)))/2,m=Math.floor(m)),g.forEach(u=>{const y=(0,b.Ue)("image");(0,b.Lj)(y,{height:12,width:12,x:m,y:p}),m+=12+2,y.setAttributeNS(null,"type",this.markersConfig[u].type),y.setAttributeNS("http://www.w3.org/1999/xlink","href",this.markersConfig[u].smallImage),(0,b.R3)(e,y)})}draw(e,t){const n=super.draw(e,t),s={...t.markers};if(i.ProcessDiagramUtils.isTaskElement(t)){const l=[i.ProcessElementType.subProcessCollapsed,i.ProcessElementType.callActivity].includes(t.type)?this.markersConfig.Collapsed.type:null;Object.assign(s,{IsCollapsed:l})}if(Object.keys(s).length>0){const r=this.getSizeConfig(t);this.appendMarkers(e,r,s)}return n}};xe=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("elements")),(0,o.__param)(1,(0,a.Inject)("styles")),(0,o.__param)(2,(0,a.Inject)("diagramText")),(0,o.__param)(3,(0,a.Inject)("diagramMarkers")),(0,o.__param)(4,(0,a.Inject)("eventBus")),(0,o.__metadata)("design:paramtypes",[Object,typeof(At=typeof Ot.Z<"u"&&Ot.Z)=="function"?At:Object,Object,Object,Object])],xe);class Lt extends a.RenderingBaseShape{draw(e,t){super.draw(e,t);const n=this.elements.getConfig(t);if(t.caption){const p={box:{height:t.height,width:t.width+3,x:t.x,y:t.y},...n.label.style,style:{...this.diagramText.style,...n.label.editStyle}};this.createText(e,t.caption,p)}const s=n.cornerRadius||0,r=0;return this.drawRect(e,t.width,t.height,s,r,{fill:n.fill||"none",stroke:n.stroke,"stroke-dasharray":n.strokeDasharray||"0","stroke-linecap":n.strokeLinecap||"initial"})}}class H{constructor(e){this.context=e}canMove(){const e=this.context.target,t=this.context.shapes,n=this.context.splitConnectionHelper,s=new i.ProcessDiagramUtils;return!e||i.ProcessDiagramUtils.isRoot(e)||i.ProcessDiagramUtils.isContainer(e)||i.ProcessDiagramUtils.isLabel(e)||s.isFlow(e)&&n.canSplit(t)}}class Mt{constructor(e){this._context=e}canMove(){const{target:e,shapes:t}=this._context;return Boolean(e===void 0||!t.some(n=>n.parent!==e))}}class Ee{constructor(e,t){this.context=e,this._elementRegistry=t}isElementHasValidPosition(){const{delta:e,position:t,shapes:n,shape:s}=this.context;let r=[],l,p,g,m;if(s.parent){const h=e&&e.x||0,E=e&&e.y||0,S=s.x||Math.round(t.x-s.width/2),k=s.y||Math.round(t.y-s.height/2);g=S+s.width+h,m=k+s.height+E,l=S+h,p=k+E}else{const h=(0,ve.jY)(n,!1);l=Math.round(s.x-h.x-h.width/2+t.x),p=Math.round(s.y-h.y-h.height/2+t.y),g=l+s.width,m=p+s.height}const u=i.ProcessDiagramUtils.getSelfAndAllChildren(s),y=new i.ProcessDiagramUtils;return r=this._elementRegistry.filter(h=>!y.isFlow(h)&&!i.ProcessDiagramUtils.isLabel(h)&&!u.some(E=>E===h)),n.forEach(h=>{r=r.filter(E=>!i.ProcessDiagramUtils.getSelfAndAllChildren(h).some(S=>S===E))}),r=r.filter(h=>{const E=h.x+h.width,S=h.y+h.height;return g>h.x&&E>l&&m>h.y&&S>p}),i.ProcessDiagramUtils.isLaneSet(s)||i.ProcessDiagramUtils.isLane(s)||(r=r.filter(h=>!i.ProcessDiagramUtils.isLane(h)&&!i.ProcessDiagramUtils.isLaneSet(h))),r.length===0}canMove(){const{target:e,delta:t,position:n}=this.context;if(!n&&!t)return!0;const s=new i.ProcessDiagramUtils;return e&&!i.ProcessDiagramUtils.isLabel(e)&&!s.isConnection(e)&&!i.ProcessDiagramUtils.isContainer(e)&&!i.ProcessDiagramUtils.isRoot(e)?!1:this.isElementHasValidPosition()}}class It extends Ee{canMove(){const{target:e}=this.context,t=new i.ProcessDiagramUtils;return e&&(i.ProcessDiagramUtils.isEventSubProcessExpanded(e)||t.isFlow(e))?!1:super.canMove()}}class Rt extends H{constructor(e){super(e),this.context=e}canMove(){const e=this.context.target,t=this.context.shape;return e&&i.ProcessDiagramUtils.isTaskElement(e)&&t&&t.parent===void 0||super.canMove()}}class zt extends H{constructor(e){super(e),this.context=e}canMove(){const e=this.context.target;return!e||!i.ProcessDiagramUtils.isFlowNode(e)||i.ProcessDiagramUtils.isContainer(e)}}class Bt{constructor(e){this._context=e}canMove(){const{shape:e,shapes:t}=this._context,s=new i.ProcessDiagramUtils().getPool(e);return t.includes(s)}}class Ht extends Ee{canMove(){const{target:e}=this.context;return e&&(i.ProcessDiagramUtils.isLane(e)||i.ProcessDiagramUtils.isLaneSet(e))?!1:super.canMove()}}class Ft extends H{constructor(e){super(e),this.context=e}isMoveFromEventSubProcess(){const e=this.context.target,n=this.context.shape.parent;return e&&n&&i.ProcessDiagramUtils.isEventSubProcessExpanded(n)&&!(i.ProcessDiagramUtils.isEventSubProcessExpanded(e)&&n===e)}isMoveToEventSubProcess(){const e=this.context.target,n=this.context.shape.parent;return!(e&&i.ProcessDiagramUtils.isEventSubProcessExpanded(e)&&n!==e)}canMove(){return!this.isMoveFromEventSubProcess()&&this.isMoveToEventSubProcess()&&super.canMove()}}class Wt{getFeature(e,t){const n=e.shape;switch(e.shapes=e.shapes||[n],!0){case i.ProcessDiagramUtils.isStartEvent(n):return new Ft(e);case i.ProcessDiagramUtils.isIntermediateThrowEvent(n):return new Rt(e);case i.ProcessDiagramUtils.isLaneSet(n):return new Ht(e,t);case i.ProcessDiagramUtils.isLane(n):return new Bt(e);case i.ProcessDiagramUtils.isEventSubProcessExpanded(n):return new It(e,t);case i.ProcessDiagramUtils.isContainer(n):return new Ee(e,t);case i.ProcessDiagramUtils.isLabel(n):return new zt(e);case i.ProcessDiagramUtils.isBoundaryEvent(n):return new Mt(e);default:return new H(e)}}}class fn extends H{constructor(e){super(e),this.context=e}canMove(){const e=this.context.target,t=this.context.shape,n=this.context.shapes,s=new i.ProcessDiagramUtils;return e&&s.isFlow(e)&&n&&n.length===1&&i.ProcessDiagramUtils.hasNoConnections(t)?!0:super.canMove()}}var M=f(83612);function U(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}U.prototype.getSnapOrigin=function(c){return this._snapOrigins[c]},U.prototype.setSnapOrigin=function(c,e){this._snapOrigins[c]=e,this._snapLocations.indexOf(c)===-1&&this._snapLocations.push(c)},U.prototype.addDefaultSnap=function(c,e){var t=this._defaultSnaps[c];t||(t=this._defaultSnaps[c]=[]),t.push(e)},U.prototype.getSnapLocations=function(){return this._snapLocations},U.prototype.setSnapLocations=function(c){this._snapLocations=c},U.prototype.pointsForTarget=function(c){var e=c.id||c,t=this._targets[e];return t||(t=this._targets[e]=new je,t.initDefaults(this._defaultSnaps)),t};function je(c){this._snapValues={}}je.prototype.add=function(c,e){var t=this._snapValues[c];t||(t=this._snapValues[c]={x:[],y:[]}),t.x.indexOf(e.x)===-1&&t.x.push(e.x),t.y.indexOf(e.y)===-1&&t.y.push(e.y)},je.prototype.snap=function(c,e,t,n){var s=this._snapValues[e];return s&&(0,j.By)(c[t],s[t],n)},je.prototype.initDefaults=function(c){var e=this;(0,M.forEach)(c||{},function(t,n){(0,M.forEach)(t,function(s){e.add(n,s)})})};var Gt=f(28229),xn=1250;function V(c,e,t){var n=this;this._elementRegistry=c,e.on(["create.start","shape.move.start"],function(s){n.initSnap(s)}),e.on(["create.move","create.end","shape.move.move","shape.move.end"],xn,function(s){var r=s.context,l=r.shape,p=r.snapContext,g=r.target;if(!(s.originalEvent&&(0,Gt.JS)(s.originalEvent))&&!((0,j.Wn)(s)||!g)){var m=p.pointsForTarget(g);m.initialized||(m=n.addSnapTargetPoints(m,l,g),m.initialized=!0),t.snap(s,m)}}),e.on(["create.cleanup","shape.move.cleanup"],function(){t.hide()})}V.$inject=["elementRegistry","eventBus","snapping"],V.prototype.initSnap=function(c){var e=this._elementRegistry,t=c.context,n=t.shape,s=t.snapContext;s||(s=t.snapContext=new U);var r;e.get(n.id)?r=(0,j.Pi)(n,c):r={x:c.x+(0,j.Pi)(n).x,y:c.y+(0,j.Pi)(n).y};var l={x:r.x-n.width/2,y:r.y-n.height/2},p={x:r.x+n.width/2,y:r.y+n.height/2};return s.setSnapOrigin("mid",{x:r.x-c.x,y:r.y-c.y}),Re(n)||(s.setSnapOrigin("top-left",{x:l.x-c.x,y:l.y-c.y}),s.setSnapOrigin("bottom-right",{x:p.x-c.x,y:p.y-c.y})),s},V.prototype.addSnapTargetPoints=function(c,e,t){var n=this.getSnapTargets(e,t);return(0,M.forEach)(n,function(s){if(Re(s)){Re(e)&&c.add("mid",(0,j.Pi)(s));return}if(En(s)){if(s.waypoints.length<3)return;var r=s.waypoints.slice(1,-1);(0,M.forEach)(r,function(l){c.add("mid",l)});return}c.add("mid",(0,j.Pi)(s))}),!(0,M.isNumber)(e.x)||!(0,M.isNumber)(e.y)||this._elementRegistry.get(e.id)&&c.add("mid",(0,j.Pi)(e)),c},V.prototype.getSnapTargets=function(c,e){return(0,j.G)(e).filter(function(t){return!jn(t)})};function En(c){return!!c.waypoints}function jn(c){return!!c.hidden}function Re(c){return!!c.labelTarget}var Nt=f(86463),Pn=1250;function Z(c,e){var t=this;c.on(["resize.start"],function(n){t.initSnap(n)}),c.on(["resize.move","resize.end"],Pn,function(n){var s=n.context,r=s.shape,l=r.parent,p=s.direction,g=s.snapContext;if(!(n.originalEvent&&(0,Gt.JS)(n.originalEvent))&&!(0,j.Wn)(n)){var m=g.pointsForTarget(l);m.initialized||(m=t.addSnapTargetPoints(m,r,l,p),m.initialized=!0),Dn(p)&&(0,j.U)(n,"x",n.x),Tn(p)&&(0,j.U)(n,"y",n.y),e.snap(n,m)}}),c.on(["resize.cleanup"],function(){e.hide()})}Z.prototype.initSnap=function(c){var e=c.context,t=e.shape,n=e.direction,s=e.snapContext;s||(s=e.snapContext=new U);var r=Vt(t,n);return s.setSnapOrigin("corner",{x:r.x-c.x,y:r.y-c.y}),s},Z.prototype.addSnapTargetPoints=function(c,e,t,n){var s=this.getSnapTargets(e,t);return(0,M.forEach)(s,function(r){c.add("corner",(0,j.hT)(r)),c.add("corner",(0,j.w3)(r))}),c.add("corner",Vt(e,n)),c},Z.$inject=["eventBus","snapping"],Z.prototype.getSnapTargets=function(c,e){return(0,j.G)(e).filter(function(t){return!vn(t,c)&&!bn(t)&&!_n(t)&&!Sn(t)})};function Vt(c,e){var t=(0,Nt.wS)(c),n=(0,Nt.JA)(c),s={x:t.x,y:t.y};return e.indexOf("n")!==-1?s.y=n.top:e.indexOf("s")!==-1&&(s.y=n.bottom),e.indexOf("e")!==-1?s.x=n.right:e.indexOf("w")!==-1&&(s.x=n.left),s}function vn(c,e){return c.host===e}function bn(c){return!!c.waypoints}function _n(c){return!!c.hidden}function Sn(c){return!!c.labelTarget}function Dn(c){return c==="n"||c==="s"}function Tn(c){return c==="e"||c==="w"}var Cn=f(28605);const wn={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",V],resizeSnapping:["type",Z],snapping:["type",Cn.Z]};let ze=class extends a.DiagramSpaceTool{constructor(e,t,n,s,r,l,p,g){super(e,t,n,s,r,l,p,g),this.elements=p,this.diagramUtils=g}_getComputeMinAllowedDelta(e,t){const n=t==="e";if(i.ProcessDiagramUtils.isLaneSet(e)){const s=e.children.some(r=>i.ProcessDiagramUtils.isLane(r));return n||!s}return i.ProcessDiagramUtils.isLane(e)&&!n}canResizeShape(e,t,n){return!!(n==="x"&&i.ProcessDiagramUtils.isLane(e)&&this.diagramUtils.getPool(e).x<t&&e.x>t)}getMinAllowedDelta(e,t,n){let s=null;const r=t==="e";return e.forEach(l=>{if(this._getComputeMinAllowedDelta(l,t)){const p=i.ProcessDiagramUtils.getParticipantMinResizeBox(l,t,n,this.elements),g=r?p.width-l.width:p.height-l.height;(g>s||s===null)&&(s=g)}}),s}};ze=(0,o.__decorate)([(0,o.__param)(0,(0,a.Inject)("eventBus")),(0,o.__param)(1,(0,a.Inject)("dragging")),(0,o.__param)(2,(0,a.Inject)("canvas")),(0,o.__param)(3,(0,a.Inject)("modeling")),(0,o.__param)(4,(0,a.Inject)("rules")),(0,o.__param)(5,(0,a.Inject)("toolManager")),(0,o.__param)(6,(0,a.Inject)("elements")),(0,o.__param)(7,(0,a.Inject)("diagramUtils")),(0,o.__metadata)("design:paramtypes",[Object,Object,Object,Object,Object,Object,i.ProcessElements,i.ProcessDiagramUtils])],ze);const Be={...a.DiagramFeatures,copyPaste:["type",xt],diagramRules:["type",T],orderingProvider:["type",Y],layouter:["type",_e],snapping:["type",K],splitConnectionHelper:["type",z],labelEdit:["type",ee],directEditing:["type",te],diagramText:["type",Ze],diagramLoader:["type",Et],deleteLane:["type",X],outlineFactory:["type",N],validationOutlineFactory:["type",ft],validationOutline:["type",a.DiagramValidationOutline],modeling:["type",B],elements:["type",i.ProcessElements],groups:["type",i.ProcessDiagramGroups],paletteElements:["type",i.PaletteElements],paletteProvider:["type",jt],setupMenuProvider:["type",ye],renderingShapeFactory:["type",fe],renderingShape:["type",xe],renderingLane:["type",Ie],renderingLaneSet:["type",kt],renderingAnnotation:["type",Ut],renderingSubProcessExpanded:["type",Lt],diagramRenderer:["type",Me],contextPadProvider:["type",q],elementSizeUtils:["type",Q],elementToolsConfig:["type",ue],canElementMoveFactory:["type",Wt],diagramEventHandlerController:["type",a.CommonDiagramEventHandlerController],diagramMarkers:["type",he],diagramUtils:["type",i.ProcessDiagramUtils],spaceTool:["type",ze]};Be.__depends__=[...a.DiagramFeatures.__depends__,wn],Be.__init__=[...a.DiagramFeatures.__init__,"deleteLane","orderingProvider","snapping","validationOutlineFactory","validationOutline","groups","elementSizeUtils"];const Zt=Be;class Un extends a.BaseDiagramEventService{}var $t=f(31134),Jt=f(77207);class I{}I.\u0275fac=function(e){return new(e||I)},I.\u0275mod=D.\u0275\u0275defineNgModule({type:I}),I.\u0275inj=D.\u0275\u0275defineInjector({providers:[a.BaseDiagramEventService,{provide:a.DiagramFeaturesToken,useValue:Zt}],imports:[a.DiagramModule,$t.CommonModule,Jt.TranslateModule.forRoot()]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&D.\u0275\u0275setNgModuleScope(I,{imports:[a.DiagramModule,$t.CommonModule,Jt.TranslateModule],exports:[a.DiagramComponent]})}()}}]);
