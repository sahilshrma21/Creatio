(self.webpackChunkapp_studio_enterprise_relationship_diagram=self.webpackChunkapp_studio_enterprise_relationship_diagram||[]).push([[214,8239,5036,6118,7344,8160,1034,8056,1906],{12079:(me,ae,l)=>{l.r(ae),l.d(ae,{ConnectionPropertiesPageComponent:()=>R,ContainerPropertiesPageComponent:()=>Q,CrtRelationshipDialogComponent:()=>$,EntityInGroupPropertiesDialogComponent:()=>Z,GroupContentListComponent:()=>Y,GroupContentListEventService:()=>G,GroupPropertiesDialogComponent:()=>V,GroupsPropertiesPageComponent:()=>J,LookupDataService:()=>N,PropertiesPageEventService:()=>j,RelatedListComponent:()=>U,RelationshipDeleteDialogService:()=>w,RelationshipDesignerComponent:()=>H,RelationshipDesignerModule:()=>A,RelationshipDesignerService:()=>S,RelationshipDesignerTranslateLoader:()=>X,RelationshipDiagramEventHandlerController:()=>re,RelationshipDiagramEventService:()=>F});var I=l(74742),g=l(31134),W=l(86146),P=l(30955),k=l(72856),x=l(59837),M=l(14535),h=l(75903),C=l(66868),v=l(30738),f=l(59972),O=l(32820),ce=l(7950),pe=l(71006),_=l(75378),u=l(77207),m=l(99293),ie=l(41307),T=l(34038),p=l(15288),se=l(89455),e=l(94450),c=l(21322),D=l(27049);class L{}L.formal={id:"56d730bf-27f5-42d9-83df-183df2ec06a1",name:"Formal"},L.notFormal={id:"6d1d2243-d4de-4d64-aab4-23eed4021a60",name:"Not formal"};class b{}b.AddElement="AddElement",b.EditConnection="EditConnection",b.DeleteElement="DeleteElement",b.AddGroup="AddGroup",b.AddEntityInGroup="AddEntityInGroup";class de{}de.branch={id:"efe470ec-99d7-df11-9b2a-001d60e938c6",name:"Branch"},de.friend={id:"62099d0f-65e6-df11-971b-001d60e938c6",name:"Friend"};var he=l(6523);class N{constructor(t){this.queryExecutor=t}_getDisplayValueFilterGroup(t,n){const i=new _.FilterGroup;i.logicalOperation=_.LogicalOperatorType.Or;for(const o of t)i.addSchemaColumnFilterWithParameter(_.ComparisonType.Contain,o,n);return i}getFilteredLookupItems(t){const n=new _.EntitySchemaQuery(t.schemaName);n.rowCount=20;const i=t.additionalColumns||[],o=t.excludedRecords||[],r=t.additionalFilters||[];i.includes("Id")||n.addSchemaColumn("Id"),i.includes("Name")||n.addSchemaColumn("Name");for(const s of i)n.addSchemaColumn(s);if(t.value!==""){const s=t.displayValueFilters||["Name"];n.filters.add(this._getDisplayValueFilterGroup(s,t.value))}o.length>0&&n.filters.addSchemaColumnInFilterWithParameters(_.ComparisonType.Not_equal,"Id",o);for(const s of r)n.filters.add(s);return this.queryExecutor.executeSelectQuery(n).pipe((0,D.map)(s=>s.map(d=>({value:d.Id,displayValue:t.displayValueGetter?t.displayValueGetter(d):d.Name,row:d}))),(0,D.share)())}}N.\u0275fac=function(t){return new(t||N)(e.\u0275\u0275inject(he.QueryExecutor))},N.\u0275prov=e.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac});class G{constructor(){this.createGroup$=new c.Subject,this.addEntityToGroup$=new c.Subject,this.initializeGroups$=new c.Subject,this.isLoading$=new c.ReplaySubject(1)}createGroup(){this.createGroup$.next()}addEntityToGroup(t){this.addEntityToGroup$.next(t)}isLoading(t){this.isLoading$.next(t)}initializeGroups(){this.initializeGroups$.next()}}G.\u0275fac=function(t){return new(t||G)},G.\u0275prov=e.\u0275\u0275defineInjectable({token:G,factory:G.\u0275fac});class j{constructor(){this.designerConfig$=new c.ReplaySubject(1),this.doSave$=new c.Subject,this.saveCard$=new c.Subject,this.doCloseCard$=new c.Subject}setDesignerConfig(t){this.designerConfig$.next(t)}getDesignerConfig(){return this.designerConfig$}doSave(){return this.doSave$}cardSaved(t){this.saveCard$.next(t)}saveCard(){return this.doSave$.next(),this.saveCard$}closeCard(t){this.doCloseCard$.next(t)}doCloseCard(){return this.doCloseCard$}}j.\u0275fac=function(t){return new(t||j)},j.\u0275prov=e.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac});var Ce=l(33177),ge=l(49475),B=l(97600);class X extends u.TranslateLoader{constructor(t,n,i){super(),this.customEventService=t,this._store=n,this._getTranslationsEventName=i,this.destroyed$=new c.Subject,this.translations={},this.InitializeTranslation()}InitializeTranslation(){this.customEventService.subscribe(this._getTranslationsEventName).pipe((0,D.takeUntil)(this.destroyed$),(0,D.tap)(t=>{this._store.langs.forEach(n=>{const i=this._store.translations[n];this._store.translations[n]=(0,B.merge)(i,t)})})).subscribe(t=>{this.translations=t}),this.customEventService.createOutboundChannel(this._getTranslationsEventName).next()}getTranslation(t){return(0,c.of)(this.translations)}ngOnDestroy(){this.destroyed$.next()}}X.\u0275fac=function(t){return new(t||X)(e.\u0275\u0275inject(Ce.CustomEventService),e.\u0275\u0275inject(u.TranslateStore),e.\u0275\u0275inject(ge.GET_TRANSLATIONS_EVENT_NAME))},X.\u0275prov=e.\u0275\u0275defineInjectable({token:X,factory:X.\u0275fac});var ye=l(2876);class S{constructor(t){this.httpClient=t,this.serviceEndpoint="rest/RelationshipDesignerService/"}_prepareCollection(t,n){const i={};return t?.forEach(function(o){const r=o[n];i[r]=o},this),i}getDiagram(t,n){const i=this.serviceEndpoint+"GetDiagram";return this.httpClient.post(i,{recordId:t,schemaName:n}).pipe((0,D.map)(o=>{if(o&&o.success){const r=o.data;r.elements=this._prepareCollection(r.elements,"id"),r.connections=this._prepareCollection(r.connections,"id"),r.labels=this._prepareCollection(r.labels,"parent"),r.groups&&(r.groups=this._prepareCollection(r.groups,"id")),o.data=r;const s=o.config;s.customDiagramElements=this._prepareCollection(s.customDiagramElements,"type"),o.config=s}return o}))}deleteEntity(t){const n=this.serviceEndpoint+"DeleteEntity";return this.httpClient.post(n,{entityId:t})}createConnection(t){const n=this.serviceEndpoint+"CreateConnection";return this.httpClient.post(n,{entityConnection:t})}updateConnection(t){const n=this.serviceEndpoint+"UpdateConnection";return this.httpClient.post(n,{entityConnection:t})}deleteConnection(t){const n=this.serviceEndpoint+"DeleteConnection";return this.httpClient.post(n,{connectionId:t})}getGroupsData(){const t=this.serviceEndpoint+"GetGroupsData";return this.httpClient.post(t,null)}getGroupsDataForEntity(t){const n=this.serviceEndpoint+"GetGroupsDataForEntity";return this.httpClient.post(n,{entityId:t})}createGroup(t){const n=this.serviceEndpoint+"CreateGroup";return this.httpClient.post(n,{group:t})}updateGroup(t){const n=this.serviceEndpoint+"UpdateGroup";return this.httpClient.post(n,{group:t})}deleteGroup(t){const n=this.serviceEndpoint+"DeleteGroup";return this.httpClient.post(n,{groupId:t})}createEntityInGroup(t){const n=this.serviceEndpoint+"CreateEntityInGroup";return this.httpClient.post(n,{entityInGroup:t})}updateEntityInGroup(t){const n=this.serviceEndpoint+"UpdateEntityInGroup";return this.httpClient.post(n,{entityInGroup:t})}deleteEntityInGroup(t,n){const i=this.serviceEndpoint+"DeleteEntityInGroup";return this.httpClient.post(i,{entityId:t,groupId:n})}getRecordEntityInfo(t){const n=this.serviceEndpoint+"GetRecordEntityInfo";return this.httpClient.post(n,{entityId:t}).pipe((0,D.map)(i=>{const o=i?.recordEntityInfo;if(o){const r={};(0,B.forOwn)(o,s=>{const d=s.Key.toLowerCase();r[d]=s.Value}),i.recordEntityInfo=r}return i}))}}S.\u0275fac=function(t){return new(t||S)(e.\u0275\u0275inject(ye.HttpClient))},S.\u0275prov=e.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac});var y=l(8239),E=l(29450);class F extends E.BaseDiagramEventService{constructor(){super(),this.getDiagramInfo$=new c.ReplaySubject(1),this.itemSelected$=new c.Subject,this.highlightedGroup$=new c.Subject,this.diagramLoaded$=new c.Subject,this.elementDoubleClick$=new c.Subject,this.elementRemoving$=new c.Subject,this.connectionAdding$=new c.Subject,this.connectionAdded$=new c.Subject,this.connectionChanged$=new c.Subject,this.showMessage$=new c.Subject,this.connectionReconnect$=new c.Subject,this.entityInGroupAdded$=new c.Subject,this.entityInGroupRemoving$=new c.Subject,this.diagramChanged$=new c.Subject,this.init()}getDiagramConfig(){var t=this;return(0,y.Z)(function*(){return(0,c.lastValueFrom)(t.getDiagramInfo$.asObservable(),{defaultValue:null})})()}setDiagramConfig(t){this.getDiagramInfo$.next(t),this.getDiagramInfo$.complete()}diagramLoaded(){this.diagramLoaded$.next()}itemSelected(t){this.itemSelected$.next(t)}highlightGroup(t){this.highlightedGroup$.next(t)}elementDoubleClick(t){this.elementDoubleClick$.next(t)}connectionAdding(t){this.connectionAdding$.next(t)}connectionReconnect(t){this.connectionReconnect$.next(t)}elementRemoving(t){return this.elementRemoving$.next(t),!1}showMessage(t){this.showMessage$.next(t)}entityInGroupAdded(){this.entityInGroupAdded$.next()}entityInGroupRemoving(){this.entityInGroupRemoving$.next()}}F.\u0275fac=function(t){return new(t||F)},F.\u0275prov=e.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac});class w{constructor(t,n){this._dialogService=t,this._translateService=n}_getRemovingConfirmationDialogConfig(t){return{width:"450px",panelClass:["dialog-top-border","relationship-remove-item"],data:{message:this._translateService.instant(t),primaryButton:{result:m.YesButton.result,caption:this._translateService.instant(m.YesButton.caption).toLowerCase()},secondaryButton:{result:m.NoButton.result,caption:this._translateService.instant(m.NoButton.caption).toLowerCase()}}}}confirmRemoving(t){const n=this._getRemovingConfirmationDialogConfig(t);return this._dialogService.open(m.ConfirmationDialogComponent,n).pipe((0,c.map)(i=>i===m.YesButton.result))}}w.\u0275fac=function(t){return new(t||w)(e.\u0275\u0275inject(m.DialogService),e.\u0275\u0275inject(u.TranslateService))},w.\u0275prov=e.\u0275\u0275defineInjectable({token:w,factory:w.\u0275fac});class K{static hasParent(t){return!!t?.parent}static getDefaultConnectionType(t,n){switch(!0){case(this.isContainer(t)&&this.isContainer(n)):case(this.isContainer(t)&&this.isItem(n)&&!this.hasParent(n)):case(this.isContainer(t)&&this.isItem(n)&&t.id===n.parent):case(this.isItem(t)&&!this.hasParent(t)&&this.isContainer(n)):case(this.isItem(t)&&this.hasParent(t)&&this.isItem(n)&&!this.hasParent(n)):case(this.isItem(t)&&!this.hasParent(t)&&this.isItem(n)&&this.hasParent(n)):case(this.isItem(t)&&this.hasParent(t)&&this.isItem(n)&&this.hasParent(n)&&t.parent===n.parent):return L.formal;default:return L.notFormal}}static getUnsupportedConnectionTypesIds(t,n){return K.getDefaultConnectionType(t,n).id!==L.formal.id?[L.formal.id]:[]}static isItem(t){return t&&t.type==="relationship-item"}static isContainer(t){return t&&t.type==="relationship-container"}}var q=l(99852);class z{_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this.subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(t){this.injector=t,this.subscription=new c.Subscription,this.isNew=!1,this.isLoading=!1,this.elementData=null,this.elementConfig=null,this.id$=new c.Subject,this.isRtl=!1,this.injectDependencies(),this.subscribeEvents(),this._initializeDirectionality(),this._initializeGTM()}injectDependencies(){this.designerService=this.injector.get(S),this.propertiesPageEventService=this.injector.get(j),this.dialogService=this.injector.get(m.DialogService),this.translateService=this.injector.get(u.TranslateService),this.diagramEventService=this.injector.get(p.BaseDiagramEventService),this.directionality=this.injector.get(q.Directionality),this.googleTagManagerService=this.injector.get(ie.GoogleTagManagerService)}subscribeEvents(){this.subscription.add(this.id$.subscribe(t=>this.onIdChange(t))),this.subscription.add(this.propertiesPageEventService.doSave().subscribe(()=>this.saveCard()))}showMask(){this.isLoading=!0}hideMask(){this.isLoading=!1}getElement(t){return this.data.elements[t]||this.data.connections[t]}getElementConfig(t){return t&&this.config?.customDiagramElements[t]}getElementByRecordId(t){let n=null;return(0,B.forOwn)(this.data.elements,i=>{if(i.recordId===t)return n=i,!1}),n}onIdChange(t){this.subscription.add(this.propertiesPageEventService.getDesignerConfig().pipe((0,D.take)(1)).subscribe(n=>{this.fillData(n,t),this.onDataInitialized()}))}fillData(t,n){this.data=t.data,this.config=t.config;const i=this.elementData||this.getElement(n);this.elementConfig=this.getElementConfig(i?.type),this.elementData=i}onDataInitialized(){}saveCard(){const t=this.validate();if(!t){setTimeout(()=>{this.propertiesPageEventService.cardSaved({validated:t,success:!1,isChanged:!1})});return}this.showMask(),this.subscription.add(this.onSavedCard().subscribe(n=>{this.hideMask();const i=this.isNeedActualizeDiagram();this.propertiesPageEventService.cardSaved({validated:t,success:n,isChanged:i})}))}isNeedActualizeDiagram(){return this.isNew||this.isChanged()}onSavedCard(){return(0,c.of)(!0).pipe((0,D.delay)(1))}validate(){return!0}isChanged(){return!1}showErrorDialog(t){if(t?.success)return;const n=t?.errorInfo?.message||"An unknown error occurred during the operation.";this.subscription.add(this.dialogService.openInfoDialog(n).subscribe())}sendGtmAction(t){const n={moduleName:"RelationshipDesignerModule",schemaName:this.getGtmSchemaName()};t&&n&&this.googleTagManagerService.track((0,B.merge)(n,t))}getGtmSchemaName(){throw new Error("Need return gtm schema name")}ngOnDestroy(){this.subscription.unsubscribe(),this.hideMask()}}z.\u0275fac=function(t){return new(t||z)(e.\u0275\u0275directiveInject(e.Injector))},z.\u0275cmp=e.\u0275\u0275defineComponent({type:z,selectors:[["crt-base-properties-page"]],hostVars:2,hostBindings:function(t,n){t&2&&e.\u0275\u0275classProp("rtl",n.isRtl)},decls:0,vars:0,template:function(t,n){},encapsulation:2});var ue=l(73539);class ee{set legacyAutocompleteTrigger(t){this._legacyAutocompleteTrigger=t}set legacyAutocomplete(t){this._legacyAutocomplete=t,this._openedSubscription||(this._openedSubscription=this._legacyAutocomplete.opened.subscribe(this._onAutocompleteOpened.bind(this)),this._closedSubscription=this._legacyAutocomplete.closed.subscribe(this._onAutocompleteClosed.bind(this)))}_onAutocompleteOpened(){this._overlayPointerEventsSubscription=this._legacyAutocompleteTrigger._overlayRef._outsidePointerEvents.subscribe(t=>this._legacyAutocompleteTrigger.closePanel())}_onAutocompleteClosed(){this._overlayPointerEventsSubscription.unsubscribe(),this._overlayPointerEventsSubscription=void 0}ngOnDestroy(){this._openedSubscription.unsubscribe(),this._openedSubscription=void 0,this._closedSubscription.unsubscribe(),this._closedSubscription=void 0}}ee.\u0275fac=function(t){return new(t||ee)},ee.\u0275dir=e.\u0275\u0275defineDirective({type:ee,selectors:[["","crtLegacyAutocompleteOverlayClick",""]],inputs:{legacyAutocompleteTrigger:"legacyAutocompleteTrigger",legacyAutocomplete:"legacyAutocomplete"}});function Me(a,t){a&1&&e.\u0275\u0275element(0,"ts-mask",27)}function _e(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-hint"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.getControlErrorMessage())}}function fe(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-option",28),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function Ie(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-hint"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.getControlErrorMessage())}}function ve(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-option",28),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function De(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-hint"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.getControlErrorMessage())}}function Pe(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-option",28),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function xe(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-hint"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(n.getControlErrorMessage())}}function be(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-option",28),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}class R extends z{constructor(t){super(t),this.injector=t,this.relationshipTypeSchemaName="RelationType",this.connectionTypeSchemaName="RelationConnectionType",this.comment="",this.elementData=null,this._relationshipDeleteDialogService=this.injector.get(w)}injectDependencies(){super.injectDependencies(),this.lookupDataService=this.injector.get(N)}onDataInitialized(){this.showMask(),super.onDataInitialized(),this.initializeIsNew(),this.initializeSourceElementData(),this.initializeTargetElementData(),this.initializeConnectionType(),this.initializeExcludedConnectionTypes(),this.initializeRelationshipType(),this.initializeEntityA(),this.initializeEntityB(),this.initializeComment(),this.hideMask()}initializeIsNew(){this.isNew=this.elementData?.isNew}initializeSourceElementData(){!this.elementData?.source||(this.sourceElement=this.getElement(this.elementData.source),this.sourceConfig=this.getElementConfig(this.sourceElement.type))}initializeTargetElementData(){!this.elementData?.target||(this.targetElement=this.getElement(this.elementData.target),this.targetConfig=this.getElementConfig(this.targetElement.type))}initializeEntityA(){!this.sourceElement||(this.selectedEntityA={value:this.sourceElement.recordId,displayValue:this.sourceElement.caption})}initializeEntityB(){if(!this.elementData?.target)return;const t=this.getElement(this.elementData.target);this.selectedEntityB={value:t.recordId,displayValue:t.caption}}initializeConnectionType(){if(!this.elementData?.relationshipType?.connectionType)return;const t=this.elementData.relationshipType.connectionType;let n=t.id;this.isNew?(n=this.isFormalConnectionAddingDisabled()?L.notFormal.id:n,this.initializeConnectionTypeById(n)):this.selectedConnectionType={value:n,displayValue:t.name}}initializeConnectionTypeById(t){this.getConnectionTypeControlLookupValues().pipe((0,D.take)(1)).subscribe(n=>{this.selectedConnectionType=n.find(i=>i.value===t)})}initializeExcludedConnectionTypes(){!this.sourceElement||!this.targetElement||(this.excludedConnectionTypes=K.getUnsupportedConnectionTypesIds(this.sourceElement,this.targetElement))}initializeRelationshipType(){!this.elementData?.relationshipType?.id||(this.selectedRelationshipType={value:this.elementData?.relationshipType.id,displayValue:this.elementData?.relationshipType.name})}initializeComment(){this.comment=this.elementData?.comment||""}onSavedCard(){if(!this.isNeedActualizeDiagram())return(0,c.of)(!0).pipe((0,D.delay)(1));const t=this.buildServerElement(),n=this.isNew?this.designerService.createConnection(t):this.designerService.updateConnection(t);return this.sendGtmAction({action:this.isNew?b.AddElement:b.EditConnection}),n.pipe((0,D.switchMap)(i=>{const o=i?.success;return o||this.showErrorDialog(i),(0,c.of)(o).pipe((0,D.delay)(1))}))}validate(){let t=super.validate();return t=t&&!!this.selectedConnectionType&&!!this.selectedRelationshipType&&!!this.selectedEntityA&&!!this.selectedEntityB,t}isChanged(){let t=super.isChanged();const n=this.elementData,i=this.getElementByRecordId(this.selectedEntityB.value);return t=t||!i||i.id!==n.target,t=t||this.selectedConnectionType?.value!==n.relationshipType.connectionType.id,t=t||this.selectedRelationshipType?.value!==n.relationshipType.id,t=t||this.comment!==n.comment,t}buildServerElement(){return{id:this.elementData.originalId||this.elementData.id,diagramId:this.data.id,relationshipRecordA:{id:this.selectedEntityA.value,schemaName:this.sourceConfig.caption},relationshipRecordB:{id:this.selectedEntityB.value,schemaName:this.targetConfig.caption},relationshipType:this.selectedRelationshipType.value,comment:this.comment}}doDeleteConnection(){if(this.isNew){this.forceCloseCard(!0);return}this.showMask(),this.subscription.add(this.designerService.deleteConnection(this.elementData.originalId).subscribe(t=>{if(!t?.success){this.hideMask(),this.showErrorDialog(t);return}this.forceCloseCard(!0),this.hideMask(),this.sendGtmAction({action:b.DeleteElement})}))}forceCloseCard(t=!1){this.propertiesPageEventService.closeCard({isForced:!0,isNeedDiagramReload:t})}getControlLookupValues(t){return this.lookupDataService.getFilteredLookupItems({value:t.value,schemaName:t.schemaName,excludedRecords:t.excludedRecords,additionalColumns:t.additionalColumns,additionalFilters:t.additionalFilters,displayValueFilters:t.displayValueFilters,displayValueGetter:t.displayValueGetter})}isFormalConnectionAddingDisabled(){const t=K.hasParent(this.sourceElement),n=K.hasParent(this.targetElement),i=this.targetConfig.caption==="Account";return t&&n&&this.sourceElement.parent!==this.targetElement.parent||t&&i}getExcludedConnectionTypes(){return this.isFormalConnectionAddingDisabled()?[L.formal.id]:[]}getConnectionTypeControlLookupValues(t=""){const n=this.excludedConnectionTypes?.length?this.excludedConnectionTypes:this.getExcludedConnectionTypes();return this.getControlLookupValues({value:t,schemaName:this.connectionTypeSchemaName,excludedRecords:n})}getRelationTypeAdditionalFilterGroup(){const t="For"+this.sourceConfig.caption+this.targetConfig.caption,n=new _.FilterGroup;n.addSchemaColumnFilterWithParameter(_.ComparisonType.Equal,t,!0);let i=this.selectedConnectionType?.value;return!i&&this.isFormalConnectionAddingDisabled()&&(i=L.notFormal.id),i&&n.addSchemaColumnFilterWithParameter(_.ComparisonType.Equal,"RelationConnectionType.Id",i),n}getRelationshipTypeControlLookupValues(t=""){return this.getControlLookupValues({value:t,schemaName:this.relationshipTypeSchemaName,additionalColumns:["ReverseRelationType.Name","RelationConnectionType.Id","RelationConnectionType.Name"],additionalFilters:[this.getRelationTypeAdditionalFilterGroup()],displayValueFilters:["Name","ReverseRelationType.Name"],displayValueGetter:n=>n.Name+" - "+n["ReverseRelationType.Name"]})}getEntityAControlLookupValues(t=""){return this.getControlLookupValues({value:t,schemaName:this.sourceConfig.caption})}getEntityBControlLookupValues(t=""){return this.getControlLookupValues({value:t,schemaName:this.targetConfig.caption,excludedRecords:this.getExcludedEntityBControlValuesFilter()})}getExcludedEntityBControlValuesFilter(){const t=[];return this.addSelfExcludeFilterIfNeed(t),t}addSelfExcludeFilterIfNeed(t){this.targetConfig.caption===this.sourceConfig.caption&&t.push(this.sourceElement.recordId)}getGtmSchemaName(){return"ConnectionPropertiesPageComponent"}onConnectionTypeChange(t){this.selectedConnectionType=null,this.connectionTypes=this.getConnectionTypeControlLookupValues(t)}onConnectionTypeSelected(t){this.selectedConnectionType=t,this.connectionTypes=null,this.selectedRelationshipType=null}onRelationshipTypeChange(t){this.selectedRelationshipType=null,this.relationshipTypes=this.getRelationshipTypeControlLookupValues(t)}onRelationshipTypeSelected(t){this.selectedRelationshipType=t,this.selectedRelationshipType?.row&&(this.selectedConnectionType={value:this.selectedRelationshipType?.row["RelationConnectionType.Id"],displayValue:this.selectedRelationshipType?.row["RelationConnectionType.Name"]}),this.relationshipTypes=null}onEntityAChange(t){this.selectedEntityA=null,this.entitiesA=this.getEntityAControlLookupValues(t)}onEntityASelected(t){this.selectedEntityA=t,this.entitiesA=null}onEntityBChange(t){this.selectedEntityB=null,this.entitiesB=this.getEntityBControlLookupValues(t)}onEntityBSelected(t){this.selectedEntityB=t,this.entitiesB=null}getControlDisplayValue(t){return t?t.displayValue||t.value:""}getControlErrorMessage(){return this.translateService.instant("RelationshipDesigner.RequiredControlErrorMessage")}onCommentChange(t){this.comment=t}deleteConnection(){this._relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(t=>{t&&this.doDeleteConnection()})}onConnectionTypeFocus(t){this.connectionTypes=this.getConnectionTypeControlLookupValues()}onRelationshipTypeFocus(t){this.relationshipTypes=this.getRelationshipTypeControlLookupValues()}onEntityAFocus(t){this.entitiesA=this.getEntityAControlLookupValues()}onEntityBFocus(t){this.entitiesB=this.getEntityBControlLookupValues()}}R.\u0275fac=function(t){return new(t||R)(e.\u0275\u0275directiveInject(e.Injector))},R.\u0275cmp=e.\u0275\u0275defineComponent({type:R,selectors:[["crt-connection-properties-page"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:59,vars:52,consts:[["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo"],[1,"title"],[1,"title-control-group"],["floatLabel","always"],["type","text","matInput","","required","",3,"matAutocomplete","value","keyup","focus"],["connectionTypeTrigger","matAutocompleteTrigger"],[4,"ngIf"],["crtLegacyAutocompleteOverlayClick","",3,"legacyAutocompleteTrigger","legacyAutocomplete","displayWith","optionSelected"],["connectionTypeAuto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-icon-button","",1,"delete-icon",3,"click"],[1,"content"],["relationshipTypeTrigger","matAutocompleteTrigger"],["relationshipTypeAuto","matAutocomplete"],[1,"group-label"],["type","text","matInput","","disabled","",3,"matAutocomplete","value","keyup","focus"],["entityATrigger","matAutocompleteTrigger"],["entityAAuto","matAutocomplete"],["entityBTrigger","matAutocompleteTrigger"],["entityBAuto","matAutocomplete"],[1,"divider"],["floatLabel","always",1,"text-area"],["matInput","","name","message",3,"value","change"],[1,"component-mask"],[3,"value"]],template:function(t,n){if(t&1&&(e.\u0275\u0275template(0,Me,1,0,"ts-mask",0),e.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3),e.\u0275\u0275element(4,"div",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",5),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"div",6)(9,"mat-form-field",7)(10,"input",8,9),e.\u0275\u0275listener("keyup",function(o){return n.onConnectionTypeChange(o.target.value)})("focus",function(o){return n.onConnectionTypeFocus(o.target.value)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,_e,2,1,"mat-hint",10),e.\u0275\u0275elementStart(13,"mat-autocomplete",11,12),e.\u0275\u0275listener("optionSelected",function(o){return n.onConnectionTypeSelected(o.option.value)}),e.\u0275\u0275template(15,fe,2,2,"mat-option",13),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"button",14),e.\u0275\u0275listener("click",function(){return n.deleteConnection()}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(18,"div",15)(19,"mat-form-field",7)(20,"mat-label"),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"input",8,16),e.\u0275\u0275listener("keyup",function(o){return n.onRelationshipTypeChange(o.target.value)})("focus",function(o){return n.onRelationshipTypeFocus(o.target.value)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(25,Ie,2,1,"mat-hint",10),e.\u0275\u0275elementStart(26,"mat-autocomplete",11,17),e.\u0275\u0275listener("optionSelected",function(o){return n.onRelationshipTypeSelected(o.option.value)}),e.\u0275\u0275template(28,ve,2,2,"mat-option",13),e.\u0275\u0275pipe(29,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(30,"span",18),e.\u0275\u0275text(31),e.\u0275\u0275pipe(32,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"mat-form-field",7)(34,"mat-label"),e.\u0275\u0275text(35),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"input",19,20),e.\u0275\u0275listener("keyup",function(o){return n.onEntityAChange(o.target.value)})("focus",function(o){return n.onEntityAFocus(o.target.value)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(38,De,2,1,"mat-hint",10),e.\u0275\u0275elementStart(39,"mat-autocomplete",11,21),e.\u0275\u0275listener("optionSelected",function(o){return n.onEntityASelected(o.option.value)}),e.\u0275\u0275template(41,Pe,2,2,"mat-option",13),e.\u0275\u0275pipe(42,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(43,"mat-form-field",7)(44,"mat-label"),e.\u0275\u0275text(45),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"input",8,22),e.\u0275\u0275listener("keyup",function(o){return n.onEntityBChange(o.target.value)})("focus",function(o){return n.onEntityBFocus(o.target.value)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(48,xe,2,1,"mat-hint",10),e.\u0275\u0275elementStart(49,"mat-autocomplete",11,23),e.\u0275\u0275listener("optionSelected",function(o){return n.onEntityBSelected(o.option.value)}),e.\u0275\u0275template(51,be,2,2,"mat-option",13),e.\u0275\u0275pipe(52,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(53,"mat-divider",24),e.\u0275\u0275elementStart(54,"mat-form-field",25)(55,"mat-label"),e.\u0275\u0275text(56),e.\u0275\u0275pipe(57,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"textarea",26),e.\u0275\u0275listener("change",function(o){return n.onCommentChange(o.target.value)}),e.\u0275\u0275elementEnd()()()),t&2){const i=e.\u0275\u0275reference(11),o=e.\u0275\u0275reference(14),r=e.\u0275\u0275reference(24),s=e.\u0275\u0275reference(27),d=e.\u0275\u0275reference(37),te=e.\u0275\u0275reference(40),oe=e.\u0275\u0275reference(47),ne=e.\u0275\u0275reference(50);e.\u0275\u0275property("ngIf",n.isLoading),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,36,"ConnectionPropertiesPage.Title")),e.\u0275\u0275advance(4),e.\u0275\u0275property("matAutocomplete",o)("value",n.selectedConnectionType==null?null:n.selectedConnectionType.displayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!n.selectedConnectionType),e.\u0275\u0275advance(1),e.\u0275\u0275property("legacyAutocompleteTrigger",i)("legacyAutocomplete",o)("displayWith",n.getControlDisplayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(16,38,n.connectionTypes)),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(22,40,"ConnectionPropertiesPage.RelationshipType")),e.\u0275\u0275advance(2),e.\u0275\u0275property("matAutocomplete",s)("value",n.selectedRelationshipType==null?null:n.selectedRelationshipType.displayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!n.selectedRelationshipType),e.\u0275\u0275advance(1),e.\u0275\u0275property("legacyAutocompleteTrigger",r)("legacyAutocomplete",s)("displayWith",n.getControlDisplayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(29,42,n.relationshipTypes)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(32,44,"ConnectionPropertiesPage.Relations")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(n.sourceConfig==null||n.sourceConfig.entitySchemaData==null?null:n.sourceConfig.entitySchemaData.caption),e.\u0275\u0275advance(1),e.\u0275\u0275property("matAutocomplete",te)("value",n.selectedEntityA==null?null:n.selectedEntityA.displayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!n.selectedEntityA),e.\u0275\u0275advance(1),e.\u0275\u0275property("legacyAutocompleteTrigger",d)("legacyAutocomplete",te)("displayWith",n.getControlDisplayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(42,46,n.entitiesA)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(n.targetConfig==null||n.targetConfig.entitySchemaData==null?null:n.targetConfig.entitySchemaData.caption),e.\u0275\u0275advance(1),e.\u0275\u0275property("matAutocomplete",ne)("value",n.selectedEntityB==null?null:n.selectedEntityB.displayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!n.selectedEntityB),e.\u0275\u0275advance(1),e.\u0275\u0275property("legacyAutocompleteTrigger",oe)("legacyAutocomplete",ne)("displayWith",n.getControlDisplayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(52,48,n.entitiesB)),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(57,50,"ConnectionPropertiesPage.Comment")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.comment)}},dependencies:[g.NgForOf,g.NgIf,m.MaskComponent,x.MatLegacyAutocomplete,x.MatLegacyAutocompleteTrigger,ue.MatLegacyOption,M.MatLegacyButton,W.MatDivider,C.MatLegacyFormField,C.MatLegacyHint,C.MatLegacyLabel,v.MatLegacyInput,ee,g.AsyncPipe,u.TranslatePipe],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",'.rtl[_nghost-%COMP%]   .title-control-group[_ngcontent-%COMP%]{width:300px}.rtl[_nghost-%COMP%]   .title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{padding:revert;margin-left:0}.rtl[_nghost-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{margin-left:-50px}.logo[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMC45MDgiIGhlaWdodD0iMTEuMDI5IiB2aWV3Qm94PSIwIDAgMTAuOTA4IDExLjAyOSI+PGRlZnM+PHN0eWxlPi5he2ZpbGw6bm9uZTtzdHJva2U6IzU0NjU3ZDt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4zNTYgMC40NDcpIj48cGF0aCBjbGFzcz0iYSIgZD0iTTQuMTMxLDEwLjIzLDE0LjIzNiwwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNC4xMzEpIi8+PGxpbmUgY2xhc3M9ImEiIHkxPSIyLjEyNSIgeDI9IjQuMjUxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1Ljg1NSkiLz48bGluZSBjbGFzcz0iYSIgeTE9IjQuMjUxIiB4Mj0iMi4xMjUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDcuOTgpIi8+PC9nPjwvc3ZnPg==);width:24px;height:24px}.title-control-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:324px}.title-control-group[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{font-family:bpmonline designer icons;line-height:1px;line-height:.6px;font-size:24px;height:24px;width:24px;opacity:.8;margin:19px 19px 10px 5px}.title-control-group[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]:before{content:"\\e92c"!important;display:inline;position:relative}.content[_ngcontent-%COMP%]{padding:20px}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{padding-bottom:20px}.content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{margin:8px -20px 0}']});var Se=l(8785);function Ee(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-option",13),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function we(a,t){if(a&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-form-field",4)(1,"mat-label"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"input",9),e.\u0275\u0275listener("keyup",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onGroupChange(o.target.value))})("focus",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onGroupFocus(o.target.value))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-autocomplete",10,11),e.\u0275\u0275listener("optionSelected",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onGroupSelected(o.option.value))}),e.\u0275\u0275template(7,Ee,2,2,"mat-option",12),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275elementEnd()()}if(a&2){const n=e.\u0275\u0275reference(6),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,5,"EntityInGroupPropertiesDialog.Group")),e.\u0275\u0275advance(2),e.\u0275\u0275property("matAutocomplete",n)("value",i.selectedGroup==null?null:i.selectedGroup.displayValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("displayWith",i.getControlDisplayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(8,7,i.groups))}}function Oe(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-option",13),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),a&2){const n=t.$implicit;e.\u0275\u0275property("value",n),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",n.displayValue," ")}}function Te(a,t){if(a&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-form-field",4)(1,"mat-label"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"input",9),e.\u0275\u0275listener("keyup",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onEntityChange(o.target.value))})("focus",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onEntityFocus(o.target.value))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-autocomplete",10,14),e.\u0275\u0275listener("optionSelected",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onEntitySelected(o.option.value))}),e.\u0275\u0275template(6,Oe,2,2,"mat-option",12),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275elementEnd()()}if(a&2){const n=e.\u0275\u0275reference(5),i=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(i.itemTypeSchemaCaption),e.\u0275\u0275advance(1),e.\u0275\u0275property("matAutocomplete",n)("value",i.selectedEntity==null?null:i.selectedEntity.displayValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("displayWith",i.getControlDisplayValue),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(7,5,i.entities))}}class Z{constructor(t,n){this.injector=n,this.itemTypeSchemaCaption="",this.isGroupVisible=!0,this.isEntityVisible=!0,this.isRtl=!1,this.injectDependencies(),this.initializeItemTypeSchemaCaption(),this.initializeEntityInGroup(t?.entityInGroup),this.initializeExludedGroups(t?.excludedGroups),this.initializeExludedEntityRecords(t?.exludedEntityRecords),this._initializeDirectionality()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}initializeExludedGroups(t){this.excludedGroups=t||[]}initializeExludedEntityRecords(t){this.excludedEntityRecords=t||[]}injectDependencies(){this.lookupDataService=this.injector.get(N),this.translateService=this.injector.get(u.TranslateService),this.diagramEventService=this.injector.get(p.BaseDiagramEventService),this.directionality=this.injector.get(q.Directionality)}initializeItemTypeSchemaCaption(){var t=this;return(0,y.Z)(function*(){const i=(yield t.diagramEventService.getDiagramConfig())?.customDiagramElements[p.RelationshipElementType.relationshipItem]||{};t.itemTypeSchemaCaption=i.entitySchemaData?.caption||""})()}initializeEntityInGroup(t){!t||(this.entityInGroup=t,this.initializeComment(),this.initializeInputVisibility())}initializeComment(){this.entityInGroup?.comment||(this.entityInGroup.comment="")}initializeInputVisibility(){this.entityInGroup.groupId&&(this.isGroupVisible=!1),this.entityInGroup.entityId&&(this.isEntityVisible=!1)}getControlLookupValues(t){return this.lookupDataService.getFilteredLookupItems({value:t.value,schemaName:t.schemaName,excludedRecords:t.excludedRecords})}getGroupControlLookupValues(t=""){return this.getControlLookupValues({value:t,schemaName:"RelationshipGroup",excludedRecords:this.excludedGroups})}getContactControlLookupValues(t=""){return this.getControlLookupValues({value:t,schemaName:"Contact",excludedRecords:this.excludedEntityRecords})}isCardValid(){const t=!this.isEntityVisible||!!this.selectedEntity,n=!this.isGroupVisible||!!this.selectedGroup;return t&&n}getControlDisplayValue(t){return t?t.displayValue||t.value:""}onGroupChange(t){this.selectedGroup=null,this.groups=this.getGroupControlLookupValues(t)}onGroupSelected(t){this.selectedGroup=t,this.entityInGroup.groupId=t.value,this.groups=null}onGroupFocus(t){this.groups=this.getGroupControlLookupValues()}onEntityChange(t){this.selectedEntity=null,this.entities=this.getContactControlLookupValues(t)}onEntitySelected(t){this.selectedEntity=t;let n=this.entityInGroup.entityRecordData||{};n=Object.assign(n,{id:t.value,name:t.displayValue}),this.entityInGroup.entityRecordData=n,this.entities=null}onEntityFocus(t){this.entities=this.getContactControlLookupValues()}getDialogCaption(){const t=this.isGroupVisible||this.isEntityVisible?"AddToGroup":"Edit";return this.translateService.instant("EntityInGroupPropertiesDialog."+t)}}Z.\u0275fac=function(t){return new(t||Z)(e.\u0275\u0275directiveInject(h.MAT_LEGACY_DIALOG_DATA),e.\u0275\u0275directiveInject(e.Injector))},Z.\u0275cmp=e.\u0275\u0275defineComponent({type:Z,selectors:[["crt-entity-in-group-properties-dialog"]],hostVars:2,hostBindings:function(t,n){t&2&&e.\u0275\u0275classProp("rtl",n.isRtl)},decls:19,vars:15,consts:[[1,"add-entity-to-group-dialog"],["mat-dialog-title",""],["mat-dialog-content","",1,"relationship-dialog-content"],["floatLabel","always",4,"ngIf"],["floatLabel","always"],["type","text","matInput","",3,"value","input"],["mat-dialog-actions",""],["mat-button","",1,"crt-button",3,"mat-dialog-close"],["mat-flat-button","","color","accent",1,"action-button","crt-button",3,"mat-dialog-close","disabled"],["type","text","matInput","","required","",3,"matAutocomplete","value","keyup","focus"],[3,"displayWith","optionSelected"],["groupAutocomplete","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["contactAutocomplete","matAutocomplete"]],template:function(t,n){t&1&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"span"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"div",2),e.\u0275\u0275template(5,we,9,9,"mat-form-field",3),e.\u0275\u0275template(6,Te,8,7,"mat-form-field",3),e.\u0275\u0275elementStart(7,"mat-form-field",4)(8,"mat-label"),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"input",5),e.\u0275\u0275listener("input",function(o){return n.entityInGroup.comment=o.target.value}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(12,"div",6)(13,"button",7),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"button",8),e.\u0275\u0275text(17),e.\u0275\u0275pipe(18,"translate"),e.\u0275\u0275elementEnd()()()),t&2&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.getDialogCaption()),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.isGroupVisible),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isEntityVisible),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(10,9,"EntityInGroupPropertiesDialog.Comment")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.entityInGroup==null?null:n.entityInGroup.comment),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(15,11,"EntityInGroupPropertiesDialog.Cancel")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("mat-dialog-close",n.entityInGroup)("disabled",!n.isCardValid()),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(18,13,"EntityInGroupPropertiesDialog.Save")," "))},dependencies:[g.NgForOf,g.NgIf,x.MatLegacyAutocomplete,x.MatLegacyAutocompleteTrigger,ue.MatLegacyOption,M.MatLegacyButton,h.MatLegacyDialogClose,h.MatLegacyDialogTitle,h.MatLegacyDialogContent,h.MatLegacyDialogActions,C.MatLegacyFormField,C.MatLegacyLabel,v.MatLegacyInput,g.AsyncPipe,u.TranslatePipe],styles:["[_nghost-%COMP%]{min-width:240px}[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-top:4px;font-family:var(--crt-headline-2-font-family);font-size:var(--crt-headline-2-font-size);line-height:var(--crt-headline-2-line-height);font-weight:var(--crt-headline-2-font-weight);letter-spacing:var(--crt-headline-2-letter-spacing);text-transform:var(--crt-headline-2-text-transform);-webkit-font-smoothing:antialiased;color:var(--crt-palette-primary-500, var(--palette-primary-500))}.rtl[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{text-align:right}.rtl[_nghost-%COMP%]   .mat-autocomplete.mat-autocomplete[_ngcontent-%COMP%]:after{right:auto}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   .mat-form-field-required-marker[_ngcontent-%COMP%]{color:#f44336}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%], .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]{font-family:var(--crt-button-font-family, var(--button-font-family));font-size:var(--crt-button-font-size, var(--button-font-size));font-weight:var(--crt-button-font-weight, var(--button-font-weight));text-transform:var(--crt-button-text-transform, uppercase);border-radius:var(--button-border-radius, var(--button-rounded-border-radius))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[disabled][_ngcontent-%COMP%]{color:var(--crt-palette-disabled-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-disabled-50, rgba(var(--disabled-button-background), 1))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]){color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):focus{color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):hover, .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]).cdk-keyboard-focused{background-color:var(--crt-palette-primary-800, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):active{background-color:var(--crt-palette-primary-900, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{color:var(--crt-palette-secondary-500, var(--palette-primary-500))!important}"]});const Le=["colorBox"];function Ne(a,t){if(a&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"color-github",15),e.\u0275\u0275listener("onChangeComplete",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.onChangeColor(o))}),e.\u0275\u0275elementEnd()}if(a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275styleProp("left",n.colorPickerPosition.x,"px")("top",n.colorPickerPosition.y,"px"),e.\u0275\u0275property("triangle","top-right")("color",n.group.color)("colors",n.colors)("width",187)}}class V{constructor(t,n,i){this.translateService=n,this.isNew=!0,this.colors=["#FF2031","#C40069","#C400A9","#8400C4","#5200C4","#2B00C4","#005BC4","#0076C4","#009FC4","#29A5A1","#00C4A8","#00C46D","#00C407","#A3C400"],this.isColorTabVisible=!1,this.colorPickerPosition={x:0,y:0},this.group={id:(0,_.generateGuid)(),name:"",color:"#000000",comment:""},this.isRtl=!1,t?.group?(this.group=t.group,this.isNew=!1):this.initializeColor(),this._initializeDirectionality(i)}_initializeDirectionality(t){this.isRtl=t?.value==="rtl"}initializeColor(){const t=Math.floor(Math.random()*Math.floor(this.colors.length-1));this.group.color=this.colors[t]}initializeColorPickerPostion(){const t=this.colorBox?.nativeElement;if(!t)return;let n=t.offsetLeft,i=t.offsetTop;i+=30,n-=145,this.colorPickerPosition={x:n,y:i}}showColorTab(){this.initializeColorPickerPostion(),this.isColorTabVisible=!0}onChangeColor(t){this.group.color=t.color.hex}onGlobalClick(t){this.colorBox.nativeElement.contains(t.target)||(this.isColorTabVisible=!1)}getDialogCaption(){const t=this.isNew?"NewGroup":"EditGroup";return this.translateService.instant("GroupPropertiesDialog."+t)}}V.\u0275fac=function(t){return new(t||V)(e.\u0275\u0275directiveInject(h.MAT_LEGACY_DIALOG_DATA),e.\u0275\u0275directiveInject(u.TranslateService),e.\u0275\u0275directiveInject(q.Directionality))},V.\u0275cmp=e.\u0275\u0275defineComponent({type:V,selectors:[["crt-group-properties-dialog"]],viewQuery:function(t,n){if(t&1&&e.\u0275\u0275viewQuery(Le,5,e.ElementRef),t&2){let i;e.\u0275\u0275queryRefresh(i=e.\u0275\u0275loadQuery())&&(n.colorBox=i.first)}},hostVars:2,hostBindings:function(t,n){t&1&&e.\u0275\u0275listener("mousedown",function(o){return n.onGlobalClick(o)},!1,e.\u0275\u0275resolveDocument),t&2&&e.\u0275\u0275classProp("rtl",n.isRtl)},decls:27,vars:20,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"relationship-dialog-content"],[1,"flex-row-control-group"],["floatLabel","always",1,"name-control"],["matInput","","type","text","required","",3,"value","input"],["floatLabel","always"],["matInput","","type","text",3,"value","input"],[1,"color-box-wrap"],["colorBox",""],[1,"color-box"],[1,"choose-button",3,"click"],["class","color-picker",3,"left","top","triangle","color","colors","width","onChangeComplete",4,"ngIf"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",1,"crt-button",3,"mat-dialog-close"],["mat-flat-button","","color","accent",1,"crt-button",3,"mat-dialog-close","disabled"],[1,"color-picker",3,"triangle","color","colors","width","onChangeComplete"]],template:function(t,n){t&1&&(e.\u0275\u0275elementStart(0,"div",0)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(3,"div",1)(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"input",4),e.\u0275\u0275listener("input",function(o){return n.group.name=o.target.value}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"mat-form-field",5)(11,"mat-label"),e.\u0275\u0275text(12),e.\u0275\u0275pipe(13,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"input",6),e.\u0275\u0275listener("input",function(o){return n.group.comment=o.target.value}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(15,"div",7,8),e.\u0275\u0275element(17,"div",9),e.\u0275\u0275elementStart(18,"div",10),e.\u0275\u0275listener("click",function(){return n.showColorTab()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(19,Ne,1,8,"color-github",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(20,"div",12)(21,"button",13),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"button",14),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"translate"),e.\u0275\u0275elementEnd()()),t&2&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.getDialogCaption()),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(8,12,"GroupPropertiesDialog.Name")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.group.name),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(13,14,"GroupPropertiesDialog.Comment")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.group.comment),e.\u0275\u0275advance(3),e.\u0275\u0275styleProp("background",n.group.color),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.isColorTabVisible),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(23,16,"GroupPropertiesDialog.Cancel")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("mat-dialog-close",n.group)("disabled",!(n.group!=null&&n.group.name)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(26,18,"GroupPropertiesDialog.Save")," "))},dependencies:[g.NgIf,se.GithubComponent,M.MatLegacyButton,h.MatLegacyDialogClose,h.MatLegacyDialogTitle,h.MatLegacyDialogContent,h.MatLegacyDialogActions,C.MatLegacyFormField,C.MatLegacyLabel,v.MatLegacyInput,u.TranslatePipe],styles:["[_nghost-%COMP%]{min-width:240px}[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-top:4px;font-family:var(--crt-headline-2-font-family, var(--dialog-title-font-family));font-size:var(--crt-headline-2-font-size, var(--dialog-title-font-size));line-height:var(--crt-headline-2-line-height, var(--dialog-title-line-height));font-weight:var(--crt-headline-2-font-weight, var(--dialog-title-font-weight));color:var(--crt-palette-primary-500, var(--palette-primary-500))}.rtl[_nghost-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]{margin-right:30px}.rtl[_nghost-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{text-align:right}.mat-dialog-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.mat-dialog-content[_ngcontent-%COMP%]   .flex-row-control-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1}.mat-dialog-content[_ngcontent-%COMP%]   .flex-row-control-group[_ngcontent-%COMP%]   .name-control[_ngcontent-%COMP%]{width:100%}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]{height:16px;width:32px;display:flex;margin-left:10px;flex-direction:row;margin-top:20px}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .color-box[_ngcontent-%COMP%]{height:16px;width:16px;border:1px solid #cccccc}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .choose-button[_ngcontent-%COMP%]{height:16px;width:16px;background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojNTQ2NTdkO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNzgzLjc3OSA3NC40NTUpIj48cGF0aCBjbGFzcz0iYSIgZD0iTTE3ODcuNzc5LTY3LjQ1NWw0LDQsNC00WiIvPjwvZz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PC9zdmc+);background-position:center;background-repeat:no-repeat}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .choose-button[_ngcontent-%COMP%]:hover{cursor:pointer}.mat-dialog-content[_ngcontent-%COMP%]   .color-box-wrap[_ngcontent-%COMP%]   .color-picker[_ngcontent-%COMP%]{position:absolute;z-index:2600}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{font-family:var(--crt-font-family, var(--font-family))}.mat-dialog-content[_ngcontent-%COMP%]   .mat-form-field-wrapper[_ngcontent-%COMP%]   .mat-form-field-label-wrapper[_ngcontent-%COMP%]   .mat-form-field-required-marker[_ngcontent-%COMP%]{color:#f44336}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:flex-end}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%], .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]{font-family:var(--crt-button-font-family, var(--button-font-family));font-size:var(--crt-button-font-size, var(--button-font-size));font-weight:var(--crt-button-font-weight, var(--button-font-weight));text-transform:var(--crt-button-text-transform, uppercase);border-radius:var(--button-border-radius, var(--button-rounded-border-radius))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[disabled][_ngcontent-%COMP%]{color:var(--crt-palette-disabled-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-disabled-50, rgba(var(--disabled-button-background), 1))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]){color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):focus{color:var(--crt-palette-primary-contrast-500, var(--palette-primary-contrast-500));background-color:var(--crt-palette-primary-500, var(--palette-primary-500))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):hover, .mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]).cdk-keyboard-focused{background-color:var(--crt-palette-primary-800, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-flat-button[_ngcontent-%COMP%]:not([disabled]):active{background-color:var(--crt-palette-primary-900, var(--palette-primary-800))}.mat-dialog-actions[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{color:var(--crt-palette-secondary-500, var(--palette-primary-500))!important}"]});function Ge(a,t){if(a&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",21),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext().$implicit,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.addEntityToGroup(o,r.id))}),e.\u0275\u0275elementEnd()}}const je=function(a){return{"background-image":a}};function ze(a,t){if(a&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-list-item",22)(1,"div",23)(2,"div",24),e.\u0275\u0275element(3,"div",25),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",26)(5,"div",27),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",28)(8,"div"),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",29),e.\u0275\u0275element(11,"button",30),e.\u0275\u0275elementStart(12,"mat-menu",14,31)(14,"button",17),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.editEntityInGroup(r))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"button",18),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.deleteEntityFromGroup(r.entityId,r.groupId))}),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(16,"div",32),e.\u0275\u0275text(17),e.\u0275\u0275elementEnd()()()()}if(a&2){const n=t.$implicit,i=e.\u0275\u0275reference(13);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(5,je,"url("+(n.entityRecordData==null?null:n.entityRecordData.image)+")")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.entityRecordData.type),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.entityRecordData.name),e.\u0275\u0275advance(2),e.\u0275\u0275property("matMenuTriggerFor",i),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(n.comment)}}function Re(a,t){if(a&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-list-item",2)(1,"mat-expansion-panel",3)(2,"mat-expansion-panel-header",4)(3,"div",5)(4,"div",6),e.\u0275\u0275element(5,"mat-icon",7),e.\u0275\u0275elementStart(6,"div",8)(7,"div",9),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div",10),e.\u0275\u0275text(10),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(11,"div",11),e.\u0275\u0275template(12,Ge,1,0,"button",12),e.\u0275\u0275elementStart(13,"button",13),e.\u0275\u0275listener("click",function(o){return o==null?null:o.stopPropagation()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"mat-menu",14,15)(16,"button",16),e.\u0275\u0275listener("click",function(o){const s=e.\u0275\u0275restoreView(n).$implicit,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.toggleHighlightGroup(o,s.id))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",17),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.editGroup(r))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"button",18),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.deleteGroup(r.id))}),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(19,"mat-list",19),e.\u0275\u0275template(20,ze,18,7,"mat-list-item",20),e.\u0275\u0275elementEnd()()()}if(a&2){const n=t.$implicit,i=e.\u0275\u0275reference(15),o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("expanded",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("collapsedHeight","33px")("expandedHeight","33px"),e.\u0275\u0275advance(3),e.\u0275\u0275styleProp("background",n.color),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.name),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("(",o.getGroupEntitiesCount(n),")"),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.isAddEntityToGroupButtonVisible()),e.\u0275\u0275advance(1),e.\u0275\u0275property("matMenuTriggerFor",i),e.\u0275\u0275advance(3),e.\u0275\u0275classProp("selectedGroup",o.highlightedGroupId===n.id),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",n.entities)}}class Y{set isLoading(t){this.groupContentListEventService.isLoading(t)}set filteredEntityId(t){t!==this._filteredEntityId&&(this._filteredEntityId=t)}set searchFilter(t){t!==this._searchFilter&&(this._searchFilter=t,this.renderGroup())}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this._subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(t){this.injector=t,this._subscription=new c.Subscription,this._searchFilter="",this.groups=[],this.renderedGroups=[],this.searchFilterChange=new e.EventEmitter,this.changed=new e.EventEmitter,this.isRtl=!1,this.injectDependencies(),this.subscribePageEvent(),this._initializeDirectionality(),this._initializeGTM()}injectDependencies(){this.diagramEventService=this.injector.get(E.BaseDiagramEventService),this.directionality=this.injector.get(q.Directionality),this.googleTagManagerService=this.injector.get(ie.GoogleTagManagerService),this.relationshipDesignerService=this.injector.get(S),this.groupContentListEventService=this.injector.get(G),this.dialogService=this.injector.get(m.DialogService),this.translateService=this.injector.get(u.TranslateService),this.relationshipDeleteDialogService=this.injector.get(w)}initializeGroups(){this.isLoading=!0;const t=this.relationshipDesignerService,n=this._filteredEntityId;(n?t.getGroupsDataForEntity(n):t.getGroupsData()).subscribe(o=>{if(!o?.success){this.isLoading=!1,this.showErrorDialog(o);return}this.groups=o.groups,this.renderGroup(),this.isLoading=!1})}renderGroup(){const t=(0,B.cloneDeep)(this.groups);this.renderedGroups=this.filteredGroupByFilter(t)}filteredGroupByFilter(t){const n=this._searchFilter?.toLocaleLowerCase();return n?t.filter(i=>{let o=i.entities||[];return o=o.filter(r=>{const s=r.entityRecordData?.name||"";return this.isStringContain(s,n)}),i.entities=o,o.length===0?this.isStringContain(i.name,n)?i:!1:i}):t}isStringContain(t,n){return t.toLowerCase().indexOf(n)>=0}clearSearchFilter(){this._searchFilter="",this.searchFilterChange.emit(this._searchFilter),this.renderGroup()}showErrorDialog(t){if(t?.success)return;const n=t?.errorInfo?.message||"An unknown error occurred during the operation.";this._subscription.add(this.dialogService.openInfoDialog(n).subscribe())}handleBaseDialogAction(t,n,i){!t||(this.isLoading=!0,n.call(this.relationshipDesignerService,t).subscribe(o=>this.handleBaseResponseAction(o,i)))}handleBaseResponseAction(t,n){if(!t?.success){this.isLoading=!1,this.showErrorDialog(t);return}n(),this.clearSearchFilter(),this.isLoading=!1,this.changed.emit(this.groups)}subscribePageEvent(){const t=this.groupContentListEventService;this._subscription.add(t.createGroup$.subscribe(()=>this.createGroup())),this._subscription.add(t.addEntityToGroup$.subscribe(n=>this.doAddEntityToGroup(n))),this._subscription.add(t.initializeGroups$.subscribe(()=>this.initializeGroups()))}addGroupToList(t){this.groups.push(t)}updateGroupInList(t){const n=this.groups.findIndex(i=>i.id===t.id);this.groups[n]=t}deleteGroupFromList(t){const n=this.groups.findIndex(i=>i.id===t);this.groups.splice(n,1),this.diagramEventService.entityInGroupRemoving()}doAddEntityToGroup(t){const n={panelClass:["relationship-dialog-edit"],data:{entityInGroup:t,excludedGroups:this.getExcludedGroupsList(),exludedEntityRecords:this.getExcludedEntityRecords(t)},autoFocus:!1},i=this.dialogService.open(Z,n).subscribe(o=>{this.handleBaseDialogAction(o,this.relationshipDesignerService.createEntityInGroup,()=>{this.addEntityInGroupToList(o),this.diagramEventService.entityInGroupAdded(),this.sendGtmAction({action:b.AddEntityInGroup})})});this._subscription.add(i)}addEntityInGroupToList(t){this.initializeGroups()}updateEntityInGroupInList(t){const n=this.groups.find(o=>o.id===t.groupId),i=n.entities.findIndex(o=>o.id===t.id);n.entities[i]=t}deleteEntityInGroupFromList(t,n){const i=this.groups.find(r=>r.id===n),o=i.entities.findIndex(r=>r.entityId===t);i.entities.splice(o,1)}getExcludedGroupsList(){return this._filteredEntityId?this.groups.map(t=>t.id):[]}getExcludedEntityRecords(t){if(this._filteredEntityId||!t.groupId)return[];const n=[];return this.groups.find(o=>o.id===t.groupId).entities?.forEach(o=>n.push(o.entityRecordData.id)),n}sendGtmAction(t){const n={moduleName:"RelationshipDesignerModule",schemaName:"GroupContentListComponent"};t&&n&&this.googleTagManagerService.track((0,B.merge)(n,t))}getGroupEntitiesCount(t){return t.entities?.length||0}ngOnInit(){this.initializeGroups()}ngOnDestroy(){this._subscription.unsubscribe()}createGroup(){const t={panelClass:["relationship-dialog-edit"],data:{}},n=this.dialogService.open(V,t).subscribe(i=>{this.handleBaseDialogAction(i,this.relationshipDesignerService.createGroup,()=>{this.addGroupToList(i),this.sendGtmAction({action:b.AddGroup})})});this._subscription.add(n)}editGroup(t){const n=Object.assign({},t),i={panelClass:["relationship-dialog-edit"],data:{group:n}},o=this.dialogService.open(V,i).subscribe(r=>{this.handleBaseDialogAction(r,this.relationshipDesignerService.updateGroup,()=>this.updateGroupInList(r))});this._subscription.add(o)}deleteGroup(t){const n=this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(i=>{i&&(this.isLoading=!0,this.relationshipDesignerService.deleteGroup(t).subscribe(o=>{this.handleBaseResponseAction(o,()=>this.deleteGroupFromList(t))}))});this._subscription.add(n)}toggleHighlightGroup(t,n){t?.stopPropagation(),this.highlightedGroupId=n!==this.highlightedGroupId?n:null,this.diagramEventService.highlightGroup(this.highlightedGroupId)}addEntityToGroup(t,n){t?.stopPropagation(),this.doAddEntityToGroup({groupId:n})}editEntityInGroup(t){const n={panelClass:["relationship-dialog-edit"],data:{entityInGroup:Object.assign({},t)}},i=this.dialogService.open(Z,n).subscribe(o=>{this.handleBaseDialogAction(o,this.relationshipDesignerService.updateEntityInGroup,()=>this.updateEntityInGroupInList(o))});this._subscription.add(i)}deleteEntityFromGroup(t,n){const i=this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(o=>{o&&this.relationshipDesignerService.deleteEntityInGroup(t,n).subscribe(r=>{this.handleBaseResponseAction(r,()=>this.deleteEntityInGroupFromList(t,n))})});this._subscription.add(i)}isAddEntityToGroupButtonVisible(){return!this._filteredEntityId}}Y.\u0275fac=function(t){return new(t||Y)(e.\u0275\u0275directiveInject(e.Injector))},Y.\u0275cmp=e.\u0275\u0275defineComponent({type:Y,selectors:[["crt-group-content-list"]],hostVars:2,hostBindings:function(t,n){t&2&&e.\u0275\u0275classProp("rtl",n.isRtl)},inputs:{filteredEntityId:"filteredEntityId",searchFilter:"searchFilter"},outputs:{searchFilterChange:"searchFilterChange",changed:"changed"},decls:2,vars:1,consts:[[1,"group-list"],["class","group-list-item",4,"ngFor","ngForOf"],[1,"group-list-item"],[3,"expanded"],[3,"collapsedHeight","expandedHeight"],[1,"group-list-item-content"],[1,"group-list-item-info"],["matListIcon","",1,"group-icon"],[1,"group-caption-block"],[1,"group-caption"],[1,"group-caption-count"],[1,"group-list-item-actions"],["disableRipple","","mat-icon-button","","class","group-add-icon",3,"click",4,"ngIf"],["disableRipple","","mat-icon-button","",1,"group-menu-button",3,"matMenuTriggerFor","click"],["xPosition","before","yPosition","above",1,"relationship-group-menu"],["matGroupItemMenu","matMenu"],["mat-menu-item","",1,"highlight",3,"click"],["mat-menu-item","",1,"edit",3,"click"],["mat-menu-item","",1,"delete",3,"click"],[1,"group-entity-list"],["class","group-entity-list-item",4,"ngFor","ngForOf"],["disableRipple","","mat-icon-button","",1,"group-add-icon",3,"click"],[1,"group-entity-list-item"],[1,"group-entity-list-item-info"],[1,"entity-logo"],[1,"logo",3,"ngStyle"],[1,"entity-info"],[1,"entity-type"],[1,"entity-name"],[1,"group-entity-list-item-actions"],["disableRipple","","mat-icon-button","",1,"group-menu-button",3,"matMenuTriggerFor"],["matGroupEntityItemMenu","matMenu"],[1,"entity-comment"]],template:function(t,n){t&1&&(e.\u0275\u0275elementStart(0,"mat-list",0),e.\u0275\u0275template(1,Re,21,12,"mat-list-item",1),e.\u0275\u0275elementEnd()),t&2&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.renderedGroups))},dependencies:[g.NgForOf,g.NgIf,g.NgStyle,M.MatLegacyButton,P.MatExpansionPanel,P.MatExpansionPanelHeader,k.MatIcon,f.MatLegacyList,f.MatLegacyListItem,f.MatLegacyListIconCssMatStyler,O.MatLegacyMenu,O.MatLegacyMenuItem,O.MatLegacyMenuTrigger],styles:[".rtl[_nghost-%COMP%]   .group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-icon[_ngcontent-%COMP%]{margin-left:7px;margin-right:0}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]{display:flex}.group-list-item-content[_ngcontent-%COMP%]{display:flex;width:100%;height:33px}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-icon[_ngcontent-%COMP%]{height:12px;width:12px;padding:0;margin-right:7px}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]{width:212px;display:flex;flex-direction:row}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]   .group-caption[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-info[_ngcontent-%COMP%]   .group-caption-block[_ngcontent-%COMP%]   .group-caption-count[_ngcontent-%COMP%]{white-space:pre}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]{display:flex;align-items:center;opacity:0}.group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]   .group-add-icon[_ngcontent-%COMP%]{margin:0}.mat-expansion-panel-header[_ngcontent-%COMP%]:hover   .group-list-item-content[_ngcontent-%COMP%]   .group-list-item-actions[_ngcontent-%COMP%]{opacity:unset}.entity-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.entity-logo[_ngcontent-%COMP%]{min-height:100%;width:42px;display:flex;flex-direction:column;justify-content:center}.entity-logo[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:32px;width:32px;border-radius:16px;background-position:center;background-repeat:no-repeat}"]});const Ae=function(a){return{"background-image":a}};function ke(a,t){if(a&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-list-item",2)(1,"div",3)(2,"div",4),e.\u0275\u0275element(3,"div",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",6)(5,"div",7),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",8)(8,"div"),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",9),e.\u0275\u0275element(11,"button",10),e.\u0275\u0275elementStart(12,"mat-menu",11,12)(14,"button",13),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.edit(r))}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"button",14),e.\u0275\u0275listener("click",function(){const r=e.\u0275\u0275restoreView(n).$implicit,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.delete(r))}),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(16,"div",15),e.\u0275\u0275text(17),e.\u0275\u0275elementEnd()()()()}if(a&2){const n=t.$implicit,i=e.\u0275\u0275reference(13);e.\u0275\u0275advance(3),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(5,Ae,"url("+n.image+")")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.typeCaption),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.entityCaption),e.\u0275\u0275advance(2),e.\u0275\u0275property("matMenuTriggerFor",i),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(n.comment)}}class U{constructor(t){this.injector=t,this.subscription=new c.Subscription,this.isRtl=!1,this.injectDependencies(),this._initializeDirectionality()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}injectDependencies(){this.designerService=this.injector.get(S),this.diagramEventService=this.injector.get(E.BaseDiagramEventService),this.dialogService=this.injector.get(m.DialogService),this.translateService=this.injector.get(u.TranslateService),this.directionality=this.injector.get(q.Directionality),this.relationshipDeleteDialogService=this.injector.get(w)}showErrorDialog(t){if(t?.success)return;const n=t?.errorInfo?.message||"An unknown error occurred during the operation.";this.subscription.add(this.dialogService.openInfoDialog(n).subscribe())}ngOnDestroy(){this.subscription.unsubscribe()}edit(t){this.diagramEventService.elementDoubleClick$.next(t.id)}delete(t){this.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage").subscribe(n=>{n&&this.designerService.deleteConnection(t.originalId).subscribe(i=>{if(!i?.success){this.showErrorDialog(i);return}this.diagramEventService.diagramChanged$.next()})})}}U.\u0275fac=function(t){return new(t||U)(e.\u0275\u0275directiveInject(e.Injector))},U.\u0275cmp=e.\u0275\u0275defineComponent({type:U,selectors:[["crt-related-list"]],hostVars:2,hostBindings:function(t,n){t&2&&e.\u0275\u0275classProp("rtl",n.isRtl)},inputs:{relatedItems:"relatedItems"},decls:2,vars:1,consts:[[1,"related-list"],["class","related-list-item",4,"ngFor","ngForOf"],[1,"related-list-item"],[1,"related-list-item-info"],[1,"related-entity-logo"],[1,"logo",3,"ngStyle"],[1,"related-info"],[1,"related-type-caption"],[1,"related-entity-name"],[1,"related-list-item-actions"],["mat-icon-button","",1,"related-item-menu-button",3,"matMenuTriggerFor"],["xPosition","before","yPosition","above",1,"relationship-group-menu"],["matRelatedItemMenu","matMenu"],["mat-menu-item","",1,"edit",3,"click"],["mat-menu-item","",1,"delete",3,"click"],[1,"related-comment"]],template:function(t,n){t&1&&(e.\u0275\u0275elementStart(0,"mat-list",0),e.\u0275\u0275template(1,ke,18,7,"mat-list-item",1),e.\u0275\u0275elementEnd()),t&2&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",n.relatedItems))},dependencies:[g.NgForOf,g.NgStyle,M.MatLegacyButton,f.MatLegacyList,f.MatLegacyListItem,O.MatLegacyMenu,O.MatLegacyMenuItem,O.MatLegacyMenuTrigger],styles:[".rtl[_nghost-%COMP%]   .related-list-item-info[_ngcontent-%COMP%]   .related-info[_ngcontent-%COMP%]   .related-type-caption[_ngcontent-%COMP%]{padding-right:0;padding-left:20px}.rtl[_nghost-%COMP%]   .related-list-item-info[_ngcontent-%COMP%]   .related-info[_ngcontent-%COMP%]   .related-comment[_ngcontent-%COMP%]{padding-right:0;padding-left:20px}"]});function Be(a,t){a&1&&e.\u0275\u0275element(0,"ts-mask",13)}function Fe(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",18),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Type")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.type)}}function Ze(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",18),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Address")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.address)}}function Ve(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",19),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Phone")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.phone)}}function Ye(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",20),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Email")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.email)}}function He(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-form-field",17)(1,"mat-label"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",20),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,2,"ContainerPropertiesPage.Web")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",n.elementData==null||n.elementData.recordInfo==null?null:n.elementData.recordInfo.web)}}function We(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(5,Fe,5,4,"mat-form-field",16),e.\u0275\u0275template(6,Ze,5,4,"mat-form-field",16),e.\u0275\u0275template(7,Ve,5,4,"mat-form-field",16),e.\u0275\u0275template(8,Ye,5,4,"mat-form-field",16),e.\u0275\u0275template(9,He,5,4,"mat-form-field",16),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,9,"ContainerPropertiesPage.GeneralInformation")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.type)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.address)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.phone)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.email)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!!(!(n.elementData==null||n.elementData.recordInfo==null)&&n.elementData.recordInfo.web))}}function Ue(a,t){if(a&1){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",21),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(n);const r=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(r.addToGroup(o))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"crt-group-content-list",22),e.\u0275\u0275listener("changed",function(){e.\u0275\u0275restoreView(n);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onGroupsChanged())}),e.\u0275\u0275elementEnd()()}if(a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",n.isGroupsChanged),e.\u0275\u0275advance(1),e.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,5,"ContainerPropertiesPage.Groups")),e.\u0275\u0275advance(3),e.\u0275\u0275property("filteredEntityId",n.elementData==null?null:n.elementData.originalId)}}function Qe(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(4,"crt-related-list",23),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.getRelatedContactsCaption()),e.\u0275\u0275advance(1),e.\u0275\u0275property("relatedItems",n.relatedContacts)}}function Je(a,t){if(a&1&&(e.\u0275\u0275elementStart(0,"mat-expansion-panel",14)(1,"mat-expansion-panel-header",15)(2,"mat-panel-title"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(4,"crt-related-list",23),e.\u0275\u0275elementEnd()),a&2){const n=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("collapsedHeight","48px")("expandedHeight","48px"),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.getRelatedAccountsCaption()),e.\u0275\u0275advance(1),e.\u0275\u0275property("relatedItems",n.relatedAccounts)}}const $e=function(a){return{"background-image":a}};class Q extends z{constructor(t){super(t),this.isGroupsChanged=!1,this.pageLink="",this.relatedAccounts=[],this.relatedContacts=[]}injectDependencies(){super.injectDependencies(),this.groupContentListEventService=this.injector.get(G),this.linkGenerator=this.injector.get(ie.LinkGenerator)}subscribeEvents(){super.subscribeEvents(),this.subscription.add(this.groupContentListEventService.isLoading$.subscribe(t=>this.isLoading=t))}onDataInitialized(){super.onDataInitialized(),this.initializePageLinkTool(),this.showMask();const t=this.elementData.originalId||this.elementData.id;this.designerService.getRecordEntityInfo(t).subscribe(n=>{if(!n?.success){this.hideMask(),this.showErrorDialog(n);return}this.initializeRecordEntityInfo(n.recordEntityInfo),this.fillRelatedAccounts(),this.fillRelatedContacts(),this.hideMask()})}initializePageLinkTool(){const t=this.elementConfig.entitySchemaData.name,n=this.elementData.recordId;this.subscription.add(this.linkGenerator.buildPageUrl(t,n).subscribe(i=>this.pageLink=i))}initializeRecordEntityInfo(t){this.elementData.recordInfo=t}isChanged(){return super.isChanged()||this.isGroupsChanged}getRelatedElementCaption(t,n=""){const i=this.translateService.instant("ContainerPropertiesPage.RelationshipsWith"),r=this.getElementConfig(t)?.entitySchemaData?.caption||n;return Se.String.Format(i,r)}getRelatedItems(t){const n=this.elementData.id,i=[],o=p.RelationshipElementType,r=[o.connection,o.indirectConnection],s=t===o.relationshipContainer?"Contact":"Account";return this.elementConfig?.caption===s&&r.push(o.parentConnection),Object.values(this.data.connections).filter(d=>r.includes(d.type)).forEach(d=>{let te;if(d.source===n)te=d.target;else if(d.target===n)te=d.source;else return;const oe=this.data.elements[te];if(oe?.type===t&&oe?.canRead){const ne=oe,ot=ne.largeImage||this.getElementConfig(ne.type).largeImage,at={id:d.id,originalId:d.originalId,image:ot,typeCaption:d.relationshipType.name,entityCaption:ne.caption,comment:d.comment};i.push(at)}}),i}isDescriptionVisible(){const t=this.elementData?.recordInfo||{};return!!t.type||!!t.address||!!t.phone||!!t.email||!!t.web}onGroupsChanged(){this.isGroupsChanged=!0}isGroupVisible(){return this.elementConfig?.caption==="Contact"}isRelatedAccountsVisible(){return!0}isRelatedContactsVisible(){return!0}addToGroup(t){t.stopPropagation();const n={entityId:this.elementData.originalId};this.groupContentListEventService.addEntityToGroup(n)}fillRelatedAccounts(){this.relatedAccounts=this.getRelatedItems(p.RelationshipElementType.relationshipContainer)}fillRelatedContacts(){this.relatedContacts=this.getRelatedItems(p.RelationshipElementType.relationshipItem)}getRelatedContactsCaption(){return this.getRelatedElementCaption(p.RelationshipElementType.relationshipItem)}getRelatedAccountsCaption(){return this.getRelatedElementCaption(p.RelationshipElementType.relationshipContainer)}}Q.\u0275fac=function(t){return new(t||Q)(e.\u0275\u0275directiveInject(e.Injector))},Q.\u0275cmp=e.\u0275\u0275defineComponent({type:Q,selectors:[["crt-container-properties-page"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:19,vars:11,consts:[["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo",3,"ngStyle"],[1,"title"],[1,"sub-title"],[1,"tools-group-wrap"],[1,"entity-info"],[1,"tools"],["target","_blank",1,"tool","open-card",3,"href"],[1,"content"],[3,"expanded",4,"ngIf"],[1,"component-mask"],[3,"expanded"],[3,"collapsedHeight","expandedHeight"],["floatLabel","always",4,"ngIf"],["floatLabel","always"],["type","text","matInput","","disabled","",3,"value"],["type","tel","matInput","","disabled","",3,"value"],["type","email","matInput","","disabled","",3,"value"],["mat-icon-button","",1,"group-add-icon",3,"click"],[3,"filteredEntityId","changed"],[3,"relatedItems"]],template:function(t,n){t&1&&(e.\u0275\u0275template(0,Be,1,0,"ts-mask",0),e.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3),e.\u0275\u0275element(4,"div",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",5)(6,"div",6),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div"),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(10,"div",7),e.\u0275\u0275element(11,"div",8),e.\u0275\u0275elementStart(12,"div",9),e.\u0275\u0275element(13,"a",10),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(14,"div",11),e.\u0275\u0275template(15,We,10,11,"mat-expansion-panel",12),e.\u0275\u0275template(16,Ue,7,7,"mat-expansion-panel",12),e.\u0275\u0275template(17,Qe,5,5,"mat-expansion-panel",12),e.\u0275\u0275template(18,Je,5,5,"mat-expansion-panel",12),e.\u0275\u0275elementEnd()),t&2&&(e.\u0275\u0275property("ngIf",n.isLoading),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(9,$e,"url("+(n.elementData==null?null:n.elementData.largeImage)+")")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.elementData==null?null:n.elementData.subCaption),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(n.elementData==null?null:n.elementData.caption),e.\u0275\u0275advance(4),e.\u0275\u0275property("href",n.pageLink,e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",n.isDescriptionVisible()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isGroupVisible()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isRelatedContactsVisible()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.isRelatedAccountsVisible()))},dependencies:[g.NgIf,g.NgStyle,m.MaskComponent,M.MatLegacyButton,P.MatExpansionPanel,P.MatExpansionPanelHeader,P.MatExpansionPanelTitle,C.MatLegacyFormField,C.MatLegacyLabel,v.MatLegacyInput,Y,U,u.TranslatePipe],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",".rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{margin-right:-10px}.header[_ngcontent-%COMP%]{display:flex;min-height:97px;justify-content:space-between}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%;width:100%;max-width:290px;min-width:290px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-size:contain;width:100%;height:100%}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:0;height:49px;margin-bottom:2px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:29px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{min-width:24px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .entity-info[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;align-items:center;width:50%}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{width:50%;align-items:flex-start}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTEiIGhlaWdodD0iMTEiIHZpZXdCb3g9IjAgMCAxMSAxMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjE3NTUzIDAuODAxODE3QzYuMTc1NTMgMC4zNTg5ODYgNi41MzQ1MiAwIDYuOTc3MzUgMEgxMC4xMDE3QzEwLjU5NzUgMCAxMC45OTk1IDAuNDAxOTggMTAuOTk5NSAwLjg5Nzg0M1Y0LjAyMjE3QzEwLjk5OTUgNC40NjUgMTAuNjQwNSA0LjgyMzk4IDEwLjE5NzcgNC44MjM5OEM5Ljc1NDg3IDQuODIzOTggOS4zOTU4OCA0LjQ2NSA5LjM5NTg4IDQuMDIyMTdWMi43Mzk5M0w1LjExMTA0IDcuMDM0MDhDNC43OTgyNSA3LjM0NzU1IDQuMjkwNTcgNy4zNDgxIDMuOTc3MSA3LjAzNTMxQzMuNjYzNjMgNi43MjI1MiAzLjY2MzA4IDYuMjE0ODQgMy45NzU4NyA1LjkwMTM3TDguMjY0MyAxLjYwMzYzSDYuOTc3MzVDNi41MzQ1MiAxLjYwMzYzIDYuMTc1NTMgMS4yNDQ2NSA2LjE3NTUzIDAuODAxODE3Wk0yLjcyMjM0IDEuNjAzNjNDMi4xMDQ0OSAxLjYwMzYzIDEuNjAzNjMgMi4xMDQ0OSAxLjYwMzYzIDIuNzIyMzRWOC4yNzc1OUMxLjYwMzYzIDguODk1NDMgMi4xMDQ0OSA5LjM5NjI5IDIuNzIyMzQgOS4zOTYyOUg4LjI3NzU5QzguODk1NDMgOS4zOTYyOSA5LjM5NjI5IDguODk1NDMgOS4zOTYyOSA4LjI3NzU5VjcuMjgxMzlDOS4zOTYyOSA2LjgzODU2IDkuNzU1MjcgNi40Nzk1OCAxMC4xOTgxIDYuNDc5NThDMTAuNjQwOSA2LjQ3OTU4IDEwLjk5OTkgNi44Mzg1NiAxMC45OTk5IDcuMjgxMzlWOC4yNzc1OUMxMC45OTk5IDkuNzgxMDkgOS43ODEwOSAxMC45OTk5IDguMjc3NTkgMTAuOTk5OUgyLjcyMjM0QzEuMjE4ODMgMTAuOTk5OSAwIDkuNzgxMDkgMCA4LjI3NzU5VjIuNzIyMzRDMCAxLjIxODgzIDEuMjE4ODMgMCAyLjcyMjM0IDBIMy42ODc0NkM0LjEzMDI5IDAgNC40ODkyOCAwLjM1ODk4NiA0LjQ4OTI4IDAuODAxODE3QzQuNDg5MjggMS4yNDQ2NSA0LjEzMDI5IDEuNjAzNjMgMy42ODc0NiAxLjYwMzYzSDIuNzIyMzRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K);background-position:center;background-repeat:no-repeat}.content[_ngcontent-%COMP%]{top:99px;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.content[_ngcontent-%COMP%]   .mat-divider[_ngcontent-%COMP%]{padding-bottom:0;margin-top:0}.content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]   .group-add-icon[_ngcontent-%COMP%]{margin:0;opacity:0}.content[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]:hover   .group-add-icon[_ngcontent-%COMP%]{opacity:unset}"]});function Xe(a,t){a&1&&e.\u0275\u0275element(0,"ts-mask",15)}class J extends z{constructor(t){super(t),this.isGroupsChanged=!1,this.searchFilter=""}injectDependencies(){super.injectDependencies(),this.groupContentListEventService=this.injector.get(G)}subscribeEvents(){super.subscribeEvents(),this.subscription.add(this.groupContentListEventService.isLoading$.subscribe(t=>this.isLoading=t))}isChanged(){return super.isChanged()||this.isGroupsChanged}onGroupsChanged(){this.isGroupsChanged=!0}createGroup(){this.groupContentListEventService.createGroup()}onSearchFilterValueChanged(t){this.searchFilter=t}}J.\u0275fac=function(t){return new(t||J)(e.\u0275\u0275directiveInject(e.Injector))},J.\u0275cmp=e.\u0275\u0275defineComponent({type:J,selectors:[["crt-groups-properties-page"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:18,vars:9,consts:[["class","component-mask",4,"ngIf"],[1,"header"],[1,"title-wrap"],[1,"logo-wrap"],[1,"logo"],[1,"title"],[1,"tools-group-wrap"],[1,"search-tool"],["floatLabel","never",1,"search-input"],["matInput","","type","text","spellcheck","false","autocomplete","off",1,"search-input-field",3,"placeholder","value","keyup"],["matSuffix","",1,"search-icon"],[1,"tools"],["mat-icon-button","",1,"tool","add-icon",3,"click"],[1,"content"],[3,"searchFilter","searchFilterChange","changed"],[1,"component-mask"]],template:function(t,n){t&1&&(e.\u0275\u0275template(0,Xe,1,0,"ts-mask",0),e.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3),e.\u0275\u0275element(4,"div",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",5),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"div",6)(9,"div",7)(10,"mat-form-field",8)(11,"input",9),e.\u0275\u0275listener("keyup",function(o){return n.onSearchFilterValueChanged(o.target.value)}),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"mat-icon",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(14,"div",11)(15,"button",12),e.\u0275\u0275listener("click",function(){return n.createGroup()}),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(16,"div",13)(17,"crt-group-content-list",14),e.\u0275\u0275listener("searchFilterChange",function(o){return n.searchFilter=o})("changed",function(){return n.onGroupsChanged()}),e.\u0275\u0275elementEnd()()),t&2&&(e.\u0275\u0275property("ngIf",n.isLoading),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,5,"GroupsPropertiesPage.Title")),e.\u0275\u0275advance(5),e.\u0275\u0275property("placeholder",e.\u0275\u0275pipeBind1(12,7,"GroupsPropertiesPage.Search"))("value",n.searchFilter),e.\u0275\u0275advance(6),e.\u0275\u0275property("searchFilter",n.searchFilter))},dependencies:[g.NgIf,m.MaskComponent,M.MatLegacyButton,k.MatIcon,C.MatLegacyFormField,C.MatLegacySuffix,v.MatLegacyInput,Y,u.TranslatePipe],styles:["[_nghost-%COMP%]{display:block;position:relative;height:100%}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-right:0}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin-right:10px;text-align:right}.rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.open-card[_ngcontent-%COMP%]{transform:rotate(-90deg)}.rtl[_nghost-%COMP%]   .content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:right}.header[_ngcontent-%COMP%]{max-width:343px;padding:12px 20px 0;min-height:97px;max-height:135px;border-top-left-radius:8px;border-top-right-radius:8px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]{height:56px;margin-top:5px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]{margin-top:7px;flex:0 0 69px;width:72px;height:56px;display:inline-flex;justify-content:center;align-items:center;margin-right:16px}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background-position:center;background-repeat:no-repeat}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:inline-block;letter-spacing:0px;text-align:left;margin-top:3px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;margin-top:7px;margin-right:10px;justify-content:flex-end;align-items:center}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;font-size:16px}.content[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;width:100%;position:absolute;overflow-x:hidden;overflow-y:auto;height:auto;bottom:0;top:135px}.content[_ngcontent-%COMP%]:last-child{padding-bottom:0}.content[_ngcontent-%COMP%]   .text-area[_ngcontent-%COMP%]{min-width:150px;width:100%}.content[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{text-align:left;letter-spacing:0px}",".rtl[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{display:flex}.header[_ngcontent-%COMP%]   .title-wrap[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzOS4xOTEiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzOS4xOTEgMzIiPjxkZWZzPjxzdHlsZT4uYSwuYntmaWxsOm5vbmU7fS5he3N0cm9rZTojMDA2Y2UwO3N0cm9rZS1taXRlcmxpbWl0OjEwO308L3N0eWxlPjwvZGVmcz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjM5NCAtMC40MDMpIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjEwNiA1LjUzMikiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwMi42MTYsNDc5LjQ2N2E1LjUyOSw1LjUyOSwwLDAsMC01LjUyNy01LjUzMiw1LjUzNSw1LjUzNSwwLDAsMC01LjUzNiw1LjUzMkE1LjUzNyw1LjUzNywwLDAsMC0zMDguMTQ0LDQ4NSw1LjUzMSw1LjUzMSwwLDAsMC0zMDIuNjE2LDQ3OS40NjdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMjMuMjQ0IC00NzIuOTM1KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwNS41MzIsNDg3LjU3M2g3Ljk4MWMwLTQtMy4wMjctNi42MzgtNy41NzItNi42MzhhOS41LDkuNSwwLDAsMC0zLjQ5Mi42MTciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMzMS43NDIgLTQ2OC40NDYpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMjk5Ljc2NCw0NzkuODZhNC40MjcsNC40MjcsMCwwLDAtNC40MjUtNC40MjUsNC40MjYsNC40MjYsMCwwLDAtNC40MjUsNC40MjUsNC40MjcsNC40MjcsMCwwLDAsNC40MjUsNC40MzJBNC40MjksNC40MjksMCwwLDAtMjk5Ljc2NCw0NzkuODZaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMzAuNzQ1IC00NzIuMTE2KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMxMC43NTEsNDg3LjU3M2gtNy45NzljMC00LDMuMDI4LTYuNjM4LDcuNTctNi42MzhhOS41MjcsOS41MjcsMCwwLDEsMy40OTMuNjE3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTQuNzMgLTQ2OC40NDYpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzE3LjYxNSw0NzkuODZhNC40MjQsNC40MjQsMCwwLDEsNC40MjMtNC40MjUsNC40Myw0LjQzLDAsMCwxLDQuNDI4LDQuNDI1LDQuNDMyLDQuNDMyLDAsMCwxLTQuNDI4LDQuNDMyQTQuNDI1LDQuNDI1LDAsMCwxLTMxNy42MTUsNDc5Ljg2WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzE2LjgzIC00NzIuMTE2KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTI5OC43NjQsNDg5Ljc4NmMwLTUuMzMtMy4zODMtOC44NTEtOC40NTctOC44NTFzLTguNDU3LDMuNTIxLTguNDU3LDguODUxWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzIyLjMxNiAtNDY4LjQ0NikiLz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAwLjQwMykiLz48L2c+PC9zdmc+);width:40px;height:32px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]{width:100%;padding-right:10px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-input[_ngcontent-%COMP%]{width:100%}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{font-size:16px}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .search-tool[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]:before{margin-top:10px;position:absolute}.header[_ngcontent-%COMP%]   .tools-group-wrap[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .add-icon[_ngcontent-%COMP%]{margin-bottom:6px;font-size:18px;height:24px;width:24px}"]});const Ke=["card"];function qe(a,t){a&1&&e.\u0275\u0275element(0,"ts-mask",12)}function et(a,t){}const tt=[[["","caption",""]],[["","tools",""]]],nt=function(a){return{pressed:a}},it=["[caption]","[tools]"];class H{get diagramData(){return this._config?.data}get diagramConfig(){return this._config?.config}set data(t){t!==this._inputData&&(this._inputData=t,this.clearDiagramData(),this.loadDiagram())}_showResponseErorrs(t){if(t.length){const i=(0,B.uniq)(t).join(`
	`);this.showErrorDialog(i)}}_getDeleteItem(t){return new Promise(n=>{this._getDeleteItemObservable(t.id,t.originalId).subscribe(o=>{o?.success?n():n(this.getErrorResponseMessage(o))})})}_getDeleteItemObservable(t,n){return this.diagramData.connections[t]?this.designerService.deleteConnection(n):this.designerService.deleteEntity(n)}_getItem(t){return this.diagramData.elements[t]||this.diagramData.connections[t]}_getElementConfig(t){return t&&this.diagramConfig?.customDiagramElements[t]}_getCardTypeByElementId(t){const n=this._getItem(t);if(!n)throw new Error(`Not found element with id: ${t}`);return this._getCardTypeElementType(n.type)}_getCardTypeElementType(t){switch(t){case p.RelationshipElementType.relationshipContainer:case p.RelationshipElementType.relationshipItem:return Q;case p.RelationshipElementType.connection:case p.RelationshipElementType.indirectConnection:case p.RelationshipElementType.parentConnection:return R;default:throw new Error(`Not implemented properties page for type: ${t}`)}}_confirmRemoving(){var t=this;return(0,y.Z)(function*(){return yield(0,c.firstValueFrom)(t.relationshipDeleteDialogService.confirmRemoving("RelationshipDesigner.DeleteItemMessage"))})()}_getExistDiagramItems(t){const n=[];return t.forEach(i=>{const o=this._getItem(i);o&&n.push(o)}),n}_deleteEntities(t){var n=this;return(0,y.Z)(function*(){n.showMask();const o=n._getExistDiagramItems(t).map(s=>n._getDeleteItem(s));let r=!1;return yield Promise.all(o).then(s=>{s=s.filter(d=>d&&d!==""),n._showResponseErorrs(s),r=s.length<t.length}),n.sendGtmAction({action:b.DeleteElement}),n.hideMask(),r})()}_initializeDirectionality(){this.isRtl=this.directionality?.value==="rtl"}_initializeGTM(){this._subscription.add(this.googleTagManagerService.initialize().subscribe())}constructor(t){this.injector=t,this._subscription=new c.Subscription,this.allowFullScreenMode=!0,this.isCardShowed=!1,this.isLoading=!1,this.isLoadingPending=!1,this.showMaskDelay=100,this.isGroupsCardOpen=!1,this.isFullscreenMode=!1,this.isRtl=!1,this.injectDependencies(),this.subscribeEvents(),this._initializeDirectionality(),this._initializeGTM()}showMask(){this.isLoadingPending=!0,setTimeout(()=>{this.isLoadingPending&&(this.isLoading=!0)},this.showMaskDelay)}hideMask(){this.isLoadingPending=!1,this.isLoading=!1,this.changeDetector.detectChanges()}injectDependencies(){this.changeDetector=this.injector.get(e.ChangeDetectorRef),this.designerService=this.injector.get(S),this.diagramEventService=this.injector.get(p.BaseDiagramEventService),this.propertiesPageEventService=this.injector.get(j),this.dialogService=this.injector.get(m.DialogService),this.translateService=this.injector.get(u.TranslateService),this.notifyService=this.injector.get(m.NotifyService),this.directionality=this.injector.get(q.Directionality),this.googleTagManagerService=this.injector.get(ie.GoogleTagManagerService),this.relationshipDeleteDialogService=this.injector.get(w)}subscribeEvents(){this.subscribeDiagramEvents()}subscribeDiagramEvents(){var t=this;const n=this.diagramEventService;[n.itemSelected$.subscribe(o=>{this.onItemSelected(o)}),n.highlightedGroup$.subscribe(o=>{this.onGroupHighlighted(o)}),n.elementDoubleClick$.subscribe(o=>{this.onElementDoubleClick(o)}),n.elementRemoving$.subscribe(function(){var o=(0,y.Z)(function*(r){yield t.onElementRemoving(r)});return function(r){return o.apply(this,arguments)}}()),n.connectionAdding$.subscribe(o=>{this.onConnectionAdding(o)}),n.showMessage$.subscribe(o=>{this.notifyService.show({message:o,translate:!1,panelClass:"relationship-notify"}).then()}),n.connectionReconnect$.subscribe(function(){var o=(0,y.Z)(function*(r){yield t.onConnectionReconnect(r)});return function(r){return o.apply(this,arguments)}}()),n.entityInGroupAdded$.subscribe((0,y.Z)(function*(){t.loadDiagram()})),n.entityInGroupRemoving$.subscribe((0,y.Z)(function*(){t.loadDiagram()})),n.diagramChanged$.subscribe((0,y.Z)(function*(){t.loadDiagram()})),this.propertiesPageEventService.doCloseCard().subscribe(function(){var o=(0,y.Z)(function*(r){return yield t.closeCard(r)});return function(r){return o.apply(this,arguments)}}())].forEach(o=>{this._subscription.add(o)})}loadDiagram(){this.showMask();const t=this._inputData;if(!t?.selectedRecordId||!t?.schemaName){this.clearDiagramData(),this.hideMask();return}this.designerService.getDiagram(t.selectedRecordId,t.schemaName).subscribe(n=>{if(n?.success)this.initializeDesignerConfig({data:n.data,config:n.config});else{const i=this.getErrorResponseMessage(n);this.showErrorDialog(i)}this.hideMask()})}initializeDesignerConfig(t){this._config=t,this.propertiesPageEventService.setDesignerConfig(t),this.initializeDiagram(t.config),this.loadDataToDiagram(t.data)}initializeDiagram(t){this.initializeDiagramLocalizableStrings(t),this.diagramEventService.setDiagramConfig({dialogService:this.dialogService,translateService:this.translateService,...t})}initializeDiagramLocalizableStrings(t){this.initializeDiagramToolsLocalizableStrings(t)}initializeDiagramToolsLocalizableStrings(t){const n=t.customLocalizableStrings||{},i={};["FitToView","ResetView","ZoomIn","ZoomOut","MiniMapClose","MiniMapOpen"].forEach(r=>{const s=this.translateService.instant("RelationshipDiagram.Tools."+r);r=(0,ge.unCapitalizeFirstLetter)(r),i[r]=s}),t.customLocalizableStrings=Object.assign(i,n)}loadDataToDiagram(t){this.diagramEventService.endLoading$.next(t)}openCardByElementId(t){var n=this;return(0,y.Z)(function*(){let i=null;if(t){const o=n._getCardTypeByElementId(t);if(i=yield n.openCard(o),!i)return;i.id$.next(t)}return i})()}openCard(t){var n=this;return(0,y.Z)(function*(){if(!(yield n.closeCard()))return;const o=n.card.createComponent(t);return n.isCardShowed=!0,o.instance})()}closeCard(t){return(0,c.lastValueFrom)(new c.Observable(n=>{t?.isForced?(this.forceCloseCard(t),n.next(!0),n.complete()):this.isCardShowed?this.saveAndCloseCard(n):(this.clearCardContainer(),n.next(!0),n.complete())}),{defaultValue:null})}forceCloseCard(t){this.clearCardContainer(),t.isNeedDiagramReload&&this.loadDiagram()}saveAndCloseCard(t){const n=this.propertiesPageEventService.saveCard().pipe((0,D.first)()).subscribe(i=>{const o=i?.success;o&&(this.clearCardContainer(),i.isChanged&&this.loadDiagram()),t.next(o),t.complete()});this._subscription.add(n)}clearCardContainer(){this.card.clear(),this.isCardShowed=!1,this.isGroupsCardOpen=!1}getErrorResponseMessage(t){return t?.errorInfo?.message||"An unknown error occurred during the operation."}showErrorDialog(t){this.hideMask(),this._subscription.add(this.dialogService.openInfoDialog(t).subscribe())}getDefaultRelationshipType(t,n){return{connectionType:this.getDefaultConnectionType(t,n)}}getDefaultConnectionType(t,n){const i=this._getItem(t),o=this._getItem(n);return i&&o?K.getDefaultConnectionType(i,o):L.formal}clearDiagramData(){this.loadDataToDiagram({})}sendGtmAction(t){const n={moduleName:"RelationshipDesignerModule",schemaName:"RelationshipDesignerComponent"};t&&n&&this.googleTagManagerService.track((0,B.merge)(n,t))}ngOnDestroy(){this._subscription.unsubscribe()}onItemSelected(t){var n=this;return(0,y.Z)(function*(){t||(yield n.closeCard())})()}onGroupHighlighted(t){this.diagramComponent.get("eventBus").fire("relationshipGroup.highlight.changed",{id:t})}onElementDoubleClick(t){var n=this;return(0,y.Z)(function*(){t?yield n.openCardByElementId(t):yield n.closeCard()})()}onElementRemoving(t){var n=this;return(0,y.Z)(function*(){(yield n._confirmRemoving())&&(yield n.closeCard({isForced:!0,isNeedDiagramReload:!1}),(yield n._deleteEntities(t))&&n.loadDiagram())})()}onConnectionAdding(t){var n=this;return(0,y.Z)(function*(){const i=yield n.openCard(R);i&&(i.elementData={id:t.id,source:t.source,target:t.target,relationshipType:n.getDefaultRelationshipType(t.source,t.target),isNew:!0},i.targetConfig=n._getElementConfig(t.targetType),i.id$.next(t.id||(0,_.generateGuid)()))})()}onConnectionReconnect(t){var n=this;return(0,y.Z)(function*(){yield n._deleteEntities([t.id]);const i=yield n.openCard(R);i&&(i.elementData={source:t.source,target:t.target,relationshipType:n.getDefaultRelationshipType(t.source,t.target),isNew:!0},i.id$.next((0,_.generateGuid)()))})()}showGroupsCard(){var t=this;return(0,y.Z)(function*(){if(t.isGroupsCardOpen)yield t.closeCard(),t.isGroupsCardOpen=!1;else{const n=yield t.openCard(J);n&&(n.id$.next((0,_.generateGuid)()),t.isGroupsCardOpen=!0)}})()}toggleFullscreenMode(){this.isFullscreenMode=!this.isFullscreenMode}}H.\u0275fac=function(t){return new(t||H)(e.\u0275\u0275directiveInject(e.Injector))},H.\u0275cmp=e.\u0275\u0275defineComponent({type:H,selectors:[["crt-relationship-designer"]],viewQuery:function(t,n){if(t&1&&(e.\u0275\u0275viewQuery(Ke,7,e.ViewContainerRef),e.\u0275\u0275viewQuery(p.RelationshipDiagramComponent,7)),t&2){let i;e.\u0275\u0275queryRefresh(i=e.\u0275\u0275loadQuery())&&(n.card=i.first),e.\u0275\u0275queryRefresh(i=e.\u0275\u0275loadQuery())&&(n.diagramComponent=i.first)}},hostVars:4,hostBindings:function(t,n){t&2&&e.\u0275\u0275classProp("fullscreen",n.isFullscreenMode)("rtl",n.isRtl)},inputs:{data:"data",allowFullScreenMode:"allowFullScreenMode"},ngContentSelectors:it,decls:15,vars:8,consts:[["class","component-mask",4,"ngIf"],[1,"designer-tools-panel"],[1,"caption-content-container"],[1,"modes"],[1,"tools"],["mat-icon-button","",1,"tool","group",3,"ngClass","click"],["mat-icon-button","",1,"tool","fullscreen",3,"click"],[1,"additional-tools-container"],[1,"designer-content"],[1,"diagram-wrap"],[1,"card-wrap"],["card",""],[1,"component-mask"]],template:function(t,n){t&1&&(e.\u0275\u0275projectionDef(tt),e.\u0275\u0275template(0,qe,1,0,"ts-mask",0),e.\u0275\u0275elementStart(1,"div",1)(2,"div",2),e.\u0275\u0275projection(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"div",3),e.\u0275\u0275elementStart(5,"div",4)(6,"button",5),e.\u0275\u0275listener("click",function(){return n.showGroupsCard()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"button",6),e.\u0275\u0275listener("click",function(){return n.toggleFullscreenMode()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",7),e.\u0275\u0275projection(9,1),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(10,"div",8),e.\u0275\u0275element(11,"crt-relationship-diagram",9),e.\u0275\u0275elementStart(12,"div",10),e.\u0275\u0275template(13,et,0,0,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()()),t&2&&(e.\u0275\u0275property("ngIf",n.isLoading),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(6,nt,n.isGroupsCardOpen)),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("hidden",!n.allowFullScreenMode),e.\u0275\u0275advance(5),e.\u0275\u0275classProp("card-hidden",!n.isCardShowed))},dependencies:[g.NgClass,g.NgIf,m.MaskComponent,M.MatLegacyButton,p.RelationshipDiagramComponent],styles:["[_nghost-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;position:relative}.fullscreen[_nghost-%COMP%]{position:fixed;z-index:1999;top:0;left:0;width:100%;height:100%;background:#fff}.fullscreen[_nghost-%COMP%]   .designer-content[_ngcontent-%COMP%]{height:calc(100vh - 50px)}.fullscreen[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiI+CiAgPGRlZnM+CiAgICA8c3R5bGU+CiAgICAgIC5he2ZpbGw6IzU0NjU3ZH0uYntmaWxsOm5vbmU7c3Ryb2tlOiM1NDY1N2Q7c3Ryb2tlLW1pdGVybGltaXQ6MTB9CiAgICA8L3N0eWxlPgogIDwvZGVmcz4KICA8cGF0aCBjbGFzcz0iYSIgZD0iTTE0LjAwMyA4aC01VjN6TTguMDAzIDE0VjloLTV6Ii8+CiAgPHBhdGggY2xhc3M9ImIiIGQ9Ik0zIDE0bDQtNE0xMCA3bDQtNCIvPgogIDxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0wIDBoMTZ2MTZIMHoiLz4KPC9zdmc+Cg==) no-repeat center}.fullscreen[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzY3OF8xIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA2Nzgg4oCTIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xODA4LjU5NyA2OCkiIGZpbGw9IiMwMDZjZTAiLz4NCiAgPHBhdGggaWQ9IlBhdGhfNjA1OCIgZGF0YS1uYW1lPSJQYXRoIDYwNTgiIGQ9Ik0xODI5LjYtNjd2LTVoLTVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgyMS41OTcgODEpIiBmaWxsPSIjMDA2Y2UwIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU3OSIgZGF0YS1uYW1lPSJMaW5lIDU3OSIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDEwKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDA2Y2UwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMSIvPg0KICA8bGluZSBpZD0iTGluZV81ODAiIGRhdGEtbmFtZT0iTGluZSA1ODAiIHkxPSI0IiB4Mj0iNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAgMykiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwNmNlMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEiLz4NCiAgPHJlY3QgaWQ9IlJlY3RhbmdsZV82Mjc2IiBkYXRhLW5hbWU9IlJlY3RhbmdsZSA2Mjc2IiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIGZpbGw9Im5vbmUiLz4NCjwvc3ZnPg0K) no-repeat center}.rtl[_nghost-%COMP%]   .designer-content[_ngcontent-%COMP%]{direction:rtl;text-align:right}.rtl[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{margin-right:10px;margin-left:10px}.rtl[_nghost-%COMP%]   .designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{transform:rotate(90deg)}.fullscreen-overlay[_ngcontent-%COMP%]{position:fixed;width:100%;height:100%;top:0;left:0;opacity:.4;background-color:#fff;z-index:1998}.designer-tools-panel[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;height:48px;border:1px solid #dbdbdb;border-radius:8px}.designer-tools-panel[_ngcontent-%COMP%]   .modes[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.designer-tools-panel[_ngcontent-%COMP%]   .caption-content-container[_ngcontent-%COMP%]{width:100%}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch;justify-content:flex-end;align-items:center;min-width:345px}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool[_ngcontent-%COMP%]{width:16px;height:16px;margin-right:22px}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpub25lO30uYXtzdHJva2U6IzU0NjU3ZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzE5LjExNiAtNDcxLjQzNSkiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwOC42OCw0NzYuNDM1YTIuNSwyLjUsMCwwLDAtMi41LTIuNSwyLjUsMi41LDAsMCwwLTIuNSwyLjUsMi41LDIuNSwwLDAsMCwyLjUsMi41QTIuNSwyLjUsMCwwLDAtMzA4LjY4LDQ3Ni40MzVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA2NCkiLz48cGF0aCBjbGFzcz0iYSIgZD0iTS0zMDcuMjIyLDQ4My45MzVoMy42MDdjMC0xLjgwNi0xLjM2OC0zLTMuNDIyLTNhNC4yOTQsNC4yOTQsMCwwLDAtMS41NzguMjc5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC4wMDEpIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzA0LjYxNSw0NzcuNDM1YTIsMiwwLDAsMC0yLTIsMiwyLDAsMCwwLTIsMiwyLDIsMCwwLDAsMiwyQTIsMiwwLDAsMC0zMDQuNjE1LDQ3Ny40MzVaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0tMzE1LjEyNCw0ODMuOTM1aC0zLjYwNmMwLTEuODA2LDEuMzY5LTMsMy40MjEtM2E0LjMwNiw0LjMwNiwwLDAsMSwxLjU3OS4yNzkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMTE0KSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMxNy42MTUsNDc3LjQzNWEyLDIsMCwwLDEsMi0yLDIsMiwwLDAsMSwyLDIsMiwyLDAsMCwxLTIsMkEyLDIsMCwwLDEtMzE3LjYxNSw0NzcuNDM1WiIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMwNi42NzgsNDg0LjkzNWMwLTIuNDA5LTEuOC00LTQuNS00cy00LjUsMS41OTEtNC41LDRaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjA2MikiLz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIvPjwvc3ZnPg==) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojMDA2Y2UwO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJhIiBkPSJNOCw5Yy0yLjk5MSwwLTUsMS44MDktNSw0LjVWMTRIMTN2LS41QzEzLDEwLjgwOSwxMC45OSw5LDgsOVoiLz48Y2lyY2xlIGNsYXNzPSJhIiBjeD0iMyIgY3k9IjMiIHI9IjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUgMikiLz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMiw5aC0uMzc5YTUuMTU1LDUuMTU1LDAsMCwxLDIuMzU1LDRIMTZ2LS41QzE2LDEwLjQ0LDE0LjM1NSw5LDEyLDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik00LDloLjM3OWE1LjE1NSw1LjE1NSwwLDAsMC0yLjM1NSw0SDB2LS41QzAsMTAuNDQsMS42NDUsOSw0LDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMi41LDMuNWEyLjQ3NiwyLjQ3NiwwLDAsMC0uNzU4LjEzLDMuOTI2LDMuOTI2LDAsMCwxLS45MjYsNC4yMDZBMi41LDIuNSwwLDEsMCwxMi41LDMuNVoiLz48cGF0aCBjbGFzcz0iYSIgZD0iTTMuNSwzLjVhMi40NzYsMi40NzYsMCwwLDEsLjc1OC4xMywzLjkyNiwzLjkyNiwwLDAsMCwuOTI2LDQuMjA2QTIuNSwyLjUsMCwxLDEsMy41LDMuNVoiLz48L3N2Zz4=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.group.pressed[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojMDA2Y2UwO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJhIiBkPSJNOCw5Yy0yLjk5MSwwLTUsMS44MDktNSw0LjVWMTRIMTN2LS41QzEzLDEwLjgwOSwxMC45OSw5LDgsOVoiLz48Y2lyY2xlIGNsYXNzPSJhIiBjeD0iMyIgY3k9IjMiIHI9IjMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUgMikiLz48cmVjdCBjbGFzcz0iYiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMiw5aC0uMzc5YTUuMTU1LDUuMTU1LDAsMCwxLDIuMzU1LDRIMTZ2LS41QzE2LDEwLjQ0LDE0LjM1NSw5LDEyLDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik00LDloLjM3OWE1LjE1NSw1LjE1NSwwLDAsMC0yLjM1NSw0SDB2LS41QzAsMTAuNDQsMS42NDUsOSw0LDlaIi8+PHBhdGggY2xhc3M9ImEiIGQ9Ik0xMi41LDMuNWEyLjQ3NiwyLjQ3NiwwLDAsMC0uNzU4LjEzLDMuOTI2LDMuOTI2LDAsMCwxLS45MjYsNC4yMDZBMi41LDIuNSwwLDEsMCwxMi41LDMuNVoiLz48cGF0aCBjbGFzcz0iYSIgZD0iTTMuNSwzLjVhMi40NzYsMi40NzYsMCwwLDEsLjc1OC4xMywzLjkyNiwzLjkyNiwwLDAsMCwuOTI2LDQuMjA2QTIuNSwyLjUsMCwxLDEsMy41LDMuNVoiLz48L3N2Zz4=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzUwN18zIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA1MDcg4oCTIDMiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8ZyBpZD0iR3JvdXBfNTgxMSIgZGF0YS1uYW1lPSJHcm91cCA1ODExIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgxNS41OTcgNzQpIj4NCiAgICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIGZpbGw9IiM1NDY1N2QiLz4NCiAgICA8cGF0aCBpZD0iUGF0aF82MDU4IiBkYXRhLW5hbWU9IlBhdGggNjA1OCIgZD0iTTE4MjkuNi02N3YtNWgtNVoiIGZpbGw9IiM1NDY1N2QiLz4NCiAgICA8bGluZSBpZD0iTGluZV81NzkiIGRhdGEtbmFtZT0iTGluZSA1NzkiIHkxPSI0IiB4Mj0iNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTgyNC41OTcgLTcxKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNTQ2NTdkIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMSIvPg0KICAgIDxsaW5lIGlkPSJMaW5lXzU4MCIgZGF0YS1uYW1lPSJMaW5lIDU4MCIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODE4LjU5NyAtNjUpIiBmaWxsPSJub25lIiBzdHJva2U9IiM1NDY1N2QiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogICAgPHJlY3QgaWQ9IlJlY3RhbmdsZV82Mjc2IiBkYXRhLW5hbWU9IlJlY3RhbmdsZSA2Mjc2IiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE4MTUuNTk3IC03NCkiIGZpbGw9Im5vbmUiLz4NCiAgPC9nPg0KPC9zdmc+DQo=) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen[_ngcontent-%COMP%]:hover{background:url(data:image/svg+xml;base64,PHN2ZyBpZD0iQ29tcG9uZW50XzY3OV8xIiBkYXRhLW5hbWU9IkNvbXBvbmVudCA2Nzkg4oCTIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMTYgMTYiPg0KICA8cGF0aCBpZD0iUGF0aF82MDU3IiBkYXRhLW5hbWU9IlBhdGggNjA1NyIgZD0iTTE4MjIuNi02MGgtNXYtNVoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xODE1LjU5NyA3NCkiIGZpbGw9IiMwMDZjZTAiLz4NCiAgPHBhdGggaWQ9IlBhdGhfNjA1OCIgZGF0YS1uYW1lPSJQYXRoIDYwNTgiIGQ9Ik0xODI5LjYtNjd2LTVoLTVaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTgxNS41OTcgNzQpIiBmaWxsPSIjMDA2Y2UwIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU3OSIgZGF0YS1uYW1lPSJMaW5lIDU3OSIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5IDMpIiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDZjZTAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogIDxsaW5lIGlkPSJMaW5lXzU4MCIgZGF0YS1uYW1lPSJMaW5lIDU4MCIgeTE9IjQiIHgyPSI0IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDkpIiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDZjZTAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogIDxyZWN0IGlkPSJSZWN0YW5nbGVfNjI3NiIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgNjI3NiIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJub25lIi8+DQo8L3N2Zz4NCg==) no-repeat center}.designer-tools-panel[_ngcontent-%COMP%]   .tools[_ngcontent-%COMP%]   .tool.fullscreen.hidden[_ngcontent-%COMP%]{display:none}.designer-content[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:row;justify-content:flex-start;align-items:stretch}.designer-content[_ngcontent-%COMP%]   .diagram-wrap[_ngcontent-%COMP%]{width:100%;border-radius:8px}.designer-content[_ngcontent-%COMP%]   .card-wrap[_ngcontent-%COMP%]{min-width:345px;max-width:345px;border:1px solid #dcdcdc;border-radius:8px}.designer-content[_ngcontent-%COMP%]   .card-wrap.card-hidden[_ngcontent-%COMP%]{display:none}"]});class ${constructor(t,n,i){this.dialogRef=t,this.data=n,this._translateService=i}ngOnInit(){this.headerLabel=this._translateService.instant("RelationshipDesignerModal.Caption",{schemaName:this.data.schemaName})}}$.\u0275fac=function(t){return new(t||$)(e.\u0275\u0275directiveInject(h.MatLegacyDialogRef),e.\u0275\u0275directiveInject(h.MAT_LEGACY_DIALOG_DATA),e.\u0275\u0275directiveInject(u.TranslateService))},$.\u0275cmp=e.\u0275\u0275defineComponent({type:$,selectors:[["crt-relationship-dialog"]],decls:9,vars:6,consts:[["content",""],[3,"data","allowFullScreenMode"],["caption",""],[1,"dialog-caption",3,"caption"],["tools",""],["mat-flat-button","","color","default",3,"clicked"]],template:function(t,n){t&1&&(e.\u0275\u0275elementStart(0,"crt-dialog"),e.\u0275\u0275elementContainerStart(1,0),e.\u0275\u0275elementStart(2,"crt-relationship-designer",1),e.\u0275\u0275elementContainerStart(3,2),e.\u0275\u0275element(4,"crt-label",3),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementContainerStart(5,4),e.\u0275\u0275elementStart(6,"crt-button",5),e.\u0275\u0275listener("clicked",function(){return n.dialogRef.close()}),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),t&2&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("data",n.data)("allowFullScreenMode",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("caption",n.headerLabel),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,4,"BasePageComponent.Close"),""))},dependencies:[T.CrtButtonComponent,T.CrtLabelComponent,T.CrtDialogComponent,H,u.TranslatePipe],styles:[`.crt-relationship-dialog{max-width:94vw!important}.crt-relationship-dialog mat-dialog-container{height:90vh;width:94vw}.crt-relationship-dialog crt-relationship-dialog .designer-tools-panel{border:none}.crt-relationship-dialog crt-relationship-dialog .designer-tools-panel .dialog-caption label{font-family:var(--crt-headline-2-font-family);font-size:var(--crt-headline-2-font-size);line-height:var(--crt-headline-2-line-height);font-weight:var(--crt-headline-2-font-weight);letter-spacing:var(--crt-headline-2-letter-spacing);text-transform:var(--crt-headline-2-text-transform);-webkit-font-smoothing:antialiased;color:var(--crt-palette-primary-500, var(--palette-primary-500))}.crt-relationship-dialog crt-relationship-dialog .designer-content .diagram-wrap{border:1px solid #dcdcdc}.crt-relationship-dialog crt-relationship-dialog .designer-content .card-wrap{margin-left:10px}
`],encapsulation:2});let re=class extends E.BaseDiagramEventHandlerController{constructor(t,n,i,o){super(),this.config=t,this.eventBus=n,this.rules=i,this.elements=o,this.translateService=t?.translateService}noAccessMessage(){const t=this.service,n=this.translateService.instant("RelationshipDiagram.NoAccess");t.showMessage(n)}subscribeServerDiagramChanges(){const t=this.service;this.eventBus.on(["element.dblclick"],n=>{const i=n.element;i&&!p.RelationshipDiagramUtils.isRoot(i)&&(this.rules.canEdit(i)?t.elementDoubleClick(i.id):this.noAccessMessage())}),this.eventBus.on(["elements.noAccessMessage"],()=>{this.noAccessMessage()}),this.eventBus.on(["elements.removing"],n=>{const i=n.elements.map(o=>o.id);return t.elementRemoving(i)}),this.eventBus.on(["diagram.connection.adding"],n=>t.connectionAdding({source:n.source.id,target:n.target?.id,targetType:n.targetType})),this.eventBus.on([E.Handlers.connection.reconnectExecuted],n=>{const i=n.context;if(i.newSource!==i.oldSource||i.newTarget!==i.oldTarget)return t.connectionReconnect({id:i.connection.id,source:i.newSource.id,target:i.newTarget.id})}),this.eventBus.on(["diagram.item.selected"],n=>t.itemSelected(n.id)),this.eventBus.on("diagram.loaded",()=>t.diagramLoaded()),this.eventBus.on("connect.end",E.EventPriority.LOW,function({context:n}){if(n.canExecute&&n.connection)return t.connectionAdding({id:n.connection.id,source:n.connection.source.id,target:n.connection.target.id})})}subscribeServerChanges(){return this.subscribeServerDiagramChanges(),[]}};re=(0,I.__decorate)([(0,I.__param)(0,(0,E.Inject)("config")),(0,I.__param)(1,(0,E.Inject)("eventBus")),(0,I.__param)(2,(0,E.Inject)("diagramRules")),(0,I.__param)(3,(0,E.Inject)("elements")),(0,I.__metadata)("design:paramtypes",[Object,Object,p.RelationshipRules,E.DiagramElements])],re);let le=class extends _.BaseRequestHandler{constructor(t){super(),this._dialogProvider=t}handle(t){const n=t.recordId?.value??t.recordId;return(0,c.firstValueFrom)(this._dialogProvider.open($,{data:{schemaName:t.entityName,selectedRecordId:n},panelClass:"crt-relationship-dialog"}))}};le=(0,I.__decorate)([(0,_.CrtRequestHandler)({requestType:"crt.ShowRelationshipsRequest",type:"crt.ShowRelationshipsHandler"}),(0,I.__metadata)("design:paramtypes",[T.DialogProvider])],le);let A=class{constructor(t){this._translateService=t,this._initializeTranslation()}_initializeTranslation(){this._translateService.use("en-US")}};A.\u0275fac=function(t){return new(t||A)(e.\u0275\u0275inject(u.TranslateService))},A.\u0275mod=e.\u0275\u0275defineNgModule({type:A}),A.\u0275inj=e.\u0275\u0275defineInjector({providers:[G,N,j,S,F,w,N,{provide:p.BaseDiagramEventService,useClass:F},{provide:p.DiagramFeaturesToken,useFactory:()=>({...p.RelationshipDiagramFeatures,diagramEventHandlerController:["type",re],elementFactory:["type",p.CommonDiagramElementFactory]})},ie.LinkGenerator],imports:[pe.BrowserAnimationsModule,g.CommonModule,se.ColorGithubModule,m.MaskModule,x.MatLegacyAutocompleteModule,M.MatLegacyButtonModule,h.MatLegacyDialogModule,W.MatDividerModule,P.MatExpansionModule,k.MatIconModule,C.MatLegacyFormFieldModule,v.MatLegacyInputModule,f.MatLegacyListModule,O.MatLegacyMenuModule,ce.MatLegacyTooltipModule,m.DialogModule,p.RelationshipDiagramModule,u.TranslateModule.forRoot({defaultLanguage:"en-US"}),T.CrtButtonModule,T.CrtLabelModule,T.CrtDialogModule]}),A=(0,I.__decorate)([(0,_.CrtModule)({includes:[],requestHandlers:[le]}),(0,I.__metadata)("design:paramtypes",[u.TranslateService])],A),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(A,{declarations:[z,R,Q,Y,V,J,H,Z,U,$,ee],imports:[pe.BrowserAnimationsModule,g.CommonModule,se.ColorGithubModule,m.MaskModule,x.MatLegacyAutocompleteModule,M.MatLegacyButtonModule,h.MatLegacyDialogModule,W.MatDividerModule,P.MatExpansionModule,k.MatIconModule,C.MatLegacyFormFieldModule,v.MatLegacyInputModule,f.MatLegacyListModule,O.MatLegacyMenuModule,ce.MatLegacyTooltipModule,m.DialogModule,p.RelationshipDiagramModule,u.TranslateModule,T.CrtButtonModule,T.CrtLabelModule,T.CrtDialogModule],exports:[z,H]})}()},8239:(me,ae,l)=>{l.d(ae,{Z:()=>g});function I(W,P,k,x,M,h,C){try{var v=W[h](C),f=v.value}catch(O){k(O);return}v.done?P(f):Promise.resolve(f).then(x,M)}function g(W){return function(){var P=this,k=arguments;return new Promise(function(x,M){var h=W.apply(P,k);function C(f){I(h,x,M,C,v,"next",f)}function v(f){I(h,x,M,C,v,"throw",f)}C(void 0)})}}}}]);
