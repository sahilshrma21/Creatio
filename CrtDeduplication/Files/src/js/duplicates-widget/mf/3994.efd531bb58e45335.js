(self.webpackChunkapp_studio_enterprise_duplicates_widget=self.webpackChunkapp_studio_enterprise_duplicates_widget||[]).push([[3994],{63994:(rt,pe,v)=>{v.r(pe),v.d(pe,{AppendSchemaStateFromUrlService:()=>Y,BaseNavigationOptions:()=>K,CHILD_HISTORY_STATE_BUILDERS:()=>ee,CHILD_NAVIGATION_TARGETS:()=>ne,ChildHistoryStateBuilder:()=>le,Crt7XRequestHandler:()=>he,CrtNavigationGuardsService:()=>x,CrtNavigationModule:()=>A,CrtNavigationService:()=>L,CrtRouter:()=>B,CrtRouterMock:()=>at,CrtUrlSerializer:()=>T,DONT_USE_CHILD_ROUTING:()=>fe,ENTITY_CHILD_HISTORY_STATE_BUILDERS:()=>te,EXECUTION_ZONES_CONTAINER_NAME_FOR_7X:()=>Ne,EntityNavigationOptions:()=>Ee,EntityNavigationTransitionConfigBuilder:()=>C,EntityNavigationTransitionConfigBuilderModule:()=>w,HashLocationStrategy:()=>F,HistoryService:()=>M,HistoryWrapper:()=>W,LocationStrategy:()=>y,ModelInitConfigsGeneratorService:()=>Z,ModuleNameReplacer:()=>I,ModuleNavigationOptions:()=>Te,ModuleNavigationTransitionConfigBuilder:()=>b,ModuleNavigationTransitionConfigBuilderModule:()=>k,NAVIGATION_GUARD_TOKEN:()=>de,NAVIGATION_ZONE_NAME:()=>ve,NavigationMode:()=>S,NavigationOptionsTypeEnum:()=>N,NavigationTransitionLocationUtils:()=>ce,NavigationUtils:()=>d.NavigationUtils,RecordUrlCreatorService:()=>D,SCHEMA_CHILD_HISTORY_STATE_BUILDERS:()=>ie,SHELL_MODULE_ALIASES_FACTORY:()=>ue,SchemaAccessGuard:()=>V,SchemaNavigationOptions:()=>Ce,SchemaNavigationTransitionConfigBuilder:()=>P,SchemaNavigationTransitionConfigBuilderModule:()=>O,UITypePriority:()=>d.UITypePriority,crtChildSegmentsEqual:()=>oe,crtStatesEqual:()=>Se,crtUrlSegmentsEqual:()=>ae,findChildSegmentsInContextByTarget:()=>se,getLastNestedChildState:()=>re});var l=v(8239),g=v(97600),u=v(21322),E=v(27049),p=v(75378);const ye="ChainModuleStub",ve="navigation",Ne="ExecutionZones",ne={Modal:"modal"},J={ClassicUI:"7x",FreedomUI:"8x"};var j=v(33177),h=v(49475),s=v(94450);class I{static getModuleNameByAlias(e){const t=this._moduleAliases;return Object.keys(t).find(i=>t[i]===e)}static replaceModuleNameByAlias(e){const t=e.split("/");return t[0]=this._moduleAliases[t[0]]||t[0],t.join("/")}}I._moduleAliases={CardSchemaViewModule:"Card",PageSchemaViewModule:"Page",SectionSchemaViewModule:"Section"},I.\u0275fac=function(e){return new(e||I)},I.\u0275prov=s.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac,providedIn:"root"});const Ie="\\[(.+)\\]";class T{static _parseChildRoutes(e,t){const i=[],n=e.match(Ie);if(n?.length>0){const o=n[1],[r,c]=this._getChildRoutesIndexes(o),m=r>=0&&c>0;let _=o,U;m&&(U=o.substring(r,c+1),_=o.replace(U,"")),_.split(",").forEach((me,ot)=>{const Q=this._getChildSegmentByPath(me);if(Q.contextName=`${t}_${Q.target}${ot}`,m){const st=o.indexOf(me);o.at(st+me.length)==="["&&(Q.children=this._parseChildRoutes(U,Q.contextName))}i.push(Q)})}return i}static _getChildRoutesIndexes(e){const t=[],i=[],n=[];for(let o=0;o<e.length;o++){const r=e.charAt(o);if(r==="[")t.push(o);else if(r==="]"){const c=t.pop();i.push(c),n.push(o)}}return[i.at(-1),n.at(-1)]}static _getRootSegmentByPath(e){if(!e)return{recordId:void 0,contextName:"root",action:void 0,schemaName:void 0,moduleName:void 0};const t=e.split("/");let i,n,o,r;return t.length===5&&t[0]==="SectionModuleV2"?[i,,n,o,r]=t:[i,n,o,r]=t,{moduleName:I.getModuleNameByAlias(i)||i,schemaName:n,action:o,recordId:r,contextName:"root"}}static _getChildSegmentByPath(e){const t=e.split("=");let i,n;t[1]?(n=t[0],i=t[1]):i=t[0];const[o,r,c]=i.split("/");return{schemaName:o,action:r,recordId:c,target:n}}static parse(e){const i=new URL(e).hash.split("#")[1];return T.parseLocation(i)}static parseLocation(e){const t=e?.indexOf("[");let i,n="";t>=0?(i=e.substring(0,t),n=e.substring(t)):i=e;const o=this._getRootSegmentByPath(i);let r=[];return n&&(r=this._parseChildRoutes(n,o.contextName)),{root:o,children:r}}static getQueryParams(e){const t=e.lastIndexOf("?"),i={};return t<0||e.substring(t+1).split("&").forEach(o=>{const r=o.split("=");i[r[0]]=r[1]}),i}}var d=v(1742);function ae(a,e){return a?.moduleName===e?.moduleName&&a?.schemaName===e?.schemaName&&a?.action===e?.action&&a?.recordId===e?.recordId&&a?.contextName===e?.contextName}function oe(a,e){if(!(a?.length===e?.length))return!1;for(let i=0;i<a?.length;i++){const n=ae(a[i],e[i]),o=oe(a[i].children,e[i].children),r=a[i].target===e[i].target;if(!(n&&o?r:!1))return!1}return!0}function se(a,e,t,i){let n=[];return(0,g.isEmpty)(t)||t.forEach(o=>{const r=i===a,c=o.target===e;if(r&&c)n.push(o);else{const _=se(a,e,o?.children,o.contextName);n=[...n,..._]}}),n}function _e(a){const e=(0,g.omit)(a,"historyIndex","children");return e.modelInitConfigs=e.modelInitConfigs?.map(t=>(0,g.omit)(t,"name")),e}function Se(a,e){return(0,g.isEqual)(_e(a),_e(e))}function re(a){const e=a.children||[];return(0,g.isEmpty)(e)?a:re(e[0])}class ce{static _applyRecordId(e,t,i){return e&&e!==p.ModelInPageAction.Add?t+"/"+i:t}static _getLocationByUrlSegment(e){const t=[e.moduleName,e.schemaName,e.action].filter(i=>i&&i!=="undefined").join("/");return this._applyRecordId(e.action,t,e.recordId)}static _getPrevRootLocation(e){const t=T.parseLocation(e);return this._getLocationByUrlSegment(t.root)}static _getRootLocationSegment(e){return{schemaName:e.schemaName,moduleName:e.moduleName,action:e.modelInitConfigs?.[0]?.action,recordId:e.modelInitConfigs?.[0]?.recordId}}static _getRootLocation(e,t){let i;const n=this._getChildrenState(t),{prevLocation:o,isInChain:r}=e;if(o&&(r||!(0,g.isEmpty)(n)))i=this._getPrevRootLocation(o);else{const c=this._getRootLocationSegment(e);i=this._getLocationByUrlSegment(c)}return i}static _getChildrenState(e){return e.children||[]}static _getChildLocationSegment(e){return{schemaName:e.schemaName,action:e.modelInitConfigs?.[0]?.action,recordId:e.modelInitConfigs?.[0]?.recordId}}static _getChildrenLocation(e){let t="";if((0,g.isEmpty)(e))return t;const i=[...e].sort((o,r)=>o.target.localeCompare(r.target));let n="";return i.forEach(o=>{n===o.target?t+=",":(t+=`${o.target}=`,n=o.target);const r=this._getChildLocationSegment(o);t+=this._getLocationByUrlSegment(r);const c=this._getChildrenLocation(o.children);t=t.concat(`${c}`)}),`[${t}]`}static getLocationByState(e,t){const i=this._getRootLocation(e,t),n=this._getChildrenState(t),o=this._getChildrenLocation(n);return i+o}}class y extends h.RootInjectorGuard{constructor(e){super(),this.window=e,this.state$=new u.Subject,this._indexHistoryStates()}_indexHistoryStates(){const e=()=>{const t=this.getState();if(!t||!("historyIndex"in t)){let i;this.previousState?i=this.previousState?.historyIndex+1:i=this.window.history.length-1;const n={...t,historyIndex:i};this.window.history.replaceState(n,"indexState")}};e(),this.window.addEventListener("popstate",e,!0),this._popstateSubscription=new u.Subscription(()=>this.window.removeEventListener("popstate",e))}replaceAliasWithModuleName(e){const t=e.split("/");return t[0]=I.getModuleNameByAlias(t[0])||t[0],t.join("/")}onPopState(e){}prepareExternalUrl(e){}getBaseHref(){return`${this.window.Terrasoft.workspaceBaseUrl}/Shell`}getRoute(e){const i={...T.parse(this.window.location.href),state:e};return this._applyChildStateToChildSegment(i.children,e.children),i}_applyChildStateToChildSegment(e,t){!e||!t||e.forEach((i,n)=>{const o=t[n];i.parameters=o.parameters,i.defaultValues=o.modelInitConfigs?.[0]?.defaultValues,i.children&&this._applyChildStateToChildSegment(i.children,o.children)})}ngOnDestroy(){this._popstateSubscription.unsubscribe()}}y.\u0275fac=function(e){return new(e||y)(s.\u0275\u0275inject(j.WINDOW_TOKEN))},y.\u0275prov=s.\u0275\u0275defineInjectable({token:y,factory:y.\u0275fac,providedIn:"root"});class F extends y{constructor(e,t){super(e),this._ngZone=t}get previousState(){return this._previousState}_splitHistoryState(e){const i=e.split("?")[0].split("/"),n={},r=T.parse(this.window.location.href).root;if(n.moduleName=r.moduleName,n.schemaName=r.schemaName,n.operationType=r.action,i.length<=4&&i[3])return n.recordId=r.recordId,n;let c=3;n.operationType!=="add"&&(c=4,i[3]&&(n.recordId=r.recordId));const m=(i.length-c)/2;n.valuePairs=[];for(let _=0;_<m;_++){const U=c+_*2;n.valuePairs[_]={name:i[U],value:i[U+1]}}return n}_getHash(e=this.window.location.href){const t=e.indexOf("#");return t>=0?e.slice(t):"#"+e}_hasOnlyHistoryState(e){const t=Object.keys(e);return t.length===1&&t.includes("historyIndex")}_toHistoryState(e){const t={recordId:e.recordId,schemaName:e.schemaName,moduleName:e.moduleName,operationType:e.action};return t.modelInitConfigs=[{recordId:e.recordId,action:e.action}],t}_toChildHistoryStates(e){const t=[];return e.forEach(i=>{const n=this._toHistoryState(i);n.target=i.target,n.children=[],(0,g.isEmpty)(i.children)||(n.children=this._toChildHistoryStates(i.children)),t.push(n)}),t}_backToReconstructedState(){const e=T.parse(this.window.location.href),t=this._toChildHistoryStates(e.children);if(t.length>0){t.pop();const i=this._toHistoryState(e.root),n={...this.window.history.state,...i,children:t},o={schemaName:n.schemaName,moduleName:n.moduleName,modelInitConfigs:n.modelInitConfigs},r=ce.getLocationByState(o,n);return this._ngZone.run(()=>{this.replaceState(n,"",r)}),!0}return!1}getActivePathInfo(){let e=this.path();return e.charAt(0)==="/"&&(e=e.slice(1)),e=this.replaceAliasWithModuleName(e),this._splitHistoryState(e)}path(e=!1){const t=this._getHash();return e?t:t.slice(1)}pushState(e,t,i){const n=this.getState()||this._previousState||{historyIndex:0};(e??(e={})).historyIndex=n.historyIndex+1,this.window.history.pushState(e,t,this._getHash(i)),this._previousState=this.getState(),this.state$.next(e)}replaceState(e,t,i){(e??(e={})).historyIndex=this.getState().historyIndex,this.window.history.replaceState(e,t,this._getHash(i)),this.state$.next(e)}forward(){this.go(1)}back(){if(this.window.history.length<2){this._backToReconstructedState();return}this._previousState=this.getState(),this.go(-1)}go(e){this.window.history.go(e)}getState(){let e=this.window.history.state;if((0,g.isEmpty)(e))return null;if(this._hasOnlyHistoryState(e)){const t=T.parse(this.window.location.href),i=this._toHistoryState(t.root),n=this._toChildHistoryStates(t.children);e={...e,...i,children:n}}return e}ngOnDestroy(){super.ngOnDestroy()}}F.\u0275fac=function(e){return new(e||F)(s.\u0275\u0275inject(j.WINDOW_TOKEN),s.\u0275\u0275inject(s.NgZone))},F.\u0275prov=s.\u0275\u0275defineInjectable({token:F,factory:F.\u0275fac,providedIn:"root"});class K{}var N;(function(a){a.Entity="entity",a.Schema="schema",a.Module="module"})(N||(N={}));class Ce extends K{constructor(e){super(),this.type=N.Schema,this.schemaName=e}}class Ee extends K{constructor(){super(...arguments),this.type=N.Entity}}class Te extends K{constructor(){super(...arguments),this.type=N.Module}}var S;(function(a){a.Push="push",a.Replace="replace"})(S||(S={}));class le{getState(e){var t=this;return(0,l.Z)(function*(){let i={};yield t.enrichState(i,e);const n=e?.state??{};return i={...i,...n},i})()}}var f;(function(a){a.Back="back",a.Forward="forward",a.ExecuteTransition="executeTransition",a.Go="go"})(f||(f={}));class R{_addToBucket(e,t){let i=e[t.type];i||(i=[],e[t.type]=i),i.push(t)}_eventBucketsReducer(e,t){return t.type===f.Go&&t.delta===-1?this._addToBucket(e,R._backEvent):this._addToBucket(e,t),e}_prepareForwardEvents(e,t){let i=[];const n=[];for(const o of e)(o.config.mode===S.Push?n:i).push(o);return i.length===0&&t&&n.length>0&&(n[0].config.mode=S.Replace),i.length>0&&(i=[i[i.length-1]]),[...i,...n]}normalize(e){const t=e.reduce(this._eventBucketsReducer.bind(this),{}),i=t[f.Go],n=t[f.Forward];if(i||n)return[...i||[],...n||[]];const o=t[f.Back],r=t[f.ExecuteTransition];return o&&!r?[o[0]]:this._prepareForwardEvents(r,Boolean(o))}}R._backEvent={type:f.Back},R.\u0275fac=function(e){return new(e||R)},R.\u0275prov=s.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac,providedIn:"root"});const Re="navigation";class z{constructor(e,t,i,n){this._zoneService=e,this._normalizer=t,this._logger=i,this._applicationInfo=n,this._queue=[],this._state=h.CrtZoneState.Idle,this.navigationEventsReady$=new s.EventEmitter(!1);const o=e.register(Re,h.CrtZoneType.ExecutionTracking);this._stateChangeSubscription=o.onStateChange$.subscribe(this._onStateChange.bind(this))}_onStateChange(e){this._state!==e&&(this._state=e,e===h.CrtZoneState.Idle&&this._execQueue())}_execQueue(){if(!this._queue.length||this._state===h.CrtZoneState.Busy)return;const e=this._normalizer.normalize(this._queue);this._applicationInfo.isDebugEnabled&&this._logger.log(`Executing ${this._queue.length} events as ${e.length}`,this._queue,{sourceEvents:this._queue,normalizedEvents:e}),this._queue=[],this.navigationEventsReady$.next(e)}_push(e){this._queue.push(e),this._execQueue()}pushTransition(e){this._push({type:f.ExecuteTransition,config:e})}push(e,t){this._push({type:e,delta:t})}ngOnDestroy(){this._stateChangeSubscription.unsubscribe()}}z.\u0275fac=function(e){return new(e||z)(s.\u0275\u0275inject(h.CrtZoneService),s.\u0275\u0275inject(R),s.\u0275\u0275inject(j.LoggerService),s.\u0275\u0275inject(h.ApplicationInfo))},z.\u0275prov=s.\u0275\u0275defineInjectable({token:z,factory:z.\u0275fac,providedIn:"root"});const ue=new s.InjectionToken("ShellModuleAliasesFactory"),fe=new s.InjectionToken("DontUseChildRouting"),ee=new s.InjectionToken("CHILD_HISTORY_STATE_BUILDERS"),te=new s.InjectionToken("ENTITY_CHILD_HISTORY_STATE_BUILDERS",{factory:()=>{const a=(0,s.inject)(ee,{optional:!0})||[],e=(0,s.inject)(te)||[];return a.concat(e)}}),ie=new s.InjectionToken("SCHEMA_CHILD_HISTORY_STATE_BUILDERS",{factory:()=>{const a=(0,s.inject)(ee,{optional:!0})||[],e=(0,s.inject)(ie)||[];return a.concat(e)}}),de=new s.InjectionToken("Navigation guard");class M{constructor(e,t,i){this._locationStrategy=e,this._navigationQueue=t,this._moduleAliasesFeatureFactory=i,this._handlerChain=p.HandlerChainService.instance,this._onNavigationEventsReadySubscription=this._navigationQueue.navigationEventsReady$.pipe((0,u.switchMap)(n=>this._handleNavigationEvents(n))).subscribe(),this._moduleAliasesFeatureFactory().then(n=>this._moduleAliasesFeatureEnabled=n)}_handleNavigationEvent(e){switch(e.type){case f.Back:this._locationStrategy.back();break;case f.Forward:this._locationStrategy.forward();break;case f.Go:this._locationStrategy.go(e.delta);break}}_handleNavigationEvents(e){var t=this;return(0,l.Z)(function*(){const i=e.length-1;for(let n=0;n<e.length;n++){const o=e[n];if(o.type===f.ExecuteTransition){const r=n<i;yield t._executeTransition(o.config,r)}else t._handleNavigationEvent(o)}})()}_changeHistoryStateUsing8xRouting({mode:e,state:t,pageTitle:i,location:n}){if(i=i??"",e===S.Replace)return this.replaceState(t,i,n);if(e===S.Push)return this.pushState(t,i,n)}_changeHistoryStateUsing7xRouting({mode:e,state:t,location:i},n){var o=this;return(0,l.Z)(function*(){const r=e===S.Replace?"ReplaceHistoryState":"PushHistoryState";yield o._handlerChain.process({type:"crt.7XRequest",$context:null,action:r,hash:i,stateObj:t,silent:t?.silent??n})})()}_changeHistoryState(e,t,i){var n=this;return(0,l.Z)(function*(){t?n._changeHistoryStateUsing8xRouting(e):yield n._changeHistoryStateUsing7xRouting(e,i)})()}_load7xModule({state:e,moduleConfig:t}){var i=this;return(0,l.Z)(function*(){const n=e.initConfig,r=d.NavigationUtils.isAngularRouting(e.moduleName)?ye:e.moduleName,c={renderTo:"centerPanel",id:t?.moduleId??e?.moduleId,keepAlive:t?.keepAlive??!0,instanceConfig:n,replaceLastModuleInChain:e.replaceLastModuleInChain};yield i._handlerChain.process({type:"crt.7XRequest",$context:null,action:"LoadModule",moduleName:r,moduleParams:c})})()}_executeTransition(e,t){var i=this;return(0,l.Z)(function*(){const n=e.state,o=n.children?.length>0,r=d.NavigationUtils.isAngularRouting(n.moduleName)||o,c=Boolean(n.isInChain);t&&(n.silent=!0,n.moduleId=e.moduleConfig?.moduleId??n?.moduleId),yield i._changeHistoryState(e,r,c),!t&&c&&!o&&(yield i._load7xModule(e))})()}_getProcessedHash(e){return this._moduleAliasesFeatureEnabled?I.replaceModuleNameByAlias(e):e}executeTransition(e){this._navigationQueue.pushTransition(e)}pushState(e,t,i){const n=this._getProcessedHash(i);this._locationStrategy.pushState(e,t,n)}replaceState(e,t,i){const n=this._getProcessedHash(i);this._locationStrategy.replaceState(e,t,n)}go(e){this._navigationQueue.push(f.Go,e)}back(){this._navigationQueue.push(f.Back)}forward(){this._navigationQueue.push(f.Forward)}ngOnDestroy(){this._onNavigationEventsReadySubscription.unsubscribe()}}M.\u0275fac=function(e){return new(e||M)(s.\u0275\u0275inject(y),s.\u0275\u0275inject(z),s.\u0275\u0275inject(ue))},M.\u0275prov=s.\u0275\u0275defineInjectable({token:M,factory:M.\u0275fac,providedIn:"root"});class x{constructor(e,t,i){this._rightsService=e,this._featureService=t,this._navigationGuards=i}canActivate(e){var t=this;return(0,l.Z)(function*(){if(!(yield t._featureService.getFeatureState("EnablePageOpeningRestrictions"))||(yield t._rightsService.getCanExecuteOperation("CanBypassPageOpeningRestrictions")))return Promise.resolve(!0);for(const o of t._navigationGuards){const r=yield o.canActivate(e);if(r!==!0)return Promise.resolve(r)}return Promise.resolve(!0)})()}}x.\u0275fac=function(e){return new(e||x)(s.\u0275\u0275inject(p.RightsService),s.\u0275\u0275inject(p.FeatureService),s.\u0275\u0275inject(de))},x.\u0275prov=s.\u0275\u0275defineInjectable({token:x,factory:x.\u0275fac,providedIn:"root"});class B{constructor(e,t,i,n){var o=this;this._location=e,this._moduleAliasesFeatureFactory=t,this._historyService=i,this._navigationGuardsService=n,this._popState$=(0,u.fromEvent)(window,"popstate"),this._navigateStart$=new u.Subject,this._navigateEnd$=new u.Subject,this._prevRoute={},this._currentRoute={},this.navigateStart$=this._navigateStart$.asObservable(),this.navigateEnd$=this._navigateEnd$.asObservable(),this.historyState$=(0,u.merge)((0,u.of)(this._location.getState()),this._location.state$.pipe((0,E.mergeMap)(()=>(0,u.of)(this._location.getState()))),this._popState$.pipe((0,E.mergeMap)(()=>(0,u.of)(this._location.getState())))).pipe((0,E.switchMap)(function(){var r=(0,l.Z)(function*(c){const m=yield o._navigationGuardsService.canActivate(o.getActiveRouteInfo());let _=c;if(m===!1)throw new Error("Navigation prevented.");if(m!==void 0&&typeof m!="boolean"){const U=o._location.path();o._historyService.replaceState(m.state,m.title||"",m.path||U),_=m.state}return _});return function(c){return r.apply(this,arguments)}}()),(0,E.tap)(r=>{if(this._moduleAliasesFeatureEnabled){const c=this._location.path();this._shouldReplaceModuleNameByAlias(c)&&this._historyService.replaceState(r,"",c)}}),(0,E.share)()),this.location$=(0,u.merge)((0,u.of)(new URL(window.location.href)),this._location.state$.pipe((0,E.mergeMap)(()=>(0,u.of)(new URL(window.location.href)))),this._popState$.pipe((0,E.mergeMap)(()=>(0,u.of)(new URL(window.location.href))))),this.crtRoute$=this.historyState$.pipe((0,u.map)(r=>this._location.getRoute(r)),(0,E.tap)(r=>{this._prevRoute=this._currentRoute,this._currentRoute=r}),(0,u.filter)(r=>!(0,g.isEqual)(this._prevRoute,r)),(0,u.shareReplay)({bufferSize:1,refCount:!1})),this._moduleAliasesFeatureFactory().then(r=>this._moduleAliasesFeatureEnabled=r)}_shouldReplaceModuleNameByAlias(e){return I.replaceModuleNameByAlias(e)!==e}_filterChildrenRoute(e,t){const i=!ae(e,this._prevRoute.root),n=!Se(t,this._prevRoute.state);return i||n}onNavigateStart(){this._navigateStart$.next()}onNavigateEnd(){this._navigateEnd$.next()}getNavigation$(e){return this.crtRoute$.pipe((0,u.filter)(t=>{if(e)throw new Error("Not implemented yet");return!(0,g.isEmpty)(t.state?.children)||!(0,g.isEmpty)(this._prevRoute.state?.children)?this._filterChildrenRoute(t.root,t.state):!0}))}getChildNavigation$(e,t){return this.crtRoute$.pipe((0,u.filter)(i=>!oe(i.children,this._prevRoute.children)),(0,u.map)(i=>se(e,t,i.children,i.root.contextName)))}getActiveRouteInfo(){const e=this._location.getActivePathInfo(),t=this._location.getState(),i={moduleName:t&&t.moduleName||e.moduleName,schemaName:t&&t.schemaName||e.schemaName,operationType:e.operationType||t.operation,recordId:e.recordId};return t.isInChain&&(i.isInChain=!0),i}}B.\u0275fac=function(e){return new(e||B)(s.\u0275\u0275inject(y),s.\u0275\u0275inject(ue),s.\u0275\u0275inject(M),s.\u0275\u0275inject(x))},B.\u0275prov=s.\u0275\u0275defineInjectable({token:B,factory:B.\u0275fac,providedIn:"root"});class W{constructor(e){this._historyService=e}pushState(e,t,i){this._historyService.pushState(e,t,i)}replaceState(e,t,i){this._historyService.replaceState(e,t,i)}go(e){this._historyService.go(e)}back(){this.go(-1)}forward(){this.go(1)}}W.\u0275fac=function(e){return new(e||W)(s.\u0275\u0275inject(M))},W.\u0275prov=s.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac,providedIn:"root"});var Me=v(77207),be=v(8785);class H{constructor(e){this.injector=e,this.locationStrategy=e.get(y),this.dontUseChildRouting=(0,s.inject)(fe,{optional:!0}),this._childHistoryStateBuilders=this.getChildHistoryStateBuilders()||[]}_getChildHistoryStates(e){return Promise.all(this._childHistoryStateBuilders.map(t=>t.getState(e)))}_getPrevChildHistoryStates(e){return e}_getState(e,t){var i=this;return(0,l.Z)(function*(){if(yield i.dontUseChildRouting)return i.getRootState(e,t);let o=yield i._getChildHistoryStates(t);o=o.filter(_=>!(0,g.isEmpty)(_));let r;(0,g.isEmpty)(o)?r=i.getRootState(e,t):r=yield i._applyChildrenHistoryStates(e,o);const c=i._getPrevChildHistoryStates(e.prevState);return!(0,g.isEmpty)(c?.children)&&(0,g.isEmpty)(o)&&(r.keepAlive=!0),r})()}_applyChildrenHistoryStates(e,t){const i=(0,g.cloneDeep)(e.prevState)??{},n=re(i);return this._setChildrenState(n,t),i}_setChildrenState(e,t){e.children=t}_getLocation(e,t){return ce.getLocationByState(e,t)}_getSchemaUIType(e){return(0,l.Z)(function*(){if(!!e.schemaName)return(yield d.NavigationUtils.isAngularSchema(e.schemaName))?J.FreedomUI:J.ClassicUI})()}getChildHistoryStateBuilders(){return(0,s.inject)(ee,{optional:!0})}getModelInitConfigs(e){return[]}getSchemaName(e,t){return Promise.resolve("")}getStateModuleId(e){return""}getModuleName(e,t){const i=e.schemaUIType===J.ClassicUI?t.state?.moduleName:"";return Promise.resolve(i)}getRootState(e,t){const i={...(0,g.cloneDeep)(t?.state??{})};if(i.isInChain=e.isInChain,i.moduleName=e.moduleName,e.isInChain||(i.moduleId=this.getStateModuleId(e)),e.schemaUIType===J.ClassicUI){const n=e.modelInitConfigs?.[0];i.operation=n?.action,i.primaryColumnValue=n?.recordId,i.valuePairs=d.NavigationUtils.getValuePairs(n?.defaultValues),i.isSeparateMode=!0,i.isInChain&&(i.schemaName=e?.schemaName)}else i.schemaName=e.schemaName,i.modelInitConfigs=e.modelInitConfigs;return i}getModuleConfig({isInChain:e,moduleName:t,prevState:i}){return e?{moduleId:(i?.moduleId??"")+d.NavigationUtils.generateChainModuleId(t)}:null}getCommonTransitionInfo(e){var t=this;return(0,l.Z)(function*(){const i=t.locationStrategy.getState(),n={};return n.schemaName=yield t.getSchemaName(n,e),n.schemaUIType=yield t._getSchemaUIType(n),n.navigationState=e.state,n.isInChain=n.navigationState?.isInChain??i?.isInChain,n.modelInitConfigs=t.getModelInitConfigs(e),n.prevState=i,n.prevLocation=t.locationStrategy.path(),n.moduleName=yield t.getModuleName(n,e),n})()}getTransitionConfig(e){var t=this;return(0,l.Z)(function*(){const i=yield t.getCommonTransitionInfo(e);if(!i)return null;const n=yield t._getState(i,e),o=t._getLocation(i,n),r=t.getModuleConfig(i);return{mode:e.mode,location:o,state:n,pageTitle:"",moduleConfig:r}})()}}H.\u0275fac=function(e){return new(e||H)(s.\u0275\u0275inject(s.Injector))},H.\u0275prov=s.\u0275\u0275defineInjectable({token:H,factory:H.\u0275fac});class C extends H{getChildHistoryStateBuilders(){return(0,s.inject)(te)}getSchemaName(e,t){return(0,l.Z)(function*(){const i=yield d.NavigationUtils.getPageForActionAsync(t.options);return e.page=i,d.NavigationUtils.getCardSchemaName(i)||t.options.entityPageName})()}getModuleName(e,t){var i=()=>super.getModuleName,n=this;return(0,l.Z)(function*(){const o=yield i().call(n,e,t);if(o)return o;const r=e.page?.cardModuleName;if(r)return r;const{uiTypePriority:c,entityName:m}=t.options;return d.NavigationUtils.getEditPageModuleName(m,c)||e.schemaName&&d.NavigationUtils.getModuleName(e.schemaName)})()}getCommonTransitionInfo(e){var t=()=>super.getCommonTransitionInfo,i=this;return(0,l.Z)(function*(){const n=yield t().call(i,e);return n.moduleName?(n?.schemaUIType===J.ClassicUI&&e.options.action!==p.ModelInPageAction.Edit&&(n.isInChain=!0),n):null})()}getModelInitConfigs(e){const{action:t,defaultValues:i,recordId:n}=e.options;if(!t)return null;const o=i?.filter(c=>c.value),r={action:t};return t===p.ModelInPageAction.Add?r.defaultValues=o:r.recordId=d.NavigationUtils.getRecordLookupValue(n),[r]}getStateModuleId(e){const t=e.modelInitConfigs?.[0];return[e.moduleName,t?.recordId,e.schemaName].filter(Boolean).join("_")}}C.\u0275fac=function(){let a;return function(t){return(a||(a=s.\u0275\u0275getInheritedFactory(C)))(t||C)}}(),C.\u0275prov=s.\u0275\u0275defineInjectable({token:C,factory:C.\u0275fac});class b extends H{getModuleConfig({navigationState:e}){return{keepAlive:e?.keepAlive??!0}}getRootState(e,t){const i=t.options,n={...t?.state??{}};return n.moduleId=i.moduleId,n.moduleName=i.moduleName,n.parameters=i.parameters,n.initConfig=i.initConfig,n.silent??(n.silent=!1),n}getModuleName(e,t){const i=e.isInChain?e.prevLocation:t.options?.moduleName;return Promise.resolve(i)}}b.\u0275fac=function(){let a;return function(t){return(a||(a=s.\u0275\u0275getInheritedFactory(b)))(t||b)}}(),b.\u0275prov=s.\u0275\u0275defineInjectable({token:b,factory:b.\u0275fac});class q{constructor(e,t){this._window=e,this._locationStrategy=t,this._destroyed$=new u.Subject,this._subscribePopStateEvent()}_subscribePopStateEvent(){var e=this;this.strategy$=(0,u.fromEvent)(this._window,"popstate").pipe((0,u.map)(function(){var t=(0,l.Z)(function*({state:i}){(yield e._isHistoryStateChanged(i))&&(yield p.HandlerChainService.instance.process({type:"crt.7XRequest",action:"8xHistoryStateChanged",$context:null}))});return function(i){return t.apply(this,arguments)}}()),(0,u.takeUntil)(this._destroyed$))}_isHistoryStateChanged(e){var t=this;return(0,l.Z)(function*(){const i=t._locationStrategy.getActivePathInfo(),n=e?.schemaName??i.schemaName;if(!(n&&!(yield d.NavigationUtils.isAngularSchema(n)))){const _=e?.moduleName??i.moduleName;if(!(_&&!n&&!d.NavigationUtils.isAngularRouting(_))&&!e?.isInChain)return!1}const c=t._locationStrategy.previousState?.moduleId===e?.moduleId;return!t._wasChildrenRouting()||!c})()}_wasChildrenRouting(){return this._locationStrategy.previousState?.children?.length>0}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}q.\u0275fac=function(e){return new(e||q)(s.\u0275\u0275inject(j.WINDOW_TOKEN),s.\u0275\u0275inject(y))},q.\u0275prov=s.\u0275\u0275defineInjectable({token:q,factory:q.\u0275fac,providedIn:"root"});class G extends le{enrichState(e,t){e.target=ne.Modal,e.schemaName=t?.options?.schemaName;const{modelInitConfigs:i,parameters:n}=t.options;return n&&(e.parameters=n),i&&(e.modelInitConfigs=i),Promise.resolve()}getState(e){var t=()=>super.getState,i=this;return(0,l.Z)(function*(){const n=e?.options?.schemaName;return(0,g.isEmpty)(n)||!(yield d.NavigationUtils.isMiniPage(n))?null:t().call(i,e)})()}}G.\u0275fac=function(){let a;return function(t){return(a||(a=s.\u0275\u0275getInheritedFactory(G)))(t||G)}}(),G.\u0275prov=s.\u0275\u0275defineInjectable({token:G,factory:G.\u0275fac});class P extends H{_getTransitionConfigWithoutSchemaName(e){const t={...(0,g.cloneDeep)(e?.state??{})};return this.locationStrategy.getState()?.isInChain&&(t.isInChain??(t.isInChain=!0)),t.moduleId=`${t.moduleName}_`,{mode:e.mode,location:t.moduleName,state:t}}getChildHistoryStateBuilders(){return(0,s.inject)(ie)}getSchemaName(e,t){const{schemaName:i}=t.options;return Promise.resolve(i)}getModuleName(e,t){var i=()=>super.getModuleName,n=this;return(0,l.Z)(function*(){return(yield i().call(n,e,t))||d.NavigationUtils.getModuleName(e.schemaName)})()}getRootState(e,t){const i=super.getRootState(e,t),{parameters:n}=t.options;return e.schemaUIType===J.FreedomUI&&n&&(i.parameters=n),i}getModelInitConfigs(e){return e.options.modelInitConfigs}getStateModuleId(e){return[e.moduleName,e.schemaName].filter(Boolean).join("_")}getTransitionConfig(e){if(!e.options.schemaName){const t=this._getTransitionConfigWithoutSchemaName(e);return Promise.resolve(t)}return super.getTransitionConfig(e)}}P.\u0275fac=function(){let a;return function(t){return(a||(a=s.\u0275\u0275getInheritedFactory(P)))(t||P)}}(),P.\u0275prov=s.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac});class O{}O.\u0275fac=function(e){return new(e||O)},O.\u0275mod=s.\u0275\u0275defineNgModule({type:O}),O.\u0275inj=s.\u0275\u0275defineInjector({providers:[P,{provide:ie,useClass:G,multi:!0}]});class L{constructor(){this._entityTransitionConfigBuilder=(0,s.inject)(C),this._schemaTransitionConfigBuilder=(0,s.inject)(P),this._moduleTransitionConfigBuilder=(0,s.inject)(b),this._navigationEndStrategy=(0,s.inject)(q),this._router=(0,s.inject)(B),this._historyService=(0,s.inject)(M),this._translateService=(0,s.inject)(Me.TranslateService),this._entitySchemaService=(0,s.inject)(h.EntitySchemaService),this.locationStrategy=(0,s.inject)(y),this.handlerChain=p.HandlerChainService.instance,this._navigationEndStrategySubscription=this.subscribeForNavigationEndStrategy()}_translate(e){return this._translateService.instant(`Navigation.${e}`)}_getEntityNavigationConfig(e){const t={mode:e?.mode??S.Push,state:e?.state??{},options:e.options};return this._entityTransitionConfigBuilder.getTransitionConfig(t)}_geSchemaNavigationConfig(e){const t={mode:e?.mode??S.Push,state:e?.state??{},options:e.options};return this._schemaTransitionConfigBuilder.getTransitionConfig(t)}_getModuleNavigationConfig(e){const t={mode:e?.mode??S.Push,state:e?.state??{},options:e.options};return this._moduleTransitionConfigBuilder.getTransitionConfig(t)}_showEntityNavigationError(e){console.error(this._translate("DoesntHaveAddPageMessage"));const t=e.options.entityName;this._entitySchemaService.getEntitySchemaByName(t).pipe((0,E.map)(i=>i.entitySchema?.uId),(0,u.take)(1)).subscribe(i=>{if(i){const n=this._translate("GoToEntityDesignerMessage"),c=`${(0,h.getWorkspaceBaseUrl)()}ClientApp/#/EntitySchemaDesigner/${i}?callbackAction=RelatedPage`,m=be.String.format(n,c);console.info(m)}})}executeTransition(e){return this._historyService.executeTransition(e),Promise.resolve()}subscribeForNavigationEndStrategy(){return this._navigationEndStrategy.strategy$.subscribe()}back(){this._historyService.back()}getState(){return this.locationStrategy.getState()}navigate(e){var t=this;return(0,l.Z)(function*(){t._router.onNavigateStart();let i;switch(e.options.type){case N.Schema:i=yield t._geSchemaNavigationConfig(e);break;case N.Entity:if(i=yield t._getEntityNavigationConfig(e),!i){t._router.onNavigateEnd(),t._showEntityNavigationError(e);return}break;case N.Module:i=yield t._getModuleNavigationConfig(e);break}yield t.executeTransition(i)})()}getActiveRouteInfo(){return this._router.getActiveRouteInfo()}ngOnDestroy(){this._navigationEndStrategySubscription.unsubscribe()}}L.\u0275fac=function(e){return new(e||L)},L.\u0275prov=s.\u0275\u0275defineInjectable({token:L,factory:L.\u0275fac,providedIn:"root"});class $ extends le{_getMiniPageSchemaName(e){return(0,l.Z)(function*(){const t=yield d.NavigationUtils.getPageForActionAsync(e.options),i=t?.schemaGroup==="MiniPage"?t:null;return d.NavigationUtils.getCardSchemaName(i)})()}_getRecordId({options:e}){return typeof e.recordId=="string"?e.recordId:e.recordId?.value}enrichState(e,t){var i=this;return(0,l.Z)(function*(){e.schemaName=yield i._getMiniPageSchemaName(t);const{action:n,messageTags:o}=t.options,r={action:n};n===p.ModelInPageAction.Add?r.defaultValues=t.options?.defaultValues?.filter(c=>c.value):r.recordId=i._getRecordId(t),e.modelInitConfigs=[r],e.messageTags=o,e.target=ne.Modal})()}getState(e){var t=()=>super.getState,i=this;return(0,l.Z)(function*(){return(yield i._getMiniPageSchemaName(e))?t().call(i,e):null})()}}$.\u0275fac=function(){let a;return function(t){return(a||(a=s.\u0275\u0275getInheritedFactory($)))(t||$)}}(),$.\u0275prov=s.\u0275\u0275defineInjectable({token:$,factory:$.\u0275fac});class w{}w.\u0275fac=function(e){return new(e||w)},w.\u0275mod=s.\u0275\u0275defineNgModule({type:w}),w.\u0275inj=s.\u0275\u0275defineInjector({providers:[C,{provide:te,useClass:$,multi:!0}]});class k{}k.\u0275fac=function(e){return new(e||k)},k.\u0275mod=s.\u0275\u0275defineNgModule({type:k}),k.\u0275inj=s.\u0275\u0275defineInjector({providers:[b]});class Z{_getDefaultValues(e){return e&&e.map(t=>{const i=!(0,g.isUndefined)(t.value)&&!(0,g.isUndefined)(t.displayValue)?t:t.value;return{attributeName:t.name,value:i}})}generate(e){let t=e?.modelInitConfigs;if(!t){const i=e?.operation||e?.operationType;if(i){const n=this._getDefaultValues(e.valuePairs);t=[{action:i,recordId:e.primaryColumnValue||e.recordId,defaultValues:n}]}}return t}}Z.\u0275fac=function(e){return new(e||Z)},Z.\u0275prov=s.\u0275\u0275defineInjectable({token:Z,factory:Z.\u0275fac});class Y{constructor(e){this._locationStrategy=e}shouldAppendState(e){return this._locationStrategy.getActivePathInfo().schemaName===e}appendState(e){const t=this._locationStrategy.getActivePathInfo(),i=this._locationStrategy.path().split("/");e.moduleName??(e.moduleName=t.moduleName),e.schemaName??(e.schemaName=t.schemaName),e.operationType??(e.operationType=t.operationType);let n=3;if(i.length>4&&e?.operationType!=="add"&&(n=4,i[3]&&(e.recordId=t.recordId)),i.length>4){const o=(i.length-n)/2;e.valuePairs=[];for(let r=0;r<o;r++){const c=n+r*2;e.valuePairs[r]={name:i[c],value:i[c+1]}}}else i[3]&&(e.recordId=t.recordId)}}Y.\u0275fac=function(e){return new(e||Y)(s.\u0275\u0275inject(y))},Y.\u0275prov=s.\u0275\u0275defineInjectable({token:Y,factory:Y.\u0275fac});class D{constructor(e,t,i){this._location=e,this._entityTransitionConfigBuilder=t,this._featureService=i}_getRecordUrl(e){var t=this;return(0,l.Z)(function*(){const i={options:{type:N.Entity,action:p.ModelInPageAction.Edit,...e}},n={mode:S.Push,state:{},options:i.options},r=`#${(yield t._entityTransitionConfigBuilder.getTransitionConfig(n)).location}`;return`${t._location.getBaseHref()}/${r}`})()}getUrl(e){var t=this;return(0,l.Z)(function*(){return(yield t._featureService.getFeatureState("DisableEntityRecordUrlCreation"))?yield t._getRecordUrl(e):(0,h.getEntityUrl)(e.entityName,e.recordId)})()}}D.\u0275fac=function(e){return new(e||D)(s.\u0275\u0275inject(y),s.\u0275\u0275inject(C),s.\u0275\u0275inject(p.FeatureService))},D.\u0275prov=s.\u0275\u0275defineInjectable({token:D,factory:D.\u0275fac});var ge=v(74742);class V{get entityStructure(){return Object.values(window.Terrasoft.configuration.EntityStructure)}get moduleStructure(){return Object.values(window.Terrasoft.configuration.ModuleStructure)}get currentUserWorkplaces(){return window.Terrasoft.configuration.WorkplacesStructure?.CurrentUserWorkplaces}_isSectionExistsInWorkplaces(e){return this.currentUserWorkplaces?.length<1?this.moduleStructure.some(t=>t.sectionSchema===e):this.currentUserWorkplaces.some(t=>t.modules.some(i=>i.sectionName===e))}_isPageAccessible(e){return this.entityStructure.some(t=>t.pages.some(i=>i.cardSchema===e&&(i.isDefault===!0||Object.values(i.actions).some(n=>n===!0))&&i.role!==this._getPageExcludedRole()))}_getPageExcludedRole(){return this._userInfo.isSSP?h.ALL_EMPLOYEES_SYSADMINUNIT_ID:h.ALL_PORTAL_USERS_SYSADMINUNIT_ID}_is7xPageAccessible(e){if(!this._pageExistsInModuleStructure(e)&&!this._userInfo.isSSP)return!0;const t=this.moduleStructure.filter(n=>n.cardSchema===e||n.pages?.some(o=>o.cardSchema===e)).map(n=>n.moduleId);return this.currentUserWorkplaces.flatMap(n=>n.modules).some(n=>t.includes(n.moduleId))}_getRedirectState(){return{state:{moduleName:"Desktop"},path:"Desktop"}}_pageExistsInModuleStructure(e){return this.moduleStructure.some(t=>t.cardSchema===e)}_getRouteTargetType(e){if(e.isInChain)return"ModuleInChain";switch(e.moduleName){case"CardSchemaViewModule":return"FreedomPage";case"CardModuleV2":return"7xPage";case"SectionSchemaViewModule":return"FreedomSection";case"SectionModuleV2":return e.operationType?"7xPage":"7xSection";default:return}}constructor(e){this._injector=e,this._userInfo=this._injector.get(h.UserInfo),this._clientLogService=this._injector.get(h.ClientLogService)}canActivate(e){let t,i;if(this._injector.get(h.ACCESS_CONTROL_WHITELIST)?.includes(e.schemaName))return Promise.resolve(!0);switch(this._getRouteTargetType(e)){case"FreedomSection":case"7xSection":i=h.AclRules.SectionAccess,t=e.schemaName?this._isSectionExistsInWorkplaces(e.schemaName):!0;break;case"FreedomPage":i=h.AclRules.PageAccess,t=this._isPageAccessible(e.schemaName);break;case"7xPage":i=h.AclRules.PageAccess,t=this._is7xPageAccessible(e.schemaName);break;case"ModuleInChain":default:t=!0;break}return t?Promise.resolve(!0):(console.error(new h.AclRightsException().message),this._clientLogService.logError(new h.AclRightsException(e.schemaName,this._userInfo.contactName,i)).subscribe(),Promise.resolve(this._getRedirectState()))}}V.\u0275fac=function(e){return new(e||V)(s.\u0275\u0275inject(s.Injector))},V.\u0275prov=s.\u0275\u0275defineInjectable({token:V,factory:V.\u0275fac});class X extends h.SchemaAccessService{constructor(e){super(e),this.injector=e,this._navigationService=this.injector.get(L)}_bypassPageOpeningRestrictions(){return this._navigationService.getState().bypassPageOpeningRestrictions}checkAccess(e){var t=()=>super.checkAccess,i=this;return(0,l.Z)(function*(){e&&!i._bypassPageOpeningRestrictions()&&(yield t().call(i,e))})()}}X.\u0275fac=function(e){return new(e||X)(s.\u0275\u0275inject(s.Injector))},X.\u0275prov=s.\u0275\u0275defineInjectable({token:X,factory:X.\u0275fac,providedIn:"root"});const Pe=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"Za postavljanje stranica idite na URL: {0}"}}'),Ae=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),Ue=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"Nincs oldal \xFAj vagy megl\xE9v\u0151 rekordhoz. A rendszergazd\xE1nak ellen\u0151riznie kell a gombbe\xE1ll\xEDt\xE1sokat a Freedom UI-ban","GoToEntityDesignerMessage":"Az oldalak be\xE1ll\xEDt\xE1s\xE1hoz l\xE9pjen a k\xF6vetkez\u0151 URL-re: {0}"}}'),je=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),xe=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"\u041D\u044F\u043C\u0430 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0430 \u0437\u0430 \u043D\u043E\u0432 \u0438\u043B\u0438 \u0441\u044A\u0449\u0435\u0441\u0442\u0432\u0443\u0432\u0430\u0449 \u0437\u0430\u043F\u0438\u0441. \u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0438\u044F\u0442 \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440 \u0442\u0440\u044F\u0431\u0432\u0430 \u0434\u0430 \u043F\u0440\u043E\u0432\u0435\u0440\u0438 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438\u0442\u0435 \u043D\u0430 \u0431\u0443\u0442\u043E\u043D\u0438\u0442\u0435 \u0432 \u043F\u043E\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043B\u0441\u043A\u0438\u044F \u0438\u043D\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043D\u0430 Freedom","GoToEntityDesignerMessage":"\u0417\u0430 \u0434\u0430 \u043D\u0430\u0441\u0442\u0440\u043E\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0438, \u043E\u0442\u0438\u0434\u0435\u0442\u0435 \u043D\u0430 URL: {0}"}}'),He=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),Oe=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"Es gibt keine Seite f\xFCr neue oder bestehende Aufzeichnungen. Systemadministrator muss die Einstellungen der Freiheits-Oberfl\xE4che \xFCberpr\xFCfen","GoToEntityDesignerMessage":"Um Seiten einzurichten, gehen Sie zu URL: {0}"}}'),Le=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),we=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"No hay ninguna p\xE1gina para el registro nuevo o existente. El administrador del sistema debe comprobar la configuraci\xF3n del bot\xF3n en la interfaz de usuario de la Freedom","GoToEntityDesignerMessage":"Para configurar p\xE1ginas vaya a la URL: {0}"}}'),ke=JSON.parse(`{"Navigation":{"DoesntHaveAddPageMessage":"Il n'y a pas de page pour les enregistrements nouveaux ou existants. L'administrateur du syst\xE8me doit v\xE9rifier les param\xE8tres du bouton dans l'interface Freedom UI","GoToEntityDesignerMessage":"Pour configurer les pages, allez \xE0 l'URL : {0}"}}`),De=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),Fe=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),Be=JSON.parse(`{"Navigation":{"DoesntHaveAddPageMessage":"Non c'\xE8 nessuna pagina per il record nuovo o esistente. L'amministratore di sistema deve controllare le impostazioni del pulsante nella Freedom UI","GoToEntityDesignerMessage":"Per impostare le pagine vai all'URL: {0}"}}`),Ge=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"\u65B0\u898F\u307E\u305F\u306F\u65E2\u5B58\u306E\u30EC\u30B3\u30FC\u30C9\u306E\u30DA\u30FC\u30B8\u306F\u3042\u308A\u307E\u305B\u3093\u3002\u30B7\u30B9\u30C6\u30E0\u7BA1\u7406\u8005\u306FFreedom UI\u306E\u30DC\u30BF\u30F3\u8A2D\u5B9A\u3092\u78BA\u8A8D\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002","GoToEntityDesignerMessage":"\u30DA\u30FC\u30B8\u3092\u30BB\u30C3\u30C8\u30A2\u30C3\u30D7\u3059\u308B\u306B\u306FURL\uFF1A {0} \u306B\u9077\u79FB\u3057\u3066\u304F\u3060\u3055\u3044\u3002"}}'),$e=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"\uC0C8 \uB808\uCF54\uB4DC \uB610\uB294 \uAE30\uC874 \uB808\uCF54\uB4DC\uC5D0 \uB300\uD55C \uD398\uC774\uC9C0\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4. \uC2DC\uC2A4\uD15C \uAD00\uB9AC\uC790\uB294 Freedom UI\uC5D0\uC11C \uBC84\uD2BC \uC124\uC815\uC744 \uD655\uC778\uD574\uC57C \uD569\uB2C8\uB2E4","GoToEntityDesignerMessage":"\uD398\uC774\uC9C0\uB97C \uC124\uC815\uD558\uB824\uBA74 URL\uB85C \uC774\uB3D9\uD569\uB2C8\uB2E4. {0}"}}'),Ze=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),Ve=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),Je=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"N\xE3o h\xE1 nenhuma p\xE1gina para os registros novos ou existentes. O administrador do sistema dever\xE1 verificar as configura\xE7\xF5es do bot\xE3o na UI Freedom","GoToEntityDesignerMessage":"Para configurar as p\xE1ginas ir para a URL: {0}"}}'),ze=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),We=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"Nu exist\u0103 nicio pagin\u0103 pentru \xEEnregistrarea nou\u0103 sau existent\u0103. Administratorul de sistem trebuie s\u0103 verifice set\u0103rile butonului din Freedom UI","GoToEntityDesignerMessage":"Pentru configurarea paginilor merge\u021Bi la URL: {0}"}}'),qe=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"\u0414\u043B\u044F \u0437\u0430\u043F\u0438\u0441\u0438 \u043D\u0435\u0442 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u044B \u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F. \u0421\u0438\u0441\u0442\u0435\u043C\u043D\u043E\u043C\u0443 \u0430\u0434\u043C\u0438\u043D\u0438\u0441\u0442\u0440\u0430\u0442\u043E\u0440\u0443 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u043F\u0440\u043E\u0432\u0435\u0440\u0438\u0442\u044C \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0443 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u043E\u0432 \u043A\u043D\u043E\u043F\u043A\u0438 \u0432 \u0434\u0438\u0437\u0430\u0439\u043D\u0435\u0440\u0435 Freedom UI","GoToEntityDesignerMessage":"\u0414\u043B\u044F \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u0441\u0442\u0440\u0430\u043D\u0438\u0446 \u043F\u0435\u0440\u0435\u0439\u0434\u0438\u0442\u0435 \u043F\u043E \u0441\u0441\u044B\u043B\u043A\u0435: {0}"}}'),Ye=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"Nuk ka faqe p\xEBr t\xEB dh\xEBna t\xEB reja ose ekzistuese. Administratori i sistemit duhet t\xEB kontrolloj\xEB butonin e konfigurimit n\xEB Freedom Ul","GoToEntityDesignerMessage":"P\xEBr t\xEB konfiguruar faqet shko te URL:{0}"}}'),Xe=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),Qe=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),Ke=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),et=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"\u041D\u0435\u043C\u0430\u0454 \u0441\u0442\u043E\u0440\u0456\u043D\u043A\u0438 \u0434\u043B\u044F \u043D\u043E\u0432\u043E\u0433\u043E \u0430\u0431\u043E \u0456\u0441\u043D\u0443\u044E\u0447\u043E\u0433\u043E \u0437\u0430\u043F\u0438\u0441\u0443. \u0421\u0438\u0441\u0442\u0435\u043C\u043D\u0438\u0439 \u0430\u0434\u043C\u0456\u043D\u0456\u0441\u0442\u0440\u0430\u0442\u043E\u0440 \u043C\u0430\u0454 \u043F\u0435\u0440\u0435\u0432\u0456\u0440\u0438\u0442\u0438 \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F \u043A\u043D\u043E\u043F\u043E\u043A \u0443 Freedom UI","GoToEntityDesignerMessage":"\u0414\u043B\u044F \u043D\u0430\u043B\u0430\u0448\u0442\u0443\u0432\u0430\u043D\u043D\u044F \u0441\u0442\u043E\u0440\u0456\u043D\u043E\u043A \u043F\u0435\u0440\u0435\u0439\u0434\u0456\u0442\u044C \u0434\u043E URL: {0}"}}'),tt=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"There is no page for new or existing record. System administrator must check the button settings in the Freedom UI","GoToEntityDesignerMessage":"To set up pages go to URL: {0}"}}'),it=JSON.parse('{"Navigation":{"DoesntHaveAddPageMessage":"\u6CA1\u6709\u65B0\u8BB0\u5F55\u6216\u73B0\u6709\u8BB0\u5F55\u7684\u9875\u9762\u3002\u7CFB\u7EDF\u7BA1\u7406\u5458\u5FC5\u987B\u68C0\u67E5\u81EA\u7531\u754C\u9762\u4E2D\u7684\u6309\u94AE\u8BBE\u7F6E","GoToEntityDesignerMessage":"\u8981\u8BBE\u7F6E\u9875\u9762, \u8BF7\u8BBF\u95EEURL: {0}"}}'),nt={"hr-HR":Pe,"lv-LV":Ae,"hu-HU":Ue,"zh-CN":it,"vi-VN":tt,"uk-UA":et,"tr-TR":Ke,"th-TH":Qe,"sv-SE":Xe,"sq-AL":Ye,"ro-RO":We,"pt-PT":ze,"pt-BR":Je,"pl-PL":Ve,"nl-NL":Ze,"ko-KR":$e,"ja-JP":Ge,"it-IT":Be,"id-ID":Fe,"he-IL":De,"fr-FR":ke,"es-ES":we,"de-DE":Oe,"cs-CZ":He,"bg-BG":xe,"ar-SA":je,"en-US":Le,"ru-RU":qe};let A=class{};A.\u0275fac=function(e){return new(e||A)},A.\u0275mod=s.\u0275\u0275defineNgModule({type:A}),A.\u0275inj=s.\u0275\u0275defineInjector({providers:[Z,D,{provide:y,useClass:F},x,{provide:de,useClass:V,multi:!0},{provide:h.SchemaAccessService,useClass:X},j.LoggerService,p.RightsService],imports:[j.CrtLibTranslateModule.forRoot({i18n:nt}),w,O,k]}),A=(0,ge.__decorate)([(0,p.CrtModule)({requestHandlers:[]})],A),function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(A,{imports:[j.CrtLibTranslateModule,w,O,k]})}();let he=class extends p.BaseRequestHandler{constructor(e,t){super(),this._navigationService=e,this._recordUrlCreator=t}_getEntityPageUITypePriority(e){var t=this;return(0,l.Z)(function*(){const i=t._navigationService.getActiveRouteInfo().schemaName;return i&&(yield d.NavigationUtils.isAngularListPage(i))&&d.NavigationUtils.getSectionEntityName(i)===e?d.UITypePriority.PreferFreedomUI:d.UITypePriority.Auto})()}_openEntityPage(e,t){var i=this;return(0,l.Z)(function*(){const n=t,o=yield i._getEntityPageUITypePriority(n?.entityName);yield i._navigationService.navigate({mode:n.replaceHistoryState?S.Replace:S.Push,options:{type:N.Entity,action:e,uiTypePriority:o,...n}})})()}_openDuplicatesPage(e){var t=this;return(0,l.Z)(function*(){yield t._navigationService.navigate({mode:S.Push,state:{duplicatesSchemaName:e.entityName},options:{type:N.Schema,schemaName:e.schemaName}})})()}_getEntityPageUrl(e){var t=this;return(0,l.Z)(function*(){const i=e,n=yield t._getEntityPageUITypePriority(i?.entityName);return t._recordUrlCreator.getUrl({uiTypePriority:n,...i})})()}handle(e){var t=this;return(0,l.Z)(function*(){const i=e?.payload;switch(e.action){case"BackHistoryState":t._navigationService.back();break;case"AddRecord":yield t._openEntityPage(p.ModelInPageAction.Add,i);break;case"EditRecord":yield t._openEntityPage(p.ModelInPageAction.Edit,i);break;case"CopyRecord":yield t._openEntityPage(p.ModelInPageAction.Copy,i);break;case"OpenDuplicatesPage":yield t._openDuplicatesPage(i);break;case"OpenPage":yield t._navigationService.navigate({mode:S.Push,options:{type:N.Schema,...i}});break;case"HasEntityEditPage":return d.NavigationUtils.hasEntityEditPage(i);case"LoadRightsModule":yield t._navigationService.navigate({mode:S.Push,options:{type:N.Module,initConfig:{moduleConfig:i},moduleId:j.NameGenerator.generateUnique("Rights_module"),moduleName:"Rights"},state:{isInChain:!0,silent:!0,_internalNotSilentIn8x:!0}});break;case"GetRecordUrl":return t._getEntityPageUrl(i);case"IsTelephonyEnabled":case"InitDataViews":break}return t.next?.handle(e)})()}};he=(0,ge.__decorate)([(0,p.CrtRequestHandler)({requestType:"crt.7XRequest",type:"crt.Crt7XRequestHandler"}),(0,ge.__metadata)("design:paramtypes",[L,D])],he);class at{constructor(){this.navigateStart$=new u.Subject,this.navigateEnd$=new u.Subject,this.historyState$=new u.Subject,this._history=[]}push(e){const t=this._history.length+1;e={...e,historyIndex:t},this._history.push(e),this.historyState$.next(e)}back(){this._history.pop();const e=this._history[this._history.length-1];this.historyState$.next(e)}getNavigation$(e){return this.historyState$.pipe((0,u.map)(t=>({state:t,...T.parse(window.location.href)})))}getChildNavigation$(e,t){return(0,u.of)()}onNavigateEnd(){}getActiveRouteInfo(){const e=this._history.at(-1);return{moduleName:e.moduleName,schemaName:e.schemaName,operationType:e.operation,recordId:e.recordId}}}}}]);
