(self.webpackChunkapp_studio_enterprise_duplicates_widget=self.webpackChunkapp_studio_enterprise_duplicates_widget||[]).push([[1964],{31964:(ke,Se,C)=>{C.r(Se),C.d(Se,{AttributeBindingExpressionInterpreter:()=>P,AttributeControlBindingExpressionInterpreter:()=>T,AttributePropertyBindingExpressionInterpreter:()=>G,BINDING_CONTEXT:()=>K,BINDING_CONTEXT_DESIGN_TIME:()=>Ze,BaseDynamicModule:()=>Y,BaseViewElementComponentCreator:()=>Qe,BindableDirective:()=>ne,BindingContextMock:()=>_e,BindingExpressionInterpreter:()=>S,BindingPipe:()=>oe,ComponentViewElementRef:()=>Xe,ConverterExpressionInterpreter:()=>j,ConverterRegistryService:()=>ee,CrtAsyncPipe:()=>J,CrtBaseComponent:()=>$,DESIGNER_TOOL_GROUP_CONFIG:()=>Jt,DesignTimeViewElementTypeResolver:()=>me,FixedValueBindingExpressionInterpreter:()=>W,IGNORE_VIEW_ELEMENTS_NOT_FOUND_TOKEN:()=>ut,JIT_MODULES:()=>$e,ObjectPropBindingExpressionInterpreter:()=>D,RequestBindingConfigInterpreter:()=>O,RequestParamBindingExpressionInterpreter:()=>Z,ResourceBindingExpressionInterpreter:()=>H,ReusableViewGeneratorCacheService:()=>ce,ReusableViewGeneratorDirective:()=>k,SCHEMA_BINDING_CACHE:()=>bt,ToolbarViewElementConfigResolver:()=>ye,VIEW_ELEMENT_COMPONENT_CREATOR:()=>Ke,VIEW_ELEMENT_CONFIG:()=>z,ValidationStateBindingExpressionInterpreter:()=>N,ViewElementComponentCreator:()=>et,ViewElementConfigUtils:()=>je,ViewElementDirective:()=>B,ViewElementPlaceholderComponent:()=>M,ViewElementPlaceholderModule:()=>m,ViewElementTypeResolver:()=>V,ViewElementWebComponentCreator:()=>gt,ViewEventsNotifier:()=>ae,ViewGeneratorDirective:()=>Q,ViewGeneratorModule:()=>L,ViewInitDirective:()=>se,ViewModelDirective:()=>q,ViewModule:()=>A,WebComponentViewElementRef:()=>ft,bindingExpressionInterpretersProviders:()=>Pe,changeAttributeValueFromUI:()=>ze,designTimeFactory:()=>It,factory:()=>wt,getAssociatedInputName:()=>lt,getAssociatedOutputName:()=>ge,getAssociatedValidationInputName:()=>He,getAttributeLocation:()=>Me,getRelativeAttributeBindingPath:()=>Ve,getRequestBindingConfigs:()=>Yt,getRootBindingContext:()=>de,getTargetBindingContextInfo:()=>Re,hasAssociatedInput:()=>Tt,hasAssociatedOutput:()=>Mt,hasAssociatedValidationInput:()=>Be,hasInput:()=>he,hasOutput:()=>fe,hasValidationInfo:()=>At,isBindToViewModelAttribute:()=>xt,markControlAsTouched:()=>Je,parseAttributePath:()=>Ue,viewConfigLtrMock:()=>zt,viewConfigRtlMock:()=>qt});var Ae=C(74742),pe=C(99852),s=C(94450),g=C(75378),v=C(52045),y=C(97600);class $ extends v.CrtInjectorConstructor{set shape(e){this._shape=e;const t=this._classes.indexOf("crt-component-rounded");this.shape==="rounded"?t===-1&&this._classes.push("crt-component-rounded"):t>=0&&this._classes.splice(t,1)}get shape(){return this._shape}get classes(){return this.getClasses()}set classes(e){this.setClasses(e)}get loading(){return this._loading}set loading(e){this._loading=Boolean(e),typeof e=="boolean"&&(e?this.handleStartLoadViewModelAttributes():this.handleFinishLoadViewModelAttributes())}constructor(e){super(e),this.injector=e,this._loading=!1,this._classes=[],this.documentDirection=null,this.documentDirection=e.get(pe.Directionality)?.value==="rtl"?"rtl":null,this.changeDetectorRef=this.injector.get(s.ChangeDetectorRef),this.directionality=this.injector.get(pe.Directionality),this.elementRef=this.injector.get(s.ElementRef)}handleStartLoadViewModelAttributes(){}handleFinishLoadViewModelAttributes(){}setClasses(e){this._classes=e||[]}getClasses(){return this._classes}toggleClass(e,t,n){const i=e.indexOf(n);t&&i===-1&&e.push(n),!t&&i>=0&&e.splice(i,1)}switchClass(e,t,n){n.forEach(([i,o])=>{this.toggleClass(e,i===t,o)})}setValuesFromConfig(e,t=[]){const n=(0,y.omit)(e,["id","name","type",...t]);Object.entries(n).forEach(([i,o])=>{this[i]=o})}detectChanges(){this.changeDetectorRef.detectChanges()}isRtl(){return this.directionality.value==="rtl"}focus(){this.elementRef?.nativeElement.focus()}}$.\u0275fac=function(e){return new(e||$)(s.\u0275\u0275directiveInject(s.Injector))},$.\u0275dir=s.\u0275\u0275defineDirective({type:$,hostVars:2,hostBindings:function(e,t){e&2&&s.\u0275\u0275attribute("element-name",t.name)("dir",t.documentDirection)},inputs:{name:"name",id:"id",tabIndex:"tabIndex",styles:"styles",shape:"shape",classes:"classes",loading:"loading"},features:[s.\u0275\u0275InheritDefinitionFeature]}),(0,Ae.__decorate)([(0,g.CrtInput)(),(0,Ae.__metadata)("design:type",Boolean),(0,Ae.__metadata)("design:paramtypes",[Boolean])],$.prototype,"loading",null);var R=C(31134),Ee=C(72856),Le=C(54514);class M{constructor(e,t){this.caption="",e.addSvgIconLiteral("placeholder",t.bypassSecurityTrustHtml(C(57421)))}}M.\u0275fac=function(e){return new(e||M)(s.\u0275\u0275directiveInject(Ee.MatIconRegistry),s.\u0275\u0275directiveInject(Le.DomSanitizer))},M.\u0275cmp=s.\u0275\u0275defineComponent({type:M,selectors:[["crt-view-element-placeholder"]],inputs:{caption:"caption"},decls:4,vars:1,consts:[[1,"placeholder-container"],["svgIcon","placeholder",1,"icon"]],template:function(e,t){e&1&&(s.\u0275\u0275elementStart(0,"div",0),s.\u0275\u0275element(1,"mat-icon",1),s.\u0275\u0275elementStart(2,"span"),s.\u0275\u0275text(3),s.\u0275\u0275elementEnd()()),e&2&&(s.\u0275\u0275advance(3),s.\u0275\u0275textInterpolate(t.caption))},dependencies:[Ee.MatIcon],styles:[".placeholder-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;align-content:center;justify-content:center;border-radius:8px;position:relative;overflow:hidden}.placeholder-container[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:100%;max-height:64px;width:72px;align-self:center}.placeholder-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:8px;right:8px;transform:translateY(-50%);overflow:hidden;width:calc(100% - 16px);text-overflow:ellipsis}@supports (background: -webkit-named-image(i)){.placeholder-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:initial;height:initial}}"]});class m{}m.\u0275fac=function(e){return new(e||m)},m.\u0275mod=s.\u0275\u0275defineNgModule({type:m}),m.\u0275inj=s.\u0275\u0275defineInjector({imports:[R.CommonModule,Ee.MatIconModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(m,{declarations:[M],imports:[R.CommonModule,Ee.MatIconModule],exports:[M]})}();var f=C(49475),d=C(21322),p=C(27049),F=C(34560),I=C(24709);class b{constructor(e=new d.Subscription,t=Promise.resolve()){this._subscription=e,this.ready=t}static all(e){const t=(0,f.joinSubscriptions)(e.map(i=>i._subscription)),n=Promise.all(e.map(i=>i.ready)).then(()=>{});return new b(t,n)}static subscribe(e,t,n=!1){e=e.pipe((0,p.share)());const i=e.subscribe({next:t}),o=n?(0,d.lastValueFrom)(e.pipe((0,p.first)(),(0,p.map)(()=>{})),{defaultValue:null}):Promise.resolve();return new b(i,o)}unsubscribe(){this._subscription.unsubscribe()}}var U=C(8239);function Ve(r,e){if(!r)return e;if(!e.startsWith(r))throw new Error(`Attribute path '${e}' should start with '${r}'`);return e.substring(r.length+1)}function Ue(r){if(!(0,v.isBindingExpression)(r))throw new Error(`'${r}' is not binding expression`);const e=r.indexOf("|");return e>-1&&(r=r.substring(0,e).trimEnd()),r.substring(1)}function Me(r,e){return Ge.apply(this,arguments)}function Ge(){return Ge=(0,U.Z)(function*(r,e){const t=e.match(/^(?:(?<attributeHostPath>.+)\.)?(?<attributeName>[^.]+)$/),{attributeHostPath:n,attributeName:i}=t.groups,o=n?yield(0,I.get)(r,n):r;return{attributeName:i,attributeHost:o}}),Ge.apply(this,arguments)}function de(r){for(;r.parent;)r=r.parent;return r}function Re(r,e){const t=r.split(".").slice(0,-1),n=ot(e),i=n.map(o=>o.viewModel$.pipe((0,p.take)(1)));return(0,d.forkJoin)(i).pipe((0,p.map)(o=>{const c=[];let a=n.length-1,l=[];for(const u of t)if(c.push(u),Bt(o[a],c)&&(l=[...c],a--,a<0))return null;return{context:n[a],contextPath:l.join(".")}}))}function ot(r){const e=[r];return r.parent&&e.push(...ot(r.parent)),e}function Bt(r,e){let t=r;for(const n of e)t=t?.attributes?t.attributes[n]:t?.[n];return t instanceof I.BaseViewModelCollection}function xt(r,e){if(typeof r=="string"){const t=r.startsWith("$"),n=r.slice(1).split(".").pop()||"",i=e?.[n]!=null;return t&&i}return!1}class at{getAttributeValuesStream(e,t){return e?e.events$.pipe((0,p.filter)(n=>n.type===I.ViewModelEventType.ChangeAttributeValue),(0,p.filter)(n=>n?.payload?.attributeName===t),(0,p.switchMap)(n=>t in e?Promise.resolve(e[t]):Promise.resolve(n.payload.value)),(0,p.share)()):(0,d.of)(null)}getAttributeInitialValueStream(e,t,n){return e?(0,d.from)((0,I.get)(e,t)).pipe((0,p.takeUntil)(n)):(0,d.of)(null)}getAttributeLocationChanges(e,t){return Re(e,t).pipe((0,p.tap)(n=>{if(!n)throw new Error(`Target binding context for attribute "${e} was not found"`)}),(0,p.switchMap)(({context:n,contextPath:i})=>(0,d.combineLatest)([n.viewModel$,(0,d.of)(Ve(i,e))])),(0,p.switchMap)(([n,i])=>n?Me(n,i):(0,d.of)({attributeName:void 0,attributeHost:void 0})))}evaluate(e,t){const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.switchMap)(i=>this.getAttributeValueChanges(i)))}}class P extends at{getAttributeValueChanges({attributeHost:e,attributeName:t}){const n=this.getAttributeValuesStream(e,t),i=this.getAttributeInitialValueStream(e,t,n);return(0,d.merge)(i,n)}}P.\u0275fac=function(){let r;return function(t){return(r||(r=s.\u0275\u0275getInheritedFactory(P)))(t||P)}}(),P.\u0275prov=s.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac});var ct=C(41307);const St="DisableAttributeDeactivationUntilBRulesExecution";class G extends at{constructor(e){super(),this._featureService=e,this._readonlyProperties=["readonly","disabled"]}getAttributeValueChangesInHybridMode(e,t,n,i){const o=e.getControl(t),c=i.slice(1);return this._getValuesStream(e,t,n,()=>{const a=this.getAttributeValuesStream(e,c).pipe((0,p.tap)(h=>o.setPropertyValue(n,h))),l=this.getAttributeValuesStream(e,`${t}:${n}`).pipe((0,p.filter)(()=>{const h=Object.getOwnPropertyDescriptor(e,c),_=Boolean(h?.get),E=Boolean(h?.set);return!(_&&!E)}),(0,p.tap)(h=>e[c]=h)),u=(0,d.from)((0,I.get)(e,c)).pipe((0,p.tap)(h=>o.setPropertyValue(n,h,!0)),(0,p.takeUntil)(a));return(0,d.merge)(u,a,l)})}_getDefaultValue(e){if(!e)return null;try{return JSON.parse(e)}catch{return e}}_getValuesStream(e,t,n,i){return this._readonlyProperties.includes(n)?(0,d.forkJoin)({disableAttributeDeactivation:this._featureService.getFeatureState(St),hasBRulesAffectingAttribute:e._getIsAffectedByBusinessRules({name:t})}).pipe((0,p.switchMap)(({disableAttributeDeactivation:o,hasBRulesAffectingAttribute:c})=>o||c!==!0?i():e._businessRulesActivated$.pipe((0,p.switchMap)(a=>a?i():(0,d.of)(!0))))):i()}getAttributeValueChanges(e){const{attributeHost:t}=e;if(!t)return(0,d.of)(null);const[n,i]=e.attributeName.split(":"),[o,c]=i.split("="),a=t.getControl(n),l=this._getDefaultValue(c);if(typeof l=="string"&&l?.startsWith("$"))return this.getAttributeValueChangesInHybridMode(t,n,o,l);if(l!=null){const u=a.getPropertyByName(o,!0);u.hasInitialValue||u.setInitialValue(l)}return this._getValuesStream(t,n,o,()=>{const u=this.getAttributeValuesStream(t,`${n}:${o}`),h=(0,d.of)(a.getPropertyValue(o)).pipe((0,p.filter)(_=>_!=null),(0,p.takeUntil)(u));return(0,d.merge)(h,u)})}}G.\u0275fac=function(e){return new(e||G)(s.\u0275\u0275inject(ct.FeatureService))},G.\u0275prov=s.\u0275\u0275defineInjectable({token:G,factory:G.\u0275fac});class T extends P{removeConvertersFromExpression(e){const t=e.indexOf("|");return t===-1?e:(console.warn(`Cannot use converters in control binding expression: ${e}`),e.substring(0,t).trimEnd())}evaluate(e,t){e=this.removeConvertersFromExpression(e);const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.map)(({attributeHost:i,attributeName:o})=>i?i.getAttributeControl(o):new F.FormControl(null)))}}T.\u0275fac=function(){let r;return function(t){return(r||(r=s.\u0275\u0275getInheritedFactory(T)))(t||T)}}(),T.\u0275prov=s.\u0275\u0275defineInjectable({token:T,factory:T.\u0275fac});class W{_getStringValue(e){return e.match(/^'(.*)'$/)[1]}_getBooleanValue(e){if(e==="true")return!0;if(e==="false")return!1;throw new Error(`${e} is not Boolean value`)}evaluate(e){if((0,v.isFixedStringValueExpression)(e))return(0,d.of)(this._getStringValue(e));if((0,v.isFixedNumberValueExpression)(e))return(0,d.of)(parseFloat(e));if((0,v.isFixedBooleanValueExpression)(e))return(0,d.of)(this._getBooleanValue(e));throw new Error(`Failed to parse primitive value binding expression: ${e}`)}}W.\u0275fac=function(e){return new(e||W)},W.\u0275prov=s.\u0275\u0275defineInjectable({token:W,factory:W.\u0275fac});class D extends P{_getViewModelCollectionValue(e,t){if(!t.length)return Promise.resolve(e);const n=Array.from(e).map(i=>this._getObjectProp(i,t));return Promise.all(n)}_getObjectProp(e,t){var n=this;return(0,U.Z)(function*(){const i=t.shift();return i?(e=yield e[i],e instanceof I.BaseViewModel?n._getObjectProp(e,t):e instanceof I.BaseViewModelCollection?n._getViewModelCollectionValue(e,t):n._getObjectProp(e,t)):e})()}evaluate(e,t){const n=e.slice(1);return Re(n,t).pipe((0,p.map)(i=>i??{context:de(t),contextPath:""}),(0,p.switchMap)(i=>(0,d.combineLatest)([i.context.viewModel$,(0,d.of)(Ve(i.contextPath,n))])),(0,p.switchMap)(([i,o])=>i?this._getObjectProp(i,o.split(".")):(0,d.of)(null)),(0,p.take)(1))}}D.\u0275fac=function(){let r;return function(t){return(r||(r=s.\u0275\u0275getInheritedFactory(D)))(t||D)}}(),D.\u0275prov=s.\u0275\u0275defineInjectable({token:D,factory:D.\u0275fac});class ee{constructor(){this._converterRegistry=g.ConverterRegistry,this._injector=(0,s.inject)(s.Injector)}get(e,t){return this._converterRegistry.get(e).instantiate(t)}register(e,t){throw new Error("NotImplemented")}clear(){this._converterRegistry.clear()}}ee.\u0275fac=function(e){return new(e||ee)},ee.\u0275prov=s.\u0275\u0275defineInjectable({token:ee,factory:ee.\u0275fac,providedIn:"root"});class j extends I.AbstractExpressionInterpreter{constructor(e,t,n,i=!1){super(),this._convertersRegistry=e,this._objectPropBindingExpressionInterpreter=t,this._fixedValueBindingExpressionInterpreter=n,this._isDesignTime=i}_evaluateParam(e,t){if((0,v.isFixedValueBindingExpression)(e))return this._fixedValueBindingExpressionInterpreter.evaluate(e);if((0,v.isBindingExpression)(e))return this._objectPropBindingExpressionInterpreter.evaluate(e,t);throw new Error(`Cannot parse parameter expression: ${e}`)}_evaluateParams(e,t){const n=e.map(i=>this._evaluateParam(i,t).pipe((0,p.first)()));return(0,d.forkJoin)(n).pipe((0,p.defaultIfEmpty)([]))}_getConverters(e,t){return e.split("|").map(i=>i.trim()).map(i=>{const[o,...c]=i.split(":").map(u=>u.trim()),a=this._evaluateParams(c,t),l=t.viewModel$.pipe((0,p.first)());return(0,d.forkJoin)([l,a]).pipe((0,p.map)(([u,h])=>_=>{if(!u)return null;const E=u._injectionContext;return this._convertersRegistry.get(o,E).convert(_,u,...h)}))})}_applyConverters(e,t){for(const[n,i]of Object.entries(t))if(e=i(e),e instanceof Promise){const o=parseInt(n,10)+1;return this._applyAsyncConverters(e,[...t].slice(o))}return e}_applyAsyncConverters(e,t){return(0,U.Z)(function*(){let n=yield e;for(const i of t)n=i(n),n instanceof Promise&&(n=yield n);return n})()}evaluate(e,t){if(this._isDesignTime||(0,y.isEmpty)(e))return(0,d.of)(i=>i);const n=this._getConverters(e,t);return(0,d.forkJoin)(n).pipe((0,p.map)(i=>o=>this._applyConverters(o,i)))}}j.\u0275fac=function(e){return new(e||j)(s.\u0275\u0275inject(ee),s.\u0275\u0275inject(D),s.\u0275\u0275inject(W),s.\u0275\u0275inject(f.IS_DESIGN_TIME,8))},j.\u0275prov=s.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac});class H{evaluate(e,t){const n=e.slice(1);return de(t).viewModel$.pipe((0,p.switchMap)(i=>i?(0,I.get)(i,n):(0,d.of)(null)))}}H.\u0275fac=function(e){return new(e||H)},H.\u0275prov=s.\u0275\u0275defineInjectable({token:H,factory:H.\u0275fac});class S{constructor(e,t,n,i){this._attributeBindingExpressionInterpreter=e,this._attributePropertyBindingExpressionInterpreter=t,this._resourceBindingExpressionInterpreter=n,this._converterExpressionInterpreter=i}_applyConverter(e,t){return(0,U.Z)(function*(){return e=t(e),e instanceof Promise&&(e=yield e),e})()}evaluateInputValueExpression(e,t){return(0,v.isResourceBindingExpression)(e)?this._resourceBindingExpressionInterpreter.evaluate(e,t):(0,v.isPropertyBindingExpression)(e)?this._attributePropertyBindingExpressionInterpreter.evaluate(e,t):this._attributeBindingExpressionInterpreter.evaluate(e,t)}evaluate(e,t){const n=/\|(.*)/,[i,o]=e.split(n).map(l=>l.trim()),c=this.evaluateInputValueExpression(i,t),a=this._converterExpressionInterpreter.evaluate(o,t);return c.pipe((0,p.switchMap)(l=>a.pipe((0,p.switchMap)(u=>this._applyConverter(l,u)))))}}S.\u0275fac=function(e){return new(e||S)(s.\u0275\u0275inject(P),s.\u0275\u0275inject(G),s.\u0275\u0275inject(H),s.\u0275\u0275inject(j))},S.\u0275prov=s.\u0275\u0275defineInjectable({token:S,factory:S.\u0275fac});class Z extends S{constructor(e,t){super(null,null,null,t),this._objectPropBindingExpressionInterpreter=e}_evaluateEventBindingExpression(e,t){const n=t.initialEvent,i=e.replace(/@event\.?/,"");return(0,d.of)(i?(0,y.get)(n,i):n)}evaluateInputValueExpression(e,t){return(0,v.isEventBindingExpression)(e)?this._evaluateEventBindingExpression(e,t):this._objectPropBindingExpressionInterpreter.evaluate(e,t)}}Z.\u0275fac=function(e){return new(e||Z)(s.\u0275\u0275inject(D),s.\u0275\u0275inject(j))},Z.\u0275prov=s.\u0275\u0275defineInjectable({token:Z,factory:Z.\u0275fac});class te{constructor(e){this._requestParamBindingExpressionInterceptor=e}_evaluate(e,t){var n=this;return(0,U.Z)(function*(){const i={};for(const[o,c]of Object.entries(e))i[o]=yield n._evaluateConfigValue(c,t);return i})()}_evaluateConfigValue(e,t){return Array.isArray(e)?Promise.all(e.map(n=>this._evaluateConfigValue(n,t))):(0,v.isBindingExpression)(e)||(0,v.isEventBindingExpression)(e)?(0,d.lastValueFrom)(this._requestParamBindingExpressionInterceptor.evaluate(e,t),{defaultValue:null}):e&&typeof e=="object"?this._evaluate(e,t):Promise.resolve(e)}evaluate(e,t){return(0,d.from)(this._evaluate(e,t))}}te.\u0275fac=function(e){return new(e||te)(s.\u0275\u0275inject(Z))},te.\u0275prov=s.\u0275\u0275defineInjectable({token:te,factory:te.\u0275fac});class O{constructor(e){this._requestParamsBindingConfigInterpreter=e}_evaluateParams(e,t){return e?this._requestParamsBindingConfigInterpreter.evaluate(e,t):(0,d.of)({})}_getRequestBindingContext(e,t){return e.useRelativeContext?t:de(t)}evaluate(e,t){return this._evaluateParams(e.params,t).pipe((0,p.withLatestFrom)(this._getRequestBindingContext(e,t).viewModel$),(0,p.map)(([n,i])=>({type:e.request,$context:i,...n})),(0,p.first)())}}O.\u0275fac=function(e){return new(e||O)(s.\u0275\u0275inject(te))},O.\u0275prov=s.\u0275\u0275defineInjectable({token:O,factory:O.\u0275fac});class N extends P{_getValidationStateChanges(e,t){const n=t.attributeHost.getAttributeControl(t.attributeName);return(0,d.merge)(e,n.statusChanges).pipe((0,p.map)(()=>({value:n.value,validationInfo:(0,y.pick)(n,"valid","errors","dirty","touched")})),(0,p.distinctUntilChanged)(y.isEqual))}evaluate(e,t){const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,p.switchMap)(i=>i.attributeHost?this._getValidationStateChanges(super.evaluate(e,t),i):(0,d.of)({value:null,validationInfo:{valid:!0,errors:null,dirty:!1,touched:!1}})))}}N.\u0275fac=function(){let r;return function(t){return(r||(r=s.\u0275\u0275getInheritedFactory(N)))(t||N)}}(),N.\u0275prov=s.\u0275\u0275defineInjectable({token:N,factory:N.\u0275fac});var Te=C(33177);const Pe=[P,G,T,S,j,D,W,O,Z,te,H,N,Te.FactoryProvider.create({token:I.EXPRESSION_INTERPRETER_FACTORY,mappings:[{predicate:"converter",injectable:j}]})],We="Change",De="ValidationInfo";function he(r,e){const t=g.ViewElementRegistry.viewElements.get(r);return Boolean(t?.inputs?.[e])}function fe(r,e){const t=g.ViewElementRegistry.viewElements.get(r);return Boolean(t?.outputs?.[e])}function At(r,e){const t=g.ViewElementRegistry.viewElements.get(r);return Boolean(t?.validationInputs?.[e])}function ge(r){return r+We}function Mt(r,e){const t=ge(e);return fe(r,t)}function He(r){return r+De}function Be(r,e){const t=e+De,n=g.ViewElementRegistry.viewElements.get(r);return Boolean(n?.validationInputs?.[t])}function lt(r){let e=null;if(r.endsWith(We))e=r.replace(new RegExp(We+"$"),"");else if(r.endsWith(De))e=r.replace(new RegExp(De+"$"),"");else return null;return e}function Tt(r,e){const t=lt(e);return Boolean(t)&&he(r,t)}class je{static _updateAttributeProperties(e,t,n,i){const o=e[t]||{},c={};i.forEach(u=>{let h=u.defaultValue;Object.prototype.hasOwnProperty.call(n,u.name)&&(h=n[u.name]??u.defaultValue),c[u.name]={defaultValue:h}});const a=g.ViewElementRegistry.getViewElementInputs(n.type);Object.entries(a).filter(([,u])=>u.propertyName!=null).forEach(([u,h])=>{c[h.propertyName]={defaultValue:u,locked:!0}}),o.properties={...o.properties??{},...c}}static updateAttributeProperties(e,t,n){const i=e.bindTo.replace("$",""),o=t?.viewModelConfig?.attributes||{};je._updateAttributeProperties(o,i,e,n)}static updateCollectionAttributeProperties(e,t,n,i){const o=e.bindTo.replace(`${n}.`,""),c=n.replace("$",""),l=(t?.viewModelConfig?.attributes||{})[c];if(!l)return;const u=l?.viewModelConfig?.attributes;!u||je._updateAttributeProperties(u,o,e,i)}}const Ze=new s.InjectionToken("CRT_BINDING_CONTEXT_DESIGN_TIME"),K=new s.InjectionToken("CRT_BINDING_CONTEXT"),z=new s.InjectionToken("CRT_VIEW_ELEMENT_CONFIG"),ut=new s.InjectionToken("Ignore view elements not found warning"),Ke=new s.InjectionToken("VIEW_ELEMENT_COMPONENT_CREATOR");function ze(r,e,t){return qe.apply(this,arguments)}function qe(){return qe=(0,U.Z)(function*(r,e,t){const n=yield(0,d.firstValueFrom)(Re(r,t)),i=yield(0,d.firstValueFrom)(n.context.viewModel$);if(!i)return;const o=Ve(n.contextPath,r),{attributeHost:c,attributeName:a}=yield Me(i,o);c.getAttributeControl(a).markAsDirty(),c[a]=e}),qe.apply(this,arguments)}function Je(r,e){return Ye.apply(this,arguments)}function Ye(){return Ye=(0,U.Z)(function*(r,e){const t=yield(0,d.firstValueFrom)(Re(r,e)),n=yield(0,d.firstValueFrom)(t.context.viewModel$);if(!n)return;const i=Ve(t.contextPath,r),{attributeHost:o,attributeName:c}=yield Me(n,i),a=o.getAttributeControl(c);a.touched||(a.markAsTouched(),a.updateValueAndValidity())}),Ye.apply(this,arguments)}const pt="bindTo";class dt{constructor(e){this.injector=e,this._loadingAttributeName="loading",this.bindingExpressionInterpreter=e.get(S),this.attrCtrlExpInterpreter=e.get(T),this.requestBindingConfigInterpreter=e.get(O),this.validationBindingInterpreter=e.get(N),this._bindingContext=e.get(K,null),this._macrosHandlerService=e.get(f.MacrosHandlerService),this._isDesignTime=e.get(f.IS_DESIGN_TIME,!1)}_useMacros(e,t){if(!this._bindingContext)return t(e);let n;const i=new d.Subject,o=this._bindingContext.viewModel$.pipe((0,p.switchMap)(c=>this._macrosHandlerService.handleResourceMacros(e,c)),(0,p.map)((c,a)=>{n?.unsubscribe(),n=t(c),a===0&&n.ready.then(()=>{i.next(),i.complete()})}),(0,p.finalize)(()=>n?.unsubscribe())).subscribe();return new b(o,(0,d.lastValueFrom)(i,{defaultValue:null}))}_bindLoadingProperty(e,t){if(Object.keys(e).some(a=>a===this._loadingAttributeName))return new b;const i=(0,y.chain)(e).entries().filter(([a,l])=>this.isInputBinding(a,l,t,e)&&(0,v.isBindingExpression)(l)).value();if(!i.length)return new b;const o=i.map(([a,l])=>Ue(l)),c=de(this._bindingContext).viewModel$.pipe((0,p.switchMap)(a=>{if(!a)return(0,d.of)();let l=[];const u=a.events$.pipe((0,p.filter)(_=>_.type===I.ViewModelEventType.StartLoadModelAttributes),(0,p.filter)(_=>{const E=Object.keys(_.payload);return o.some(x=>E.includes(x))}),(0,p.tap)(_=>{l=Object.keys(_.payload)}),(0,p.tap)(()=>t.setPropertyValue("loading",!0))),h=a.events$.pipe((0,p.filter)(_=>_.type===I.ViewModelEventType.FinishLoadModelAttributes),(0,p.filter)(_=>{const E=Object.keys(_.payload);return l.every(x=>E.includes(x))}),(0,p.tap)(()=>t.setPropertyValue("loading",!1)),(0,p.tap)(()=>l=[]));return(0,d.merge)(u,h)})).subscribe();return new b(c)}_isControlProperty(e,t){const n=g.ViewElementRegistry.getFormControlRelatesAttribute(t.type);return e===n}_getViewElementInputProperties(e){const t=g.ViewElementRegistry.viewElements.get(e.type);return t?[...Object.keys(t.inputs??{}).filter(n=>t.inputs[n].propertyBindable)]:["visible"]}_getViewElementEntries(e,t){const n=g.ViewElementRegistry.getFormControlRelatesAttribute(t.type),i=e.find(([c])=>c===pt);let o=e.filter(([c])=>c!==pt);if(i){const[,c]=i;if(!c)return o;this._getViewElementInputProperties(t).forEach(l=>{if(l!==n){let u=c;u=`${u}:${l}`;const h=t[l];h!=null&&(u+=`=${h}`),o=o.filter(([_])=>_!==l),o.push([l,u])}})}return o}_bindInputWithValidation(e,t,n){const i=this.validationBindingInterpreter.evaluate(t,this._bindingContext).pipe((0,p.startWith)(null),(0,d.pairwise)()),o=He(e),c=([a,l])=>{a?.value!==l?.value&&n.setPropertyValue(e,l.value),n.setPropertyValue(o,l?.validationInfo)};return b.subscribe(i,c)}_bindFocusout(e,t){const n=t.getEvent("focusout"),i=e.slice(1),o=()=>Je(i,this._bindingContext);return b.subscribe(n,o)}_bindInputs(e,t){const[n,i]=(0,y.chain)(e).entries().filter(([l,u])=>this.isInputBinding(l,u,t,e)&&!this.isTwoWayBinding(l,u,t,e)).partition(([,l])=>(0,v.isBindingExpression)(l)).value();i.forEach(([l,u])=>{u=this._isControlProperty(l,e)?new F.FormControl(u):u,t.setPropertyValue(l,u)});const c=this._getViewElementEntries(n,e).map(([l,u])=>{const E=(this._isControlProperty(l,e)?this.attrCtrlExpInterpreter:this.bindingExpressionInterpreter).evaluate(u,this._bindingContext);if(Be(e.type,l)&&(0,v.isSimpleBindingExpression)(u))return this._bindInputWithValidation(l,u,t);{const x=ue=>t.setPropertyValue(l,ue);return b.subscribe(E,x,!1)}}),a=this._bindLoadingProperty(e,t);return b.all([...c,a])}_createRequest(e,t){const n={...this._bindingContext,initialEvent:t};return this.requestBindingConfigInterpreter.evaluate(e,n).pipe((0,p.map)(i=>({...i,$initialEvent:t})))}_bindOutputs(e,t){const i=Object.entries(e).filter(([o,c])=>this.isOutputBinding(o,c,t,e)).map(([o,c])=>{const a=t.getEvent(o).pipe((0,p.switchMap)(u=>this._createRequest(c,u))),l=u=>u.$context.executeRequest(u);return b.subscribe(a,l)});return b.all(i)}_bindTwoWays(e,t){const n=Object.entries(e).filter(([o,c])=>this.isTwoWayBinding(o,c,t,e)),i=[];return n.forEach(([o,c])=>{const a=this.bindingExpressionInterpreter.evaluate(c,this._bindingContext),l=st=>t.setPropertyValue(o,st);Be(e.type,o)&&(0,v.isSimpleBindingExpression)(c)?i.push(this._bindInputWithValidation(o,c,t)):i.push(b.subscribe(a,l));const u=c.slice(1),h=ge(o),_=this.getViewEventsStream(t,h),E=st=>ze(u,st,this._bindingContext),x=b.subscribe(_,E);i.push(x);const ue=this._bindFocusout(c,t);i.push(ue)}),b.all(i)}isInputBinding(e,t,n,i){return he(i.type,e)}isOutputBinding(e,t,n,i){return fe(i.type,e)}isTwoWayBinding(e,t,n,i){const o=ge(e);return(0,v.isSimpleBindingExpression)(t)&&he(i.type,e)&&fe(i.type,o)&&!(o in i)}bind(e,t){const n=i=>b.all([this._bindInputs(i,e),this._bindOutputs(i,e),this._bindTwoWays(i,e)]);return this._isDesignTime?this._useMacros(t,n):n(t)}}class ht extends dt{isInputBinding(e,t,n,i){return super.isInputBinding(e,t,n,i)||!this.isOutputBinding(e,t,n,i)}isOutputBinding(e,t,n,i){return super.isOutputBinding(e,t,n,i)||n.getPropertyValue(e)instanceof s.EventEmitter}getViewEventsStream(e,t){return e.getEvent(t)}}class Dt extends dt{getViewEventsStream(e,t){return e.getEvent(t).pipe((0,d.map)(n=>n.detail))}}class Xe{constructor(e,t,n,i,o){this._ngZone=t,this._changeDetectorRef=n,this.nativeElement=i,this.hostView=o,this._propertyValues=new Map,this.instance=e}setValue(e,t){(0,y.set)(this.instance,e,t),this._changeDetectorRef.detectChanges()}getPropertyValue(e){return(0,y.get)(this.instance,e)}getEvent(e){const t=this.getPropertyValue(e);return!t&&this.nativeElement?(0,d.fromEvent)(this.nativeElement,e):t}on(e,t){const i=this.getEvent(e).subscribe(t);return()=>{i.unsubscribe()}}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this._ngZone.run(()=>this.setValue(e,t)))}}class ft{constructor(e){this._propertyValues=new Map,this.instance=e}getPropertyValue(e){return this.instance[e]}getEvent(e){return(0,d.fromEvent)(this.instance,e)}on(e,t){return this.instance.addEventListener(e,t),()=>this.instance.removeEventListener(e,t)}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this.instance[e]=t)}}class jt{constructor(e,t){this._ngZone=t,this._propertyValues=new Map,this.instance=e}setValue(e,t){(0,y.set)(this.instance,e,t)}getPropertyValue(e){return(0,y.get)(this.instance,e)}getEvent(e){return this.getPropertyValue(e)}on(e,t){const i=this.getPropertyValue(e).subscribe(t);return()=>{i.unsubscribe()}}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this._ngZone.run(()=>this.setValue(e,t)))}}var Ot=C(57186);class Qe{constructor(e){this.injector=e}}class me{canResolve(e){return g.ViewElementRegistry.viewElements.has(e)||g.DesignTimeViewElementRegistry.infos.has(e)}getViewElementType(e){const t=e.type,n=g.DesignTimeViewElementRegistry.getByOverriddenType(t);if(n&&!e?.sealed)return n.typeRef;const i=g.ViewElementRegistry.viewElements.get(t);return i&&"typeRef"in i?i.typeRef:g.DesignTimeViewElementRegistry.infos.has(t)?g.DesignTimeViewElementRegistry.infos.get(t).typeRef:null}getSelector(e){if(g.DesignTimeViewElementRegistry.getByOverriddenType(e))return null;const t=g.ViewElementRegistry.viewElements.get(e);return t&&"selector"in t?t.selector:null}}me.\u0275fac=function(e){return new(e||me)},me.\u0275prov=s.\u0275\u0275defineInjectable({token:me,factory:me.\u0275fac});class V{canResolve(e){return g.ViewElementRegistry.viewElements.has(e)}getViewElementType(e){const t=g.ViewElementRegistry.viewElements.get(e.type);return t&&"typeRef"in t?t.typeRef:null}getSelector(e){const t=g.ViewElementRegistry.viewElements.get(e);return t&&"selector"in t?t.selector:null}}V.\u0275fac=function(e){return new(e||V)},V.\u0275prov=s.\u0275\u0275defineInjectable({token:V,factory:V.\u0275fac});class ye{_setDefaultToolbarConfigValues(e){const t=e.toolbarConfig;if(!t)return;(t instanceof Array?t:[t]).forEach(i=>{i.groupType||(i.groupType=e.viewElementGroupType),i.caption||(i.caption=e.typeCaption)})}getDesignViewElementConfigs(){const e=new Map;return g.InterfaceDesignerItemRegistry.interfaceDesignerItemRegistrationInfos.forEach((t,n)=>{const i=t.toolbarConfig;i&&(this._setDefaultToolbarConfigValues(t),e.set(n,i))}),e}}ye.\u0275fac=function(e){return new(e||ye)},ye.\u0275prov=s.\u0275\u0275defineInjectable({token:ye,factory:ye.\u0275fac});class et extends Qe{createComponent(e){const t=this.injector.get(V),n=this.injector.get(s.ViewContainerRef),i=this.injector.get(z),o=this.injector.get(s.Renderer2),c=t.getViewElementType(i),a=n.createComponent(c,{index:0,injector:this.injector});e?.forEach(({name:_,value:E})=>{o.setAttribute(a.location.nativeElement,_,E)});const l=a.injector.get(s.ChangeDetectorRef),u=a.injector.get(s.ElementRef).nativeElement;a.changeDetectorRef.detectChanges();const h=this.injector.get(s.NgZone);return new Xe(a.instance,h,l,u,a.hostView)}}class gt extends Qe{createComponent(e){const t=this.injector.get(V),n=this.injector.get(s.Renderer2),i=this.injector.get(s.ViewContainerRef),o=this.injector.get(z),c=t.getSelector(o.type),a=document.createElement(c);return e?.forEach(({name:l,value:u})=>{n.setAttribute(a,l,u)}),n.appendChild(i.element.nativeElement.parentElement,a),this._initDirectionality(a),new ft(a)}_initDirectionality(e){this.injector.get(pe.Directionality)?.value==="rtl"&&e.setAttribute("dir","rtl")}}class Nt{}class mt extends Nt{constructor(e){super(),this.injector=e,this.viewElementConfig=this.injector.get(z),this.featureValues=this.injector.get(f.FEATURE_VALUES,{optional:!0}),this.measurePerformanceService=this.injector.get(f.MeasurePerformanceService),this._componentCreator=this.injector.get(Ke)}_getElementName(){return`${this.viewElementConfig.type.split(".")?.[1]} ${this.viewElementConfig.name}`}_getDOMAttributes(){const e=[];return this.featureValues?.UseViewElementDataItemMarker&&e.push({name:"data-item-marker",value:this.viewElementConfig.dataItemMarker||this.viewElementConfig.name}),e}createComponent(e){return this._componentCreator.createComponent(e)}getComponentRef(){const e=this._getElementName(),t=this._getDOMAttributes();return this.measurePerformanceService.measure(e,()=>this.createComponent(t))}show(){const e=this.getComponentRef();return(0,d.of)(e)}}class $t extends mt{constructor(e,t,n){super(e),this.injector=e,this._creator=t,this._destroyed=n,this._renderer=this.injector.get(s.Renderer2),this._container=this.injector.get(s.ViewContainerRef),this._initMinHeight(),this._subscribeDestroyed()}get _parentElement(){return this._container.element.nativeElement.parentElement}_handleIntersection(e,t){if(!!this._parentElement){if(e&&!this._componentRef?.hostView){this._initResizeObservable(),t.next(this.getComponentRef()),t.complete();return}this._componentRef?.hostView&&(e?this._showElement():this._hideElement())}}_initIntersectionObserver(e){let t=this.viewElementConfig.selected;this._intersectionObserver=new IntersectionObserver(n=>{n.forEach(i=>{t?t=!1:this._handleIntersection(i.isIntersecting,e)})}),this._intersectionObserver.observe(this._parentElement),t&&this._handleIntersection(!0,e)}_initResizeObservable(){this._resizeObserver||(this._resizeObserver=new ResizeObserver(e=>{const{height:t,width:n}=e[0].contentRect;this._minHeight=`${t}px`,this._minWidth=`${n}px`}),this._resizeObserver.observe(this._parentElement))}_showElement(){this._display?this._renderer.setStyle(this._componentRef.nativeElement,"display",this._display):this._renderer.removeStyle(this._componentRef.nativeElement,"display"),this._removeMinSize()}_hideElement(){this._applyMinSize(),this._display=this._componentRef.nativeElement?.style.display,this._renderer.setStyle(this._componentRef.nativeElement,"display","none")}_removeMinSize(){this._renderer.removeStyle(this._parentElement,"min-height"),this._minWidth&&this._renderer.removeStyle(this._parentElement,"min-width")}_applyMinSize(){this._renderer.setStyle(this._parentElement,"min-height",this._minHeight),this._minWidth&&this._renderer.setStyle(this._parentElement,"min-width",this._minWidth)}_initMinHeight(){const e=g.ViewElementRegistry.viewElements.get(this.viewElementConfig.type);e?this._minHeight=e.defaultSize.height:console.warn(`View element with type "${this.viewElementConfig.type}" not found`)}_subscribeDestroyed(){this._destroyed?.subscribe(()=>{const e=this._componentRef?.hostView;e&&!e.destroyed&&e.destroy()})}createComponent(e){return this._componentRef=this._creator.createComponent(e),this._removeMinSize(),this._componentRef}show(){return this._applyMinSize(),new d.Observable(e=>{this._initIntersectionObserver(e)})}}const yt=new s.InjectionToken("COMPONENT_PROPERTIES_BINDER"),_t=new s.InjectionToken("DIRECTIVE_PROPERTIES_BINDER"),vt=new s.InjectionToken("VIEW_ELEMENT_VISIBILITY_STRATEGY"),tt=new s.InjectionToken("VIEW_ELEMENT_VISIBILITY_STRATEGY_VALUE"),Ft=function(r){const e=r.get(z);return r.get(V).getSelector(e.type)},nt=function(r){return!!Ft(r)},kt=function(r){return r.get(f.FEATURE_VALUES,{optional:!0})},Lt=function(r){return r.get(f.IS_DESIGN_TIME,!1)},Ut=function(r){return nt(r)?new Dt(r):new ht(r)},Gt=function(r){return nt(r)?new gt(r):new et(r)},Wt=function(r,e){const t=r.get(tt)||g.ViewElementVisibilityStrategy.Default,i={[g.ViewElementVisibilityStrategy.Default]:Ct,[g.ViewElementVisibilityStrategy.OnDemand]:Kt}[t];if(!i)throw new Error(`Unsupported visibility strategy type: ${t}`);return i(r,e)},Ct=function(r){return new mt(r)},Ht=function(r){let t=kt(r).UseLazyComponentCreationInDesignTime;return t&&r.get(Ot.ActivatedRoute,null)?.snapshot.queryParams?.UseLazyComponentCreationInDesignTime==="false"&&(t=!1),t},Zt=function(r){const e=r.get(z);return g.ViewElementRegistry.viewElements.get(e.type)?.viewElementVisibilityStrategy===g.ViewElementVisibilityStrategy.Default},Kt=function(r,e){const t=Zt(r),n=Ht(r),i=nt(r),o=!Lt(r);return t||i||o||!n?Ct(r):new $t(r,new et(r),e)};class B{constructor(e,t,n,i,o,c){this._resolver=e,this.parentDirective=t,this.injector=n,this._container=i,this._isDesignTime=o,this._ngZone=c,this._ownProperties=[{property:"visible",defaultValue:!0,omitForViewModelBinding:!0},{property:"bindTo",defaultValue:null,omitForViewModelBinding:!1}],this._destroyed$=new d.Subject,this._showElementSubscription=new d.Subscription,this._isCreating=!1,this.nested=[],this.total=0,this.viewElementShow=new s.EventEmitter,this._visible=!1,this._featureValues=(0,s.inject)(f.FEATURE_VALUES,{optional:!0}),this._measurePerformanceService=(0,s.inject)(f.MeasurePerformanceService),this._directiveRef=new jt(this,this._ngZone)}get visible(){return this._visible}set visible(e){this._visible=e,this._setViewElementVisibility(e||this._isDesignTime)}_bindSelfToViewModel(){const e=this._ownProperties.reduce((t,{property:n,defaultValue:i})=>({...t,[n]:this.viewElementConfig[n]??i}),{});this._ngZone.runOutsideAngular(()=>this.bindDirectiveProperties(e))}_bindComponentToViewModel(){const e=(0,y.omit)(this.viewElementConfig,...this._ownProperties.filter(({omitForViewModelBinding:t})=>t===!0).map(({property:t})=>t));this._ngZone.runOutsideAngular(()=>this.bindComponentProperties(e))}_setViewElementVisibility(e){e&&!this.componentRef?this._showViewElement():!e&&this.componentRef&&this._hideViewElement()}_showViewElement(){const e=this.viewElementConfig.type;if(this._typeName=e,!!this._typeName)if(this._resolver.canResolve(e))this._showComponent();else{if(this.injector.get(ut,!1))return;const n=this._container.createComponent(M);n.instance.caption=e;const i=n.injector.get(s.ElementRef).nativeElement;console.warn(`View element with type "${e}" not found`),this.componentRef=new Xe(n.instance,this._ngZone,n.changeDetectorRef,i,n.hostView)}}_showComponent(){if(this._isCreating)return;this._isCreating=!0;const e=this.injector.get(vt);this._showElementSubscription.add(e.show().pipe((0,p.filter)(t=>!!t),(0,p.takeUntil)(this._destroyed$)).subscribe(t=>{this.componentRef=t,this._measurePerformanceService.measure(`binding ${this.viewElementConfig.name}`,()=>this._bindComponentToViewModel()),this.viewElementShow.emit(this),this._isCreating=!1,this._featureValues?.UseMeasurePerformanceTools&&this._measurePerformanceService.rendering$.next()}))}_hideViewElement(){this._componentBinding?.unsubscribe(),this._showElementSubscription.unsubscribe(),this._container.clear(),this.componentRef=null}bindDirectiveProperties(e){this._directiveBinding?.unsubscribe(),this._directiveBinding=this._directivePropertiesBinder.bind(this._directiveRef,e)}bindComponentProperties(e){this._componentBinding?.unsubscribe(),this.componentRef&&(this._componentBinding=this._componentPropertiesBinder.bind(this.componentRef,e))}updateViewElementConfig(e){this.viewElementConfig=e,this._bindSelfToViewModel(),this._bindComponentToViewModel()}ngOnInit(){this._directivePropertiesBinder=this.injector.get(_t),this._componentPropertiesBinder=this.injector.get(yt),this.parentDirective&&this.parentDirective.attachNested(this),this._bindSelfToViewModel()}attachNested(e){this.nested.push(e)}detachNested(e){this.nested.splice(this.nested.indexOf(e),1)}ngOnDestroy(){this.parentDirective&&this.parentDirective.detachNested(this),this._componentBinding?.unsubscribe(),this._directiveBinding?.unsubscribe(),this._destroyed$.next(),this._destroyed$.complete()}}B.\u0275fac=function(e){return new(e||B)(s.\u0275\u0275directiveInject(V),s.\u0275\u0275directiveInject(B,12),s.\u0275\u0275directiveInject(s.Injector),s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(f.IS_DESIGN_TIME,8),s.\u0275\u0275directiveInject(s.NgZone))},B.\u0275dir=s.\u0275\u0275defineDirective({type:B,selectors:[["","crtViewElement",""]],inputs:{viewElementConfig:["crtViewElement","viewElementConfig"],visibilityStrategy:"visibilityStrategy",visible:"visible"},outputs:{viewElementShow:"viewElementShow"},features:[s.\u0275\u0275ProvidersFeature([{provide:z,useFactory:r=>r.viewElementConfig,deps:[(0,s.forwardRef)(()=>B)],multi:!1},{provide:yt,useFactory:Ut,deps:[s.Injector],multi:!1},{provide:_t,useFactory:r=>new ht(r),deps:[s.Injector],multi:!1},{provide:Ke,useFactory:Gt,deps:[s.Injector],multi:!1},{provide:tt,useFactory:(r,e)=>e||r.visibilityStrategy,deps:[(0,s.forwardRef)(()=>B),[new s.Inject(tt),new s.SkipSelf,new s.Optional]],multi:!1},{provide:vt,useFactory:(r,e)=>Wt(r,e._destroyed$),deps:[s.Injector,(0,s.forwardRef)(()=>B)],multi:!1},...Pe])]});const wt=r=>({viewModel$:r.viewModel$,parent:r.parent}),It=(r,e)=>{const t=new d.ReplaySubject(1);return t.next(null),(r.viewModel$??e?.viewModel$)?.subscribe(t),{viewModel$:t.asObservable(),parent:r.viewModel$?e:e?.parent,viewModelSubject:t}};class q{constructor(e){this.injector=e}set viewModel(e){(e instanceof I.BaseViewModel||e===void 0||e===null)&&(this.viewModel$?this.viewModel$.next(e):(this.viewModel$=new d.ReplaySubject(1),this.viewModel$.next(e)))}ngOnDestroy(){this.viewModel=null,this.viewModel$?.complete()}}q.\u0275fac=function(e){return new(e||q)(s.\u0275\u0275directiveInject(s.Injector))},q.\u0275dir=s.\u0275\u0275defineDirective({type:q,selectors:[["","crtViewModel",""]],inputs:{viewModel:["crtViewModel","viewModel"]},exportAs:["crtViewModel"],features:[s.\u0275\u0275ProvidersFeature([{provide:K,useFactory:wt,deps:[[new s.Inject(Ze),new s.Self]],multi:!1},{provide:Ze,useFactory:It,deps:[(0,s.forwardRef)(()=>q),[new s.Inject(K),new s.SkipSelf,new s.Optional]],multi:!1}])]});const zt=[{name:"Root",type:"crt.GridContainer",rows:["min-content","auto"],columns:["200px","auto"],gap:{columnGap:5,rowGap:5},classes:["page"],styles:{background:"lightcoral",minHeight:"700px",alignItems:"stretch"},items:[{name:"Header",type:"crt.FlexContainer",classes:["container","header","fixed-top"],alignItems:"center",styles:{padding:"5px",background:"#e0ebeb",border:"1px solid #94b8b8",position:"sticky",top:"0px",height:"100%"},items:[{name:"SaveButton",type:"crt.Button",caption:"save",dataItemMarker:"save-button"},{name:"CancelButton",type:"crt.Button",caption:"cancel"},{name:"UserButton",type:"crt.Button",caption:"user"},{name:"NotRegisterComponent",type:"crt.NotRegisterComponent"}],layoutConfig:{column:1,colSpan:-1}},{name:"LeftPane",type:"crt.FlexContainer",classes:["container","left"],styles:{height:"100%",background:"lightblue",padding:"5px",border:"1px solid #94b8b8"},direction:"column",items:[{name:"LeftPaneElement",type:"crt.List",parent:"LeftPane",classes:["el"],id:"list1",styles:{border:"1px solid #94b8b8",background:"#c2d6d6",padding:"5px"},layoutConfig:{grow:1}},{name:"input1",type:"crt.DeprecatedInput",parent:"LeftPane",classes:["el"],id:"input1",styles:{},caption:"Full name",value:"Andrew Baker (sample)",layoutConfig:{grow:1}}]},{name:"RightPane",type:"crt.GridContainer",classes:["container","right"],columns:["1fr","1fr"],styles:{height:"100%"},gap:5,items:[{name:"ImageInput2",type:"crt.ImageInput",classes:["el"],id:"imageInput2",caption:"imageInput2"},{name:"Toolbar1",type:"crt.FlexContainer",id:"toolbar1",gap:"5px",direction:"row",justifyContent:"flex-end",alignItems:"center",styles:{height:"100%"},items:[{name:"RunProcessButton",type:"crt.Button",caption:"run process"},{name:"ExecRequestButton",type:"crt.Button",caption:"exec request"}],layoutConfig:{column:1,colSpan:-1}}]}]}],qt=[{name:"Root",type:"crt.GridContainer",rows:["min-content","auto"],columns:["200px","auto"],gap:{columnGap:5,rowGap:5},classes:["page"],styles:{direction:"rtl"},items:[{name:"Header",type:"crt.FlexContainer",classes:["container","header"],styles:{padding:"5px",background:"#e0ebeb",border:"1px solid #94b8b8"},items:[{name:"SaveButton",type:"crt.Button",caption:"save"},{name:"CancelButton",type:"crt.Button",caption:"cancel"},{name:"UserButton",type:"crt.Button",caption:"user"}],layoutConfig:{colSpan:2}},{name:"LeftPane",type:"crt.FlexContainer",classes:["container","left"],styles:{height:"100%"},items:[{name:"LeftPaneElement",type:"crt.List",parent:"LeftPane",classes:["el"],id:"list1",styles:{border:"1px solid #94b8b8",background:"#c2d6d6",padding:"5px"},layoutConfig:{grow:1}}],layoutConfig:{colSpan:1}},{name:"RightPane",type:"crt.GridContainer",classes:["container","right"],rows:"min-content",columns:["1fr","1fr"],gap:2,items:[{name:"Toolbar1",type:"crt.FlexContainer",id:"toolbar1",gap:"5px",direction:"row",justifyContent:"flex-end",items:[{name:"RunProcessButton",type:"crt.Button",caption:"run process"},{name:"ExecRequestButton",type:"crt.Button",caption:"exec request"}],layoutConfig:{colSpan:2}}],layoutConfig:{colSpan:1}},{name:"Footer",type:"crt.FlexContainer",classes:["container","footer"],items:[{name:"FeedbackButton",type:"crt.Button",caption:"feedback"}],layoutConfig:{column:1,colSpan:2,row:3}}]}];class _e{constructor(){this._viewModel$=new d.BehaviorSubject(null),this.viewModel$=this._viewModel$.asObservable()}set viewModel(e){this._viewModel$.next(e)}get viewModel(){return this._viewModel$.getValue()}}_e.\u0275fac=function(e){return new(e||_e)},_e.\u0275prov=s.\u0275\u0275defineInjectable({token:_e,factory:_e.\u0275fac});const Jt=r=>{switch(r){case g.DesignerToolGroupType.Data:case g.DesignerToolGroupType.Inputs:return{styles:{caption:{height:20},icon:{width:72,height:40},tile:{width:72,height:40+20}}};default:return{styles:{caption:{height:20},icon:{width:72,height:64},tile:{width:72,height:64+20}}}}};class A{}A.\u0275fac=function(e){return new(e||A)},A.\u0275mod=s.\u0275\u0275defineNgModule({type:A}),A.\u0275inj=s.\u0275\u0275defineInjector({providers:[V,...Pe],imports:[R.CommonModule,f.MacrosModule,m,m]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(A,{declarations:[q,B],imports:[R.CommonModule,f.MacrosModule,m],exports:[q,B,m]})}();function Yt(r,e,t){const n=[];return e===void 0||f.MetadataSchemaUtils.getViewConfigInfoByFilter(i=>{const o=Object.values(i).filter(c=>{const a=c;return a?.request===e&&(t?t(a):!0)});return n.push(...o),!1},r),n}var Oe;(function(r){r.HIDE="hide",r.DESTROY="destroy"})(Oe||(Oe={}));const it="crt-hide-visible",xe="_instanceId",Ne="_instanceCache";class ve{constructor(e,t,n){this._view=e,this._template=t,this._featureValues=n,this._context={$implicit:null},this.visibilityStrategyMode=Oe.DESTROY}_changeVisibilityByDestroyStrategy(){this.crtIf?this._ref||(this._ref=this._view.createEmbeddedView(this._template,this._context)):(this._view.clear(),this._ref=null)}_canUseHideStrategy(){return this.visibilityStrategyMode===Oe.HIDE&&this._featureValues.UseHideVisibilityStrategy}_changeVisibilityByHideStrategy(){if(this.crtIf){if(this._ref){this._getRootNode().classList.remove(it);return}this._ref=this._view.createEmbeddedView(this._template,this._context);return}this._ref&&this._getRootNode().classList.add(it)}_getRootNode(){return this._ref.rootNodes[0]}ngOnChanges(e){this._context.$implicit=this.crtIf,this._canUseHideStrategy()?this._changeVisibilityByHideStrategy():this._changeVisibilityByDestroyStrategy()}ngOnDestroy(){this._ref?.destroy()}}ve.\u0275fac=function(e){return new(e||ve)(s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(s.TemplateRef),s.\u0275\u0275directiveInject(f.FEATURE_VALUES))},ve.\u0275dir=s.\u0275\u0275defineDirective({type:ve,selectors:[["","crtIf",""]],inputs:{crtIf:"crtIf",visibilityStrategyMode:["crtIfVisibilityStrategyMode","visibilityStrategyMode"]},features:[s.\u0275\u0275NgOnChangesFeature]});class ne{constructor(e){this._injector=e,this._requestBindingConfigInterpreter=this._injector.get(O),this._crtNavigationLock=this._injector.get(f.CRT_NAVIGATION_LOCK_TOKEN)}_sendRequest(e,t){return this._requestBindingConfigInterpreter.evaluate(e,{...this._bindingContext,initialEvent:t}).pipe((0,p.map)(n=>({...n,$initialEvent:t})),(0,d.switchMap)(n=>n.$context?.executeRequest(n)??(0,d.of)(null)))}_sendRequests(e,t){var n=this;return this._crtNavigationLock.wait((0,U.Z)(function*(){const i=(0,d.from)(t).pipe((0,d.concatMap)(o=>n._sendRequest(o,e)));yield(0,d.lastValueFrom)(i)}))}processOutputEvent(e,t){if(this._bindingContext=this._injector.get(K),e.action==="processRequest")this._sendRequests(t,e.requests);else if(e.action==="changeAttributeValue"){const i=t instanceof CustomEvent?t.detail:t;ze(e.attributePath,i,this._bindingContext)}else e.action==="markControlAsTouched"&&Je(e.attributePath,this._bindingContext)}}ne.\u0275fac=function(e){return new(e||ne)(s.\u0275\u0275directiveInject(s.Injector))},ne.\u0275dir=s.\u0275\u0275defineDirective({type:ne,selectors:[["","crtOutputBinding",""]],exportAs:["crtOutputBinding"],features:[s.\u0275\u0275ProvidersFeature([O])]});class ie{}ie.\u0275fac=function(e){return new(e||ie)},ie.\u0275dir=s.\u0275\u0275defineDirective({type:ie,selectors:[["","crtViewElementConfig",""]],inputs:{crtViewElementConfig:"crtViewElementConfig"},features:[s.\u0275\u0275ProvidersFeature([{provide:z,useFactory:r=>(0,y.cloneDeep)(r.crtViewElementConfig),deps:[[ie,new s.Self]]}])]});class Ce{constructor(e){this.parent=e,this.inputs={},this.outputs={},this.directives=[],this.attributes={},this.content=[]}}class we{}we.\u0275fac=function(e){return new(e||we)},we.\u0275cmp=s.\u0275\u0275defineComponent({type:we,selectors:[["crt-view-element-container"]],inputs:{viewElementConfig:"viewElementConfig"},decls:1,vars:1,consts:[[3,"crtViewElement"]],template:function(e,t){e&1&&s.\u0275\u0275elementContainer(0,0),e&2&&s.\u0275\u0275property("crtViewElement",t.viewElementConfig)},dependencies:[B],encapsulation:2});class Ie{constructor(e,t){this._containerRef=e,this._template=t,this._subscription=new d.Subscription,this._crtAttachIf$=new d.Subject,this._bindingActivator=(0,s.inject)(v.PRESERVED_CONTENT_BINDING_ACTIVATOR,{optional:!0})??new v.BindingActivator,this._subscription=(0,d.combineLatest)([this._bindingActivator.active$,this._crtAttachIf$]).subscribe(([n,i])=>this._changeVisibilityByAttachDetachStrategy(n,i))}_changeVisibilityByAttachDetachStrategy(e,t){if(t){if(e){if(!this._viewRef){this._viewRef=this._containerRef.createEmbeddedView(this._template);return}this._containerRef.insert(this._viewRef)}}else{const n=this._containerRef.indexOf(this._viewRef);n>=0&&this._containerRef.detach(n)}}ngOnChanges(e){this._crtAttachIf$.next(this.crtAttachIf)}ngOnDestroy(){this._subscription.unsubscribe(),this._viewRef?.destroy()}}Ie.\u0275fac=function(e){return new(e||Ie)(s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(s.TemplateRef))},Ie.\u0275dir=s.\u0275\u0275defineDirective({type:Ie,selectors:[["","crtAttachIf",""]],inputs:{crtAttachIf:"crtAttachIf"},features:[s.\u0275\u0275NgOnChangesFeature]});class re extends R.NgForOf{}re.\u0275fac=function(){let r;return function(t){return(r||(r=s.\u0275\u0275getInheritedFactory(re)))(t||re)}}(),re.\u0275dir=s.\u0275\u0275defineDirective({type:re,selectors:[["","crtNgFor",""]],features:[s.\u0275\u0275InheritDefinitionFeature]});class se{constructor(e,t){this.changeDetectorRef=e,this.containerRef=t,this.init=new s.EventEmitter}ngOnInit(){this.init.emit(this)}}se.\u0275fac=function(e){return new(e||se)(s.\u0275\u0275directiveInject(s.ChangeDetectorRef),s.\u0275\u0275directiveInject(s.ViewContainerRef))},se.\u0275dir=s.\u0275\u0275defineDirective({type:se,selectors:[["","crtViewInit",""]],outputs:{init:"init"}});class J extends R.AsyncPipe{}J.\u0275fac=function(){let r;return function(t){return(r||(r=s.\u0275\u0275getInheritedFactory(J)))(t||J)}}(),J.\u0275pipe=s.\u0275\u0275definePipe({name:"crtAsync",type:J,pure:!1});const $e=new s.InjectionToken("CRT_JIT_MODULES"),bt=new s.InjectionToken("CRT_SCHEMA_BINDING_CACHE");class oe{constructor(e,t,n,i,o){this._injector=e,this._changeDetector=t,this._bindingExpressionInterpreter=n,this._attributeFormControlExpressionInterpreter=i,this._ngZone=o,this._cache=this._injector.get(bt,null),this._bindingActivator=this._injector.get(v.BINDING_ACTIVATOR,null),this._preservedContentBindingActivator=this._injector.get(v.PRESERVED_CONTENT_BINDING_ACTIVATOR,null),this._subscribeToActivator()}_subscribeToActivator(){!this._bindingActivator||(this._bindingActivatorSubscription=(0,d.combineLatest)([this._bindingActivator.active$,this._preservedContentBindingActivator?.active$??(0,d.of)(!0)]).pipe((0,p.map)(([e,t])=>e&&t),(0,p.distinctUntilChanged)(),(0,d.tap)(e=>{e&&this._stream$&&!this._subscription&&(this._subscription=this._stream$.subscribe()),e||(this._subscription?.unsubscribe(),this._subscription=null)})).subscribe())}_isControlProperty(e,t){const n=g.ViewElementRegistry.getFormControlRelatesAttribute(t.type);return e===n}_getInterpreter(e){return e?this._attributeFormControlExpressionInterpreter:this._bindingExpressionInterpreter}_restoreValueFromCache(e,t,n){if(!!this._cache&&t.name){const i=this._cache.get(e)?.get(t.name)?.get(n);typeof i<"u"&&(this._result=i)}}_canApplyValueFromCache(e,t,n){return!!(t.name&&this._cache&&typeof this._cache.get(e)?.get(t.name)?.get(n)<"u")}_saveToCache(e,t,n){if(!(!this._cache||!this._viewModelRef?.deref())&&e.name){const i=this._cache.get(this._viewModelRef.deref())||new Map,o=i.get(e.name)||new Map;this._cache.set(this._viewModelRef.deref(),i),i.set(e.name,o),o.set(t,n)}}transform(e,t,n){if(e!==this._oldValue){this._subscription?.unsubscribe(),this._oldValue=e,this._result=null,this._stream$=null;const i=this._isControlProperty(t,n);if(!(0,v.isBindingExpression)(e))this._result=i?new F.FormControl(e):e;else{this._bindingContext=this._injector.get(K);const o=this._bindingContext.viewModel$.pipe((0,d.tap)(l=>{const u=this._canApplyValueFromCache(l,n,t),h=(this._viewModelRef?.deref()||null)!==l;!u&&h&&this._result instanceof I.BaseViewModelCollection&&(this._result=null),this._viewModelRef=l?new WeakRef(l):null,this._restoreValueFromCache(l,n,t)})),a=this._getInterpreter(i).evaluate(e,this._bindingContext).pipe((0,Te.runInZone)(this._ngZone),(0,d.tap)(l=>{this._result!==l&&(this._result=l,this._saveToCache(n,t,l),this._changeDetector.markForCheck())}));this._stream$=(0,d.merge)(o,a),this._subscription=this._stream$.subscribe()}}return this._result}ngOnDestroy(){this._subscription?.unsubscribe(),this._bindingActivatorSubscription?.unsubscribe()}}oe.\u0275fac=function(e){return new(e||oe)(s.\u0275\u0275directiveInject(s.Injector,16),s.\u0275\u0275directiveInject(s.ChangeDetectorRef,16),s.\u0275\u0275directiveInject(S,16),s.\u0275\u0275directiveInject(T,16),s.\u0275\u0275directiveInject(s.NgZone,16))},oe.\u0275pipe=s.\u0275\u0275definePipe({name:"crtBinding",type:oe,pure:!1});class Xt extends Error{constructor(e,t){super(`Validation error. Cannot create ${e} with name ${t}. Incorrect format`)}}const Qt=/^([#a-zA-Z_]+)([\w_.-]+)/gm;function Fe(r,e){const t=e.match(Qt);if(!(t?.length&&t[0]===e))throw new Xt(r,e)}class Y{}Y.\u0275fac=function(e){return new(e||Y)},Y.\u0275mod=s.\u0275\u0275defineNgModule({type:Y}),Y.\u0275inj=s.\u0275\u0275defineInjector({imports:[R.CommonModule,A,R.CommonModule,A]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(Y,{declarations:[J,oe,ne,ve,ie,we,se,re,Ie],imports:[R.CommonModule,A],exports:[R.CommonModule,A,ve,oe,ne,ie,J,we,se,re,Ie]})}();class X{constructor(e,t,n){this._injector=t,this._ngZone=n,this._featureValues=this._injector.get(f.FEATURE_VALUES),this._modules=X._flatModulesArrays(e)}static _flatModulesArrays(e){const t=e.flat(),n=t.filter((i,o)=>t.indexOf(i)!==o);if(n.length>0){const i=n.map(o=>o.name).join(", ");throw new Error(`There are module duplicates in "${$e}" token: ${i}`)}return t}_getInputExpression(e,t,n){let i;const o=t.value;return this._featureValues.DisableDoNotUseBindingPipeForConstant?i=e?`"context['${e}']${n}"`:`"${o}${n}"`:e?i=t.pipes||typeof o=="string"?`"context['${e}']${n}"`:`'${o}'`:i=`"${o}${n}"`,i}_createInputDefinitions(e,t){const n=[];for(const[i,o]of Object.entries(e.inputs)){Fe("input",i);const c=o.propertyKey;c&&(t[c]=o.value);let a="";for(const h of o.pipes||[]){a+=` | ${h.name}`;for(const _ of h.arguments||[])t[_.propertyKey]=_.value,a+=`:context['${_.propertyKey}']`}const l=this._getInputExpression(c,o,a),u=`[${i}]=${l}`;n.push(u)}return n}_createAttributeDefinitions(e,t){const n=[];for(const[i,o]of Object.entries(e.attributes))Fe("attribute",i),o.value?n.push(`${i}="${o.value}"`):n.push(`${i}`);return n}_createOutputDefinitions(e,t){const n=[],i="ref";Object.entries(e.outputs).length>0&&n.push(`crtOutputBinding #${i}="crtOutputBinding"`);for(const[o,c]of Object.entries(e.outputs)){Fe("output",o);const a=c.propertyKey;t[a]=c.fn,n.push(`(${o})="context['${a}'](${i}, $event)"`)}return n}_createDirectiveDefinitions(e,t){const n=[],i=[];for(const o of e.directives){const c=o.useAsterisk?`*${o.selector}`:`[${o.selector}]`,a=[];for(const h of o.values){const _=h.propertyKey;let E=`context['${_}']`;for(const x of h.pipes||[]){E+=` | ${x.name}`;for(const ue of x.arguments||[])t[ue.propertyKey]=ue.value,E+=`:context['${ue.propertyKey}']`}(0,d.isObservable)(h.value)?t[_]=h.value.pipe((0,Te.runInZone)(this._ngZone)):t[_]=h.value,a.push(E)}const{variableName:l}=o;let u="";o.additionalInputs?.length>0&&(o.useAsterisk?u=this._getAdditionalStructuredDirectiveInputs(o.additionalInputs):i.push(o.additionalInputs.map(h=>`[${h.propertyKey}]='${h.value}'`).join(";"))),o.rawValue&&a.push(o.rawValue),n.push(`${c}="${a.map(h=>`(${h})`).join(" && ")}${l?";let "+l:""+u}"`)}return{directives:n,directiveInputs:i}}_getAdditionalStructuredDirectiveInputs(e){return`; ${e.map(n=>`${n.propertyKey}: '${n.value}'`).join("; ")};`}_createContentDefinitions(e,t){const n=[],i=e.content;for(const o of i){const{componentContext:c,componentTemplate:a}=this.createTemplateAndContext(o);n.push(a),Object.assign(t,c)}return n}createTemplateAndContext(e){Fe("selector",e.selector);const t={},n=this._createInputDefinitions(e,t),i=this._createAttributeDefinitions(e,t),o=this._createOutputDefinitions(e,t),{directives:c,directiveInputs:a}=this._createDirectiveDefinitions(e,t),l=this._createContentDefinitions(e,t),u=e.name||"root",h=`${c.join(" ")} ${a.join(" ")}`;return{componentTemplate:`
			<${e.selector} id="${u}" crtViewInit (init)="refs['${u}'] = $event"
				${n.join(" ")} ${h} ${o.join(" ")} ${i.join(" ")}
			>
				${l.join(" ")}
			</${e.selector}>
		`,componentContext:t}}create(e,t,n){const i=this._injector,c=i.get(I.CRT_METADATA_PREPROCESSOR).map(l=>({provide:I.CRT_METADATA_PREPROCESSOR,useValue:l,multi:!0}));return{componentType:(0,s.Component)({selector:e,template:t,host:{class:"flex-full-height"},styles:[`
				:host > .stretch {
					flex-grow: 1;
				}
				.${it} {
					display: none;
				}
			`],changeDetection:s.ChangeDetectionStrategy.OnPush,imports:[Y,...this._modules,...n??[]],standalone:!0,providers:[...c,{provide:v.BINDING_ACTIVATOR,useValue:{active$:new d.BehaviorSubject(!0)}}]})(class{constructor(){this._bindingActivator=(0,s.inject)(v.BINDING_ACTIVATOR),this.ownChangeDetectorRef=(0,s.inject)(s.ChangeDetectorRef),this.injector=i,this.refs={}}activate(){this.ownChangeDetectorRef.reattach(),this._bindingActivator.active$.next(!0)}deactivate(){this.ownChangeDetectorRef.detach(),this._bindingActivator.active$.next(!1)}updateViewElementInput(l,u,h){this.context={...this.context,[l+":"+u]:h},this.refs[l]?.changeDetectorRef?.detectChanges(),this.refs[l]?.changeDetectorRef?.markForCheck()}})}}}X.\u0275fac=function(e){return new(e||X)(s.\u0275\u0275inject($e),s.\u0275\u0275inject(s.Injector),s.\u0275\u0275inject(s.NgZone))},X.\u0275prov=s.\u0275\u0275defineInjectable({token:X,factory:X.\u0275fac,providedIn:"root"});class be{constructor(e){this._schemaChangeListenerService=e,this._componentInfoCache=new Map,this._destroyed$=new d.Subject,this._schemaChangeListenerService.schemaChanged$.pipe((0,p.takeUntil)(this._destroyed$)).subscribe(t=>{t.schemaType===f.SchemaTypes.ClientUnitSchema&&this._componentInfoCache.delete(t.name)})}get(e){return this._componentInfoCache.get(e)}set(e,t){this._componentInfoCache.set(e,t)}has(e){return this._componentInfoCache.has(e)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}}be.\u0275fac=function(e){return new(e||be)(s.\u0275\u0275inject(f.SchemaChangeListenerService))},be.\u0275prov=s.\u0275\u0275defineInjectable({token:be,factory:be.\u0275fac,providedIn:"root"});class ae{constructor(){this.viewAttached$=new d.BehaviorSubject(!0)}}ae.\u0275fac=function(e){return new(e||ae)},ae.\u0275prov=s.\u0275\u0275defineInjectable({token:ae,factory:ae.\u0275fac});class ce{constructor(){this._componentRefCache=new Map,this._viewConfigCache=new Map,this._instanceCache=new Map}invalidateInstance(e){const t=[],n=Array.from(this._componentRefCache.keys());for(const[i,o]of this._instanceCache.entries())o.delete(e),i.instance.ownChangeDetectorRef.detectChanges(),!o.size&&n.indexOf(i)<n.length-1&&t.push(i);t.forEach(i=>{this._componentRefCache.delete(i),this._viewConfigCache.delete(i),this._instanceCache.delete(i),i.destroy()})}saveView(e,t,n){const i=this._componentRefCache.get(e)||new Set;i.add(t),this._componentRefCache.set(e,i),this._viewConfigCache.set(e,n)}saveInstance(e,t){const n=this._instanceCache.get(e)||new Set;n.add(t),this._instanceCache.set(e,n)}getInstances(e){return this._instanceCache.get(e)}getView(e){for(const[t,n]of this._componentRefCache.entries())if(n.has(e))return t}getViewConfig(e){return this._viewConfigCache.get(e)}ngOnDestroy(){for(const e of this._componentRefCache.keys())e.destroy();this._componentRefCache.clear(),this._viewConfigCache.clear(),this._instanceCache.clear()}}ce.\u0275fac=function(e){return new(e||ce)},ce.\u0275prov=s.\u0275\u0275defineInjectable({token:ce,factory:ce.\u0275fac});var Et=C(18877);const Vt="bindTo",en="visible";class w{static _getViewElementInputProperties(e){const t=g.ViewElementRegistry.viewElements.get(e.type);return[...Object.keys(t.inputs??{}).filter(n=>t.inputs[n].propertyBindable),en]}static createLayoutConfigComponentParts(e,t,n){for(const[i,o]of Object.entries(t))n.attributes["layout-config-"+(0,y.kebabCase)(i)]={value:o}}static createVisibleComponentPartsWrapper(e,t,n,i){const o=(0,v.isBindingExpression)(t);let c=t;const a=[];o&&(c=t,a.push({name:"crtBinding",arguments:[{value:e,propertyKey:w.getContextPropertyName(e+"|propertyName",n)},{value:i,propertyKey:w.getContextPropertyName(e+"|viewElementConfig",n)}]}));const l=n.directives.find(u=>u.selector==="crtIf");if(l)l.values.unshift({propertyKey:this.getContextPropertyName(e,n),value:c,pipes:a});else{const u={values:[{propertyKey:this.getContextPropertyName(e,n),value:c,pipes:a}],selector:"crtIf",useAsterisk:!0};w.addCrtIfDirectiveAdditionalInputs(u,i),n.directives.push(u)}return n}static getContextPropertyName(e,t){return t.name+":"+e}static getViewElementEntries(e){const t=g.ViewElementRegistry.getFormControlRelatesAttribute(e.type),n=Object.entries(e),i=n.find(([c])=>c===Vt);let o=n.filter(([c])=>c!==Vt);if(i){const c=this._getViewElementInputProperties(e),[,a]=i;c.forEach(l=>{if(l!==t){const u=e[l];if(u==null||typeof u!="string"||typeof u=="string"&&!u.includes("|")){let h=a;h=`${h}:${l}`,u!=null&&(h+=`=${JSON.stringify(u)}`),o=o.filter(([_])=>_!==l),o.push([l,h])}}})}return o}static addCrtIfDirectiveAdditionalInputs(e,{visibilityStrategyMode:t}){if(!t)return;const n=e.additionalInputs||[];n.push({propertyKey:"visibilityStrategyMode",value:t}),e.additionalInputs=[...n]}}class Rt{constructor(e,t){this.injector=e,this.componentPartsFactory=t,this._specialPropertiesList=[{property:"type",createComponentPart:()=>{}},{property:"layoutConfig",createComponentPart:w.createLayoutConfigComponentParts.bind(this)}],this._loadingAttributeName="loading",this._visibleAttributeName="visible",this.initDependencies()}_createViewElementConfigProviderComponentParts(e,t){t.directives.push({selector:"crtViewElementConfig",values:[{value:e,pipes:[],propertyKey:w.getContextPropertyName("viewElementConfig",t)}]})}_createDataItemMarkerComponentParts(e,t){t.attributes["data-item-marker"]={value:e.dataItemMarker||e.name}}createLoadingComponentParts(e,t){Object.keys(e).some(i=>i===this._loadingAttributeName)?this._createInputComponentParts(this._loadingAttributeName,e[this._loadingAttributeName],e,t):this._createDefaultLoadingPropertyBinding(e,t)}_createDefaultLoadingPropertyBinding(e,t){const n=(0,y.chain)(e).entries().filter(([o,c])=>this.isInputBinding(o,c,e)&&(0,v.isBindingExpression)(c)).value();let i=(0,d.of)(!1);if(n.length){const o=n.map(([c,a])=>Ue(a));i=this._createLoadingPropertyValueFromContextEvent(o)}t.inputs[this._loadingAttributeName]={propertyKey:w.getContextPropertyName(this._loadingAttributeName,t),pipes:[{name:"crtAsync",arguments:[]}],value:i}}_createLoadingPropertyValueFromContextEvent(e){const t=this.injector.get(s.NgZone);return de(this._bindingContext).viewModel$.pipe((0,p.switchMap)(n=>{if(!n)return(0,d.of)(!1);let i=[];const o=n.events$.pipe((0,p.filter)(a=>a.type===I.ViewModelEventType.StartLoadModelAttributes),(0,p.map)(a=>a),(0,p.filter)(a=>{const l=Object.keys(a.payload);return e.some(u=>l.includes(u))}),(0,p.tap)(a=>{i=Object.keys(a.payload)}),(0,p.map)(()=>!0)),c=n.events$.pipe((0,p.filter)(a=>a.type===I.ViewModelEventType.FinishLoadModelAttributes),(0,p.map)(a=>a),(0,p.filter)(a=>{const l=Object.keys(a.payload);return i.every(u=>l.includes(u))}),(0,p.map)(()=>!1),(0,p.tap)(()=>i=[]));return(0,d.merge)(o,c).pipe((0,Te.runInZone)(t))}))}_createContentPropertyComponentParts(e,t,n,i,o){const c=this.getViewElementSlotDefinition(n,e);for(const a of t){const l=this.componentPartsFactory.create(this.injector,a);let u=l.create(a,i,o);c.lazy&&(u=this.createLazyContentComponentParts(u)),this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost&&!this.featureValues.DisableComponentPartsCreatorAddContentProperty?l.addContentProperty(e,u,n):this.addContentProperty(e,u,n),i.content.push(u)}c.input&&this._createInputComponentParts(e,t,n,i)}_isConstant(e){const t=typeof e;return t==="string"&&!(0,v.isBindingExpression)(e)||t==="number"||t==="boolean"||t==="bigint"}_getBindingPipeConfig(e,t,n){return[{name:"crtBinding",arguments:[{value:e,propertyKey:w.getContextPropertyName(e+"|propertyName",n)},{value:t,propertyKey:w.getContextPropertyName(e+"|viewElementConfig",n)}]}]}_createInputComponentParts(e,t,n,i){i.inputs[e]={propertyKey:w.getContextPropertyName(e,i),value:t},(this.featureValues.DisableDoNotUseBindingPipeForConstant||!this._isConstant(t))&&(i.inputs[e].pipes=this._getBindingPipeConfig(e,n,i))}_createControlInputComponentParts(e,t,n,i){const o={selector:"crtIf",variableName:"control",useAsterisk:!0,values:[{value:t,propertyKey:w.getContextPropertyName(e,i),pipes:[{name:"crtBinding",arguments:[{value:e,propertyKey:w.getContextPropertyName(e+"|propertyName",i)},{value:n,propertyKey:w.getContextPropertyName(e+"|viewElementConfig",i)}]}]}],additionalInputs:[]};w.addCrtIfDirectiveAdditionalInputs(o,n),i.directives.push(o),i.inputs[e]={value:"control"}}_createInputWithValidationComponentParts(e,t,n,i){const c=this.injector.get(N).evaluate(t,this._bindingContext).pipe((0,p.share)()),a=c.pipe((0,p.pluck)("value"),(0,p.distinctUntilChanged)());i.inputs[e]={propertyKey:w.getContextPropertyName(e,i),value:a,pipes:[{name:"crtAsync",arguments:[]}]};const l=He(e),u=c.pipe((0,p.pluck)("validationInfo"),(0,p.distinctUntilChanged)());i.inputs[l]={propertyKey:w.getContextPropertyName(l,i),value:u,pipes:[{name:"crtAsync",arguments:[]}]}}_createOutputComponentParts(e,t,n){n.outputs[e]={propertyKey:w.getContextPropertyName(e,n),fn:(i,o)=>{i.processOutputEvent(t,o)}}}_createTwoWayBindingComponentParts(e,t,n,i){Be(n.type,e)?this._createInputWithValidationComponentParts(e,t,n,i):this._createInputComponentParts(e,t,n,i);const o=t.slice(1),c=ge(e),a={action:"changeAttributeValue",attributePath:o};this._createOutputComponentParts(c,a,i);const l={action:"markControlAsTouched",attributePath:o};this._createOutputComponentParts("focusout",l,i)}_createSpecialPropertyComponentParts(e,t,n){return this._specialPropertiesList.find(o=>o.property===e)?.createComponentPart(e,t,n)}initDependencies(){this.bindingExpressionInterpreter=this.injector.get(S),this._bindingContext=this.injector.get(K),this.featureValues=this.injector.get(f.FEATURE_VALUES),this.isAngularHost=this.injector.get(f.IS_ANGULAR_HOST)}createLazyContentComponentParts(e){throw Error("View element type does not support lazy content projection.")}isSpecialPropertyBinding(e,t){return Boolean(this._specialPropertiesList.find(n=>n.property===e))}isContentPropertyBinding(e,t,n){return Boolean(this.getViewElementSlotDefinition(n,e))}getViewElementSlotDefinition(e,t){const i=g.ViewElementRegistry.viewElements.get(e.type)?.contentSlots?.find(o=>(typeof o=="string"?o:o.name)===t);return typeof i=="string"?{name:i,input:!1,lazy:!1}:i}isInputBinding(e,t,n){return he(n.type,e)}isControlBinding(e,t,n){return g.ViewElementRegistry.getFormControlRelatesAttribute(n.type)===e}isInputWithValidationBinding(e,t,n){return this.isInputBinding(e,t,n)&&(0,v.isSimpleBindingExpression)(t)&&Be(n.type,e)}isOutputBinding(e,t,n){return fe(n.type,e)}isTwoWayBinding(e,t,n){const i=ge(e);return he(n.type,e)&&fe(n.type,i)&&!(i in n)&&(0,v.isBindingExpression)(t)?(0,v.isSimpleBindingExpression)(t)?!0:(console.warn(`Cannot use two way binding for '${e}' property of '${n.name}' view element. Expression '${t}' should not have converters, properties etc.`),!1):!1}_processViewElementConfigProperty(e,t,n,i,o){if(this.isContentPropertyBinding(e,t,n)&&Array.isArray(t))this._createContentPropertyComponentParts(e,t,n,i,o);else if(this.isSpecialPropertyBinding(e,t))this._createSpecialPropertyComponentParts(e,t,i);else if(this.isTwoWayBinding(e,t,n))this._createTwoWayBindingComponentParts(e,t,n,i);else if(this.isOutputBinding(e,t,n)){const c=Array.isArray(t)?t:[t],a={action:"processRequest",requests:c};this._createOutputComponentParts(e,a,i)}else this.isInputWithValidationBinding(e,t,n)?this._createInputWithValidationComponentParts(e,t,n,i):this.isControlBinding(e,t,n)?this._createControlInputComponentParts(e,t,n,i):this.isInputBinding(e,t,n)&&this._createInputComponentParts(e,t,n,i)}addIsAttachedConditionInCrtIf(e){const t={propertyKey:w.getContextPropertyName("isViewAttached",e),value:this.injector.get(ae).viewAttached$.asObservable(),pipes:[{name:"crtAsync"}]},n=e.directives.find(({selector:i})=>i==="crtIf");n?n.values.push(t):e.directives.push({selector:"crtIf",useAsterisk:!0,values:[t]})}create(e,t,n){const i=new Ce(t);i.selector=this.getSelector(e),i.name=e.name??(0,Et.Z)();const o=w.getViewElementEntries(e);for(const[a,l]of o)a!==this._visibleAttributeName&&this._processViewElementConfigProperty(a,l,e,i,n);this.createLoadingComponentParts(e,i),n?.useDataItemMarker&&this._createDataItemMarkerComponentParts(e,i),this._createViewElementConfigProviderComponentParts(e,i);const c=o.find(([a])=>a===this._visibleAttributeName);return c?.[0]?w.createVisibleComponentPartsWrapper(this._visibleAttributeName,c[1],i,e):i}}class Pt extends Rt{addContentProperty(e,t,n){g.ViewElementRegistry.viewElements.get(n.type)?.contentSlots?.length>1&&(t.attributes[e]={value:""}),t.attributes["#"+e]={value:""}}createLazyContentComponentParts(e){const t=new Ce;t.selector="ng-template",t.content.push(e);const n=e.directives.find(i=>i.selector==="crtIf");return n&&t.directives.push({selector:"crtIf",values:n.values,useAsterisk:!0}),t}isInputBinding(e,t,n){if(super.isInputBinding(e,t,n))return!0;const i=this.getComponentMirror(n);return Boolean(i.inputs.find(o=>o.templateName===e))}isOutputBinding(e,t,n){if(super.isOutputBinding(e,t,n))return!0;const i=this.getComponentMirror(n);return Boolean(i.outputs.find(o=>o.templateName===e))}createControl(e){return new F.FormControl(e)}getSelector(e){return this.getComponentMirror(e).selector}getComponentMirror(e){const n=this.injector.get(V).getViewElementType(e);return(0,s.reflectComponentType)(n)}}class rt{}class tn extends Pt{addContentProperty(e,t,n){super.addContentProperty(e,t,n),this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost&&(this.featureValues.DisableComponentPartsRerenderCache||(t.content[0].content[0].attributes["#"+e]={value:""}))}create(e,t,n){const i=super.create(e,t,n);if(this.featureValues.UseSchemaOutletReuseViewStrategy&&this.isAngularHost)if(this.featureValues.DisableComponentPartsRerenderCache)this.addIsAttachedConditionInCrtIf(i);else{const o=new Ce(t);o.selector="ng-template",o.attributes.crtNgFor={value:""},o.attributes["let-instanceId"]={value:""},o.inputs.ngForOf={value:`context['${Ne}']`};const c=new Ce(o);return o.content=[c],c.selector="ng-container",c.directives.push({selector:"crtAttachIf",values:[],useAsterisk:!0,rawValue:`context['${xe}'] === instanceId`}),c.content=[i],o}return i}}class nn{constructor(e){this._injector=e}create(e,t,n){const i=new Ce(t);return i.selector="crt-view-element-placeholder",i.name=e.name??(0,Et.Z)(),i.inputs.caption={value:e.type,propertyKey:w.getContextPropertyName("caption",i),pipes:[]},"layoutConfig"in e&&w.createLayoutConfigComponentParts("layoutConfig",e.layoutConfig,i),"visible"in e?w.createVisibleComponentPartsWrapper("visible",e.visible,i,e):i}addContentProperty(e,t,n){}}class rn extends Rt{addContentProperty(e,t,n){g.ViewElementRegistry.viewElements.get(n.type)?.contentSlots?.length>1&&(t.attributes[e]={value:""}),t.attributes["#"+e]={value:""}}createControl(e){return new I.BaseCrtControl(e)}getSelector(e){return this.injector.get(V).getSelector(e.type)}createLoadingComponentParts(e,t){g.ViewElementRegistry.viewElements.get(e.type).inputs?.loading&&super.createLoadingComponentParts(e,t)}create(e,t,n){const i=super.create(e,t,n);return this.addIsAttachedConditionInCrtIf(i),i}}class le extends rt{create(e,t){const n=e.get(V);if(!t.type)throw new Error('"Type" property of view config can not be empty');return n.canResolve(t.type)?n.getSelector(t.type)?new rn(e,this):g.ViewElementRegistry.viewElements.get(t.type)?.reuseStrategy===g.ViewElementReuseStrategy.Rerender?new tn(e,this):new Pt(e,this):(console.warn(`View element with type "${t.type}" not found`),new nn(e))}}le.\u0275fac=function(){let r;return function(t){return(r||(r=s.\u0275\u0275getInheritedFactory(le)))(t||le)}}(),le.\u0275prov=s.\u0275\u0275defineInjectable({token:le,factory:le.\u0275fac});class sn{constructor(e){this._injector=e}create(e,t,n){const i=new ComponentParts(t);i.selector="crt-view-element-container",i.name=e.name??uuid(),i.inputs.viewElementConfig={value:e,propertyKey:ComponentPartsCreatorUtils.getContextPropertyName("viewElementConfig",i),pipes:[]},"layoutConfig"in e&&ComponentPartsCreatorUtils.createLayoutConfigComponentParts("layoutConfig",e.layoutConfig,i);const c=ComponentPartsCreatorUtils.getViewElementEntries(e).find(([a])=>a==="visible");return c?.[0]in e?ComponentPartsCreatorUtils.createVisibleComponentPartsWrapper("visible",c[1],i,e):i}addContentProperty(e,t,n){}}class Q{constructor(e,t,n,i,o,c){this.injector=e,this._featureService=t,this.containerRef=n,this._componentCreator=i,this._componentPartsFactory=o,this._componentStorage=c,this._featureValues=(0,s.inject)(f.FEATURE_VALUES)}_getContentProperties(e){return g.ViewElementRegistry.viewElements.get(e.type)?.contentSlots?.map(t=>typeof t=="string"?t:t.name)||[]}_getInputProperties(e){const t=g.ViewElementRegistry.viewElements.get(e.type),n=t?.inputs||{};return t.contentSlots&&t.contentSlots.forEach(i=>{typeof i=="object"&&i.input&&(n[i.name]={})}),n}_getComponentParts(e){const t=new Ce;t.selector="ng-container";for(const n of(0,y.cloneDeep)(this.viewConfig)){const o=this._componentPartsFactory.create(this.injector,n).create(n,null,{useDataItemMarker:e});t.content.push(o)}return t}createComponent(e,t){let n;const i=this._getComponentParts(e),{componentContext:o,componentTemplate:c}=this._componentCreator.createTemplateAndContext(i);!t&&this.selector&&this._componentStorage.has(this.selector)?n=this._componentStorage.get(this.selector):(n=this._componentCreator.create(this.selector,c,this.modules),!t&&this.selector&&this._componentStorage.set(this.selector,n));const a=this.containerRef.createComponent(n.componentType,{index:0,injector:this.injector,environmentInjector:this.injector.get(s.EnvironmentInjector)});return a.instance.context=o,a}_excludeContentAndInputProperties(e){return(0,y.omit)(e,[...this._getContentProperties(e),...Object.keys(this._getInputProperties(e))])}canUpdateView(e,t){if(this._featureValues.DisableUpdateWithoutSchemaReload||e.length!==t.length||!this.componentInstance)return!1;for(let n=0;n<e.length;n++){const i=e[n],o=t[n];if(!(0,y.isEqual)(new Set(Object.keys(e[n])),new Set(Object.keys(t[n])))||!(0,y.isEqual)(this._excludeContentAndInputProperties(e[n]),this._excludeContentAndInputProperties(t[n])))return!1;const c=this._getContentProperties(i);for(const a of c)if(!this.canUpdateView(i[a]||[],o[a]||[]))return!1}return!0}_updateViewElementInputs(e,t){for(let n=0;n<e.length;n++){const i=t[n],o=e[n];for(const a of Object.keys(this._getInputProperties(i)))(0,y.isEqual)(i[a],o[a])||this.componentInstance.updateViewElementInput(i.name,a,i[a]);const c=this._getContentProperties(i);for(const a of c)this._updateViewElementInputs(o[a]||[],i[a]||[])}}updateView(e,t){this._updateViewElementInputs(e,t),this.componentInstance.changeDetectorRef.detectChanges()}resetPreviousView(){this.containerRef.clear()}createView(){const e=this.createComponent(this._featureValues.UseViewElementDataItemMarker,this._featureValues.DisableComponentCacheFeature);return e.instance.changeDetectorRef=e.changeDetectorRef,this.componentInstance=e.instance,e}ngOnChanges(e){const t=e.viewConfig?.currentValue||[],n=e.viewConfig?.previousValue||[];t&&!(0,y.isEqual)(n,t)&&(this.canUpdateView(n,t)?this.updateView(n,t):(this.resetPreviousView(),this.createView()))}}Q.\u0275fac=function(e){return new(e||Q)(s.\u0275\u0275directiveInject(s.Injector),s.\u0275\u0275directiveInject(ct.FeatureService),s.\u0275\u0275directiveInject(s.ViewContainerRef),s.\u0275\u0275directiveInject(X),s.\u0275\u0275directiveInject(rt),s.\u0275\u0275directiveInject(be))},Q.\u0275dir=s.\u0275\u0275defineDirective({type:Q,selectors:[["","crtViewGenerator",""]],inputs:{viewConfig:"viewConfig",selector:"selector",modules:"modules"},features:[s.\u0275\u0275ProvidersFeature([...Pe]),s.\u0275\u0275NgOnChangesFeature]});class k extends Q{constructor(){super(...arguments),this._cacheService=(0,s.inject)(ce),this._viewModel$=new d.ReplaySubject(1),this._bindingContext={viewModel$:this._viewModel$.asObservable()}}resetPreviousView(){if(this.componentInstance?.deactivate(),this._componentRef){const e=this.containerRef.indexOf(this._componentRef.hostView);this.containerRef.detach(e)}}createView(){return this._viewModel$.next(this.viewModel),super.createView()}_restoreView(e){this.resetPreviousView(),this._componentRef=e,this.componentInstance=this._componentRef.instance,this._viewModel$.next(this.viewModel),this.componentInstance.activate(),this.containerRef.insert(e.hostView,0)}_createOrUpdateViewWithoutCaching(e){if("instanceId"in e){this.resetPreviousView(),this._componentRef=this.createView(),this._componentRef.instance.context[xe]=this.instanceId,this._componentRef.instance.context[Ne]=[this.instanceId];return}const t=this.viewConfig||[],n=e.viewConfig?.previousValue||[];"viewConfigId"in e&&(this.canUpdateView(n,t)?this.updateView(n,t):(this.resetPreviousView(),this._componentRef.destroy(),this._componentRef=this.createView(),this._componentRef.instance.context[xe]=this.instanceId,this._componentRef.instance.context[Ne]=[this.instanceId]))}_createOrUpdateView(e){const t=this.viewConfig||[],n=e.viewConfig?.previousValue||[];if("instanceId"in e||"viewConfigId"in e){const i=this._cacheService.getView(this.viewConfigId),c=this._cacheService.getViewConfig(i)||n;this.canUpdateView(c,t)?(i&&this._restoreView(i),this._componentRef.instance.context[xe]=this.instanceId,this.updateView(c,t)):(this.resetPreviousView(),this._componentRef=this.createView(),this._cacheService.invalidateInstance(this.instanceId),this._componentRef.instance.context[xe]=this.instanceId),this._cacheService.saveView(this._componentRef,this.viewConfigId,this.viewConfig),this._cacheService.saveInstance(this._componentRef,this.instanceId),this._componentRef.instance.context[Ne]=this._cacheService.getInstances(this._componentRef)}}_resetPreviousViewWithoutCaching(e){const t="skipCache"in e?e.skipCache.previousValue:this.skipCache;"instanceId"in e&&t&&(this.resetPreviousView(),this._componentRef.destroy(),this._componentRef=null)}ngOnChanges(e){if(this._resetPreviousViewWithoutCaching(e),this.skipCache){this._createOrUpdateViewWithoutCaching(e);return}this._createOrUpdateView(e)}}k.\u0275fac=function(){let r;return function(t){return(r||(r=s.\u0275\u0275getInheritedFactory(k)))(t||k)}}(),k.\u0275dir=s.\u0275\u0275defineDirective({type:k,selectors:[["","crtReusableViewGenerator",""]],inputs:{instanceId:"instanceId",viewModel:"viewModel",viewConfigId:"viewConfigId",skipCache:"skipCache"},features:[s.\u0275\u0275ProvidersFeature([{provide:K,useFactory:r=>r._bindingContext,deps:[(0,s.forwardRef)(()=>k)]},...Pe]),s.\u0275\u0275InheritDefinitionFeature,s.\u0275\u0275NgOnChangesFeature]});class L{static forRoot(e){return{ngModule:L,providers:[{provide:$e,useValue:e}]}}}L.\u0275fac=function(e){return new(e||L)},L.\u0275mod=s.\u0275\u0275defineNgModule({type:L}),L.\u0275inj=s.\u0275\u0275defineInjector({providers:[{provide:rt,useClass:le}],imports:[R.CommonModule]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&s.\u0275\u0275setNgModuleScope(L,{declarations:[Q,k],imports:[R.CommonModule],exports:[Q,k]})}()},18877:(ke,Se,C)=>{C.d(Se,{Z:()=>M});const pe={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let s;const g=new Uint8Array(16);function v(){if(!s&&(s=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(g)}const y=[];for(let m=0;m<256;++m)y.push((m+256).toString(16).slice(1));function $(m,f=0){return y[m[f+0]]+y[m[f+1]]+y[m[f+2]]+y[m[f+3]]+"-"+y[m[f+4]]+y[m[f+5]]+"-"+y[m[f+6]]+y[m[f+7]]+"-"+y[m[f+8]]+y[m[f+9]]+"-"+y[m[f+10]]+y[m[f+11]]+y[m[f+12]]+y[m[f+13]]+y[m[f+14]]+y[m[f+15]]}function R(m,f=0){const d=$(m,f);if(!validate(d))throw TypeError("Stringified UUID is invalid");return d}const Ee=null;function Le(m,f,d){if(pe.randomUUID&&!f&&!m)return pe.randomUUID();m=m||{};const p=m.random||(m.rng||v)();if(p[6]=p[6]&15|64,p[8]=p[8]&63|128,f){d=d||0;for(let F=0;F<16;++F)f[d+F]=p[F];return f}return $(p)}const M=Le},57421:ke=>{ke.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="65.898" height="50" viewBox="0 0 65.898 50">
  <g id="Group_10554" data-name="Group 10554" transform="translate(-630.824 -282)">
    <g id="Group_10553" data-name="Group 10553" transform="translate(-8 4)">
      <rect id="Rectangle_23319" data-name="Rectangle 23319" width="24" height="8" transform="translate(640 311) rotate(-90)" fill="#757575" opacity="0.15"/>
      <rect id="Rectangle_23320" data-name="Rectangle 23320" width="15" height="8" transform="translate(655 313) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23321" data-name="Rectangle 23321" width="50" height="8" transform="translate(671 328) rotate(-90)" fill="#757575" opacity="0.16"/>
      <rect id="Rectangle_23326" data-name="Rectangle 23326" width="20" height="8" transform="translate(671 298) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23322" data-name="Rectangle 23322" width="30" height="8" transform="translate(687 311) rotate(-90)" fill="#757575" opacity="0.12"/>
      <rect id="Rectangle_23327" data-name="Rectangle 23327" width="17" height="8" transform="translate(687 298) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23323" data-name="Rectangle 23323" width="11" height="8" transform="translate(640 298) rotate(-90)" fill="#757575" opacity="0.15"/>
      <rect id="Rectangle_23324" data-name="Rectangle 23324" width="25" height="8" transform="translate(655 313) rotate(-90)" fill="#757575" opacity="0.19"/>
      <path id="Path_9959" data-name="Path 9959" d="M223.923,2054c8.8,1.753,9.21,7.979,18.455,7.661s19.38-15.618,29.076-15.618,13.109-8.362,16.091-8.043" transform="translate(416.077 -1753.707)" fill="none" stroke="#757575" stroke-linecap="round" stroke-width="2" opacity="0.36"/>
    </g>
  </g>
</svg>
`}}]);
